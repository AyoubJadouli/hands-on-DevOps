<!DOCTYPE html>
  <html>
    <head>
      <title>README</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////Users/mjwalsh/.vscode/extensions/shd101wyy.markdown-preview-enhanced-0.3.5/node_modules/@shd101wyy/mume/dependencies/katex/katex.min.css">
      
      
      
      
      
      
      
      
      
      

      <style> 
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="1-devops">1. DevOps</h1>

<p>A hands-on DevOps course.</p>
<p>This course will</p>
<ul>
<li>Discuss DevOps,</li>
<li>Have you spin up a DevOps toolchain and development environment, and then</li>
<li>Author two applications and their accompanying pipelines, the first a continuous integration (CI) and the second a continuous delivery (CD) pipeline.</li>
</ul>
<p>We will be spending most of the course hands-on working with the tools and in the Unix command line making CI/CD happen, so as to grow an understanding of how DevOps actually works.</p>
<p>Don't fixate on the tools used, nor the apps we develop in the course of learning how and why.  How and why is far more important.  This course like DevOps is not about tools although we'll be using them. You'll spend far more time writing code.  (Or at least cutting-and-pasting code.)</p>
<h1 class="mume-header" id="2-author">2. Author</h1>

<ul>
<li>Michael Joseph Walsh <a href="mailto:mjwalsh@mitre.org">mjwalsh@mitre.org</a>, <a href="mailto:walsh@nemonik.com">walsh@nemonik.com</a></li>
</ul>
<h1 class="mume-header" id="3-acknowledgments">3. Acknowledgments</h1>

<ul>
<li>Thank you to Walter Hiranpat for running through course material prior to me teaching it.</li>
<li>Thank you to Eric McCann assisting Walter and I work through Vagrant install issues on Microsoft Windows.</li>
<li>Thank you to my first class participants for &quot;beta&quot; testing my class.</li>
<li>Thank you to Jonathan Thomas for TA'ing my second class.</li>
</ul>
<h1 class="mume-header" id="4-copyright-and-license">4. Copyright and License</h1>

<p>See the License file at the root of the project.</p>
<h1 class="mume-header" id="5-toc">5. TOC</h1>

<ul>
<li><a href="#1-devops">1. DevOps</a></li>
<li><a href="#2-author">2. Author</a></li>
<li><a href="#3-acknowledgments">3. Acknowledgments</a></li>
<li><a href="#4-copyright-and-license">4. Copyright and License</a></li>
<li><a href="#5-toc">5. TOC</a></li>
<li><a href="#7-prerequisites">7. Prerequisites</a></li>
<li><a href="#6-devops-unpacked">6. DevOps unpacked</a>
<ul>
<li><a href="#61-what-is-devops">6.1. What is DevOps?</a></li>
<li><a href="#62-what-devops-is-not">6.2. What DevOps is not.</a></li>
<li><a href="#63-devops-is-really-about">6.3. DevOps is really about</a></li>
<li><a href="#64-how-does-it-related-to-the-agile">6.4. How does it related to the Agile?</a></li>
<li><a href="#65-how-do-they-differ">6.5. How do they differ?</a></li>
<li><a href="#66-why">6.6. Why?</a></li>
<li><a href="#67-what-are-the-principles-of-devops">6.7. What are the principles of DevOps?</a></li>
<li><a href="#68-how-is-this-achieved">6.8. How is this achieved?</a></li>
<li><a href="#69-what-is-continuous-integration-ci">6.9. What is Continuous Integration (CI)?</a></li>
<li><a href="#610-how">6.10. How?</a></li>
<li><a href="#611-ci-best-practices">6.11. CI best practices</a>
<ul>
<li><a href="#6111-utilize-a-configuration-management-system">6.11.1. Utilize a Configuration Management System</a></li>
<li><a href="#6112-automate-the-build">6.11.2. Automate the build</a></li>
<li><a href="#6113-employ-one-or-more-ci-servicesorchestrators">6.11.3. Employ one or more CI services/orchestrators</a></li>
<li><a href="#6114-make-builds-self-testing">6.11.4. Make builds self-testing</a></li>
<li><a href="#6115-never-commit-broken">6.11.5. Never commit broken</a></li>
<li><a href="#6116-developers-are-expected-to-pre-flight-new-code">6.11.6. Developers are expected to pre-flight new code</a></li>
<li><a href="#6117-the-ci-serviceorchestrator-provides-feedback">6.11.7. The CI service/orchestrator provides feedback</a></li>
</ul>
</li>
<li><a href="#612-what-is-continuous-delivery">6.12. What is Continuous Delivery?</a>
<ul>
<li><a href="#6121-extends-continuous-integration-ci">6.12.1. Extends Continuous Integration (CI)</a></li>
<li><a href="#6122-consistency">6.12.2. Consistency</a></li>
</ul>
</li>
<li><a href="#613-but-wait-whats-a-pipeline">6.13. But wait. What's a pipeline?</a></li>
<li><a href="#614-but-really-why-do-we-code-err-automate">6.14. But really why do we code err. automate?</a>
<ul>
<li><a href="#6141-laziness">6.14.1. Laziness</a></li>
<li><a href="#6142-impatience">6.14.2. Impatience</a></li>
<li><a href="#6143-hubris">6.14.3. Hubris</a></li>
<li><a href="#6144-but-really-we-automate-for">6.14.4. But really we automate for</a></li>
</ul>
</li>
<li><a href="#615-how-is-a-pipeline-manifested">6.15. How is a pipeline manifested?</a></li>
<li><a href="#616-what-underlines-all-of-this">6.16. What underlines all of this?</a></li>
<li><a href="#617-monitoring">6.17. Monitoring</a>
<ul>
<li><a href="#6171-the-most-important-metric">6.17.1. The most important metric</a></li>
<li><a href="#6172-an-understanding-of-performance">6.17.2. An Understanding of Performance</a></li>
<li><a href="#6173-establish-a-baseline">6.17.3. Establish a baseline</a></li>
<li><a href="#6174-set-reaction-thresholds">6.17.4. Set Reaction Thresholds</a></li>
<li><a href="#6175-reacting">6.17.5. Reacting</a></li>
<li><a href="#6176-gaps-in-cicd">6.17.6. Gaps in CI/CD</a></li>
<li><a href="#6177-eliminating-waste">6.17.7. Eliminating Waste</a></li>
</ul>
</li>
<li><a href="#618-crawl-walk-run">6.18. Crawl, Walk, Run</a>
<ul>
<li><a href="#6181-ultimately-devops-is-goal">6.18.1. Ultimately, DevOps is Goal</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#7-reading-list">7. Reading list</a></li>
<li><a href="#8-now-the-hands-on-part">8. Now the hands-on part</a>
<ul>
<li><a href="#81-configuring-environmental-variables">8.1. Configuring environmental variables</a></li>
<li><a href="#82-virtualbox">8.2. VirtualBox</a>
<ul>
<li><a href="#821-installing-virtualbox">8.2.1. Installing VirtualBox</a></li>
</ul>
</li>
<li><a href="#83-git-bash">8.3. Git Bash</a>
<ul>
<li><a href="#831-installing-git-bash">8.3.1. Installing Git Bash</a></li>
</ul>
</li>
<li><a href="#84-retrieve-course-material">8.4. Retrieve course material</a></li>
<li><a href="#85-vagrant">8.5. Vagrant</a>
<ul>
<li><a href="#851-documentation-and-source">8.5.1. Documentation and source</a></li>
<li><a href="#852-installing">8.5.2. Installing</a></li>
<li><a href="#853-installing-plugins">8.5.3. Installing Plugins</a></li>
<li><a href="#854-the-vagrantfile-explained">8.5.4. The Vagrantfile explained</a>
<ul>
<li><a href="#8541-modelines">8.5.4.1. Modelines</a></li>
<li><a href="#8542-proxy-reset-script">8.5.4.2. Proxy reset script</a></li>
<li><a href="#8543-inserting-proxy-setting-via-host-environmental-variables">8.5.4.3. Inserting Proxy setting via host environmental variables</a></li>
<li><a href="#8544-alternatively-inserting-hard-coded-proxy-setting">8.5.4.4. Alternatively, inserting hard coded Proxy setting</a></li>
<li><a href="#8545-inserting-mitre-ca-certificates">8.5.4.5. Inserting MITRE CA Certificates</a></li>
<li><a href="#8546-configuring-the-cache-plugin-to-speed-things-along">8.5.4.6. Configuring the cache plugin to speed things along</a></li>
<li><a href="#8547-requiring-_vagrant-vbquest_-for-windows">8.5.4.7. Requiring <em>vagrant-vbquest</em> for Windows</a></li>
<li><a href="#8548-configuring-the-dev-vagrant">8.5.4.8. Configuring the <em>dev</em> vagrant</a></li>
<li><a href="#8549-configuring-the-toolchain-vagrant">8.5.4.9. Configuring the <em>toolchain</em> vagrant</a></li>
<li><a href="#85410-configuring-the-vagrants-from-one-playbook">8.5.4.10. Configuring the vagrants from one playbook</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#86-ansible">8.6. Ansible</a>
<ul>
<li><a href="#861-playbooks">8.6.1. Playbooks</a></li>
<li><a href="#862-roles">8.6.2. Roles</a>
<ul>
<li><a href="#8621-docker-image-and-containers">8.6.2.1. Docker image and containers</a></li>
<li><a href="#8622-docker-image-and-containers">8.6.2.2. Docker image and containers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#87-spinning-up-the-_toolchain_-vagrant">8.7. Spinning up the <em>toolchain</em> vagrant</a>
<ul>
<li><a href="#871-taiga-an-example-of-agile-project-management-software">8.7.1. Taiga, an example of Agile project management software</a>
<ul>
<li><a href="#8711-documentation-source-container-image">8.7.1.1. Documentation, source, container image</a></li>
<li><a href="#8712-url-username-and-password">8.7.1.2. URL, Username and password</a></li>
</ul>
</li>
<li><a href="#872-gitlab-ce-an-example-of-configuration-management-software">8.7.2. GitLab CE, an example of configuration management software</a>
<ul>
<li><a href="#8721-documentation-source-container-image">8.7.2.1. Documentation, source, container image</a></li>
<li><a href="#8722-url-username-and-password">8.7.2.2. URL, Username and password</a></li>
</ul>
</li>
<li><a href="#873-drone-ci-an-example-of-cicd-orchestrator">8.7.3. Drone CI, an example of CI/CD orchestrator</a>
<ul>
<li><a href="#8731-documentation-source-container-image">8.7.3.1. Documentation, source, container image</a></li>
<li><a href="#8732-url-username-and-password">8.7.3.2. URL, Username and password</a></li>
</ul>
</li>
<li><a href="#874-integrate-drone-ci-with-gitlab">8.7.4. Integrate Drone CI with GitLab</a></li>
<li><a href="#875-sonarqube-an-example-of-a-platform-for-the-inspection-of-code-quality">8.7.5. SonarQube, an example of a platform for the inspection of code quality</a>
<ul>
<li><a href="#8751-documentation-source-container-image">8.7.5.1. Documentation, source, container image</a></li>
<li><a href="#8752-url-username-and-password">8.7.5.2. URL, Username and password</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#88-spin-up-the-_dev_-vagrant">8.8. Spin up the <em>dev</em> vagrant</a></li>
<li><a href="#89-golang-_helloworld_-project">8.9. Golang <em>helloworld</em> project</a>
<ul>
<li><a href="#891-create-the-projects-backlog">8.9.1. Create the project's backlog</a></li>
<li><a href="#892-create-the-project-in-gitlab">8.9.2. Create the project in GitLab</a></li>
<li><a href="#893-setup-your-project-on-the-_dev_-vagrant">8.9.3. Setup your project on the <em>dev</em> Vagrant</a></li>
<li><a href="#894-author-the-application">8.9.4. Author the application</a></li>
<li><a href="#895-align-source-code-with-go-coding-standards">8.9.5. Align source code with Go coding standards</a></li>
<li><a href="#896-lint-your-code">8.9.6. Lint your code</a></li>
<li><a href="#897-build-the-application">8.9.7. Build the application</a></li>
<li><a href="#898-execute-your-application">8.9.8. Execute your application</a></li>
<li><a href="#899-author-a-unit-test">8.9.9. Author a unit test</a></li>
<li><a href="#8910-run-sonar-scanner-on-the-application">8.9.10. Run sonar-scanner on the application</a>
<ul>
<li><a href="#89101-register-your-app-in-sonarqube">8.9.10.1. Register your app in SonarQube</a></li>
<li><a href="#89102-run-the-sonar-scanner-on-the-command-line">8.9.10.2. Run the <em>sonar-scanner</em> on the command line</a></li>
</ul>
</li>
<li><a href="#8911-write-build-and-test-automation">8.9.11. Write build and test automation</a></li>
<li><a href="#8912-author-drone-based-continuous-integration">8.9.12. Author Drone-based Continuous Integration</a></li>
<li><a href="#8913-configure-drone-to-execute-your-pipeline">8.9.13. Configure Drone to execute your pipeline</a></li>
<li><a href="#8914-trigger-the-build">8.9.14. Trigger the build</a></li>
<li><a href="#8915-the-completed-source-for-helloworld">8.9.15. The completed source for <em>helloworld</em></a></li>
</ul>
</li>
<li><a href="#810-golang-helloworld-web-project">8.10. Golang <em>helloworld-web</em> project</a>
<ul>
<li><a href="#8101-create-the-projects-backlog">8.10.1. Create the project's backlog</a></li>
<li><a href="#8102-create-the-project-in-gitlab">8.10.2. Create the project in GitLab</a></li>
<li><a href="#8103-setup-your-project-on-the-dev-vagrant">8.10.3. Setup your project on the <em>dev</em> Vagrant</a></li>
<li><a href="#8104-author-the-application">8.10.4. Author the application</a></li>
<li><a href="#8105-build-and-run-the-application">8.10.5. Build and Run the application</a></li>
<li><a href="#8106-run-sonar-scanner-on-the-application">8.10.6. Run sonar-scanner on the application</a></li>
<li><a href="#8107-lets-write-some-unit-test-to-up-that-coverage">8.10.7. Let's write some unit test to up that coverage</a></li>
<li><a href="#8108-write-the-makefile">8.10.8. Write the Makefile</a></li>
<li><a href="#8109-dockerize-the-application">8.10.9. Dockerize the application</a></li>
<li><a href="#81010-run-the-container">8.10.10. Run the container</a></li>
<li><a href="#81011-push-the-container-image-to-the-private-registry">8.10.11. Push the container image to the private registry</a></li>
<li><a href="#81012-configure-drone-to-execute-your-pipeline">8.10.12. Configure Drone to execute your pipeline</a></li>
<li><a href="#81013-author-the-build-step-for-the-pipeline">8.10.13. Author the build step for the pipeline</a></li>
<li><a href="#81014-author-the-publish-step-for-the-pipeline">8.10.14. Author the publish step for the pipeline</a></li>
<li><a href="#81015-add-a-deploy-step-to-the-pipeliine">8.10.15. Add a deploy step to the pipeliine</a></li>
<li><a href="#81016-add-to-the-pipeline-sonarqube">8.10.16. Add to the pipeline SonarQube</a></li>
<li><a href="#81017-author-an-automated-funtional-test">8.10.17. Author an automated funtional test</a>
<ul>
<li><a href="#810171-run-the-helloworld-web-application">8.10.17.1. Run the <em>helloworld-web</em> application</a></li>
<li><a href="#810172-pull-and-run-selenium-firefox-standalone">8.10.17.2. Pull and run Selenium Firefox Standalone</a></li>
<li><a href="#810173-create-our-test-automation">8.10.17.3. Create our test automation</a></li>
</ul>
</li>
<li><a href="#81018-add-a-selenium-step-to-the-pipeline">8.10.18. Add a <em>selenium</em> step to the pipeline</a></li>
<li><a href="#81019-add-a-dast-step-owasp-zap-to-the-pipeline">8.10.19. Add a DAST step (OWASP ZAP) to the pipeline</a></li>
<li><a href="#81020-all-the-source-for-helloworld-web">8.10.20. All the source for <em>helloworld-web</em></a></li>
</ul>
</li>
<li><a href="#811-using-what-youve-learned">8.11. Using what you've learned</a></li>
<li><a href="#812-shoo-away-your-vagrants">8.12. Shoo away your vagrants</a></li>
<li><a href="#813-thats-it">8.13. That's it</a></li>
</ul>
</li>
</ul>
<h1 class="mume-header" id="7-prerequisites">7. Prerequisites</h1>

<p>The following skills would be useful in following along, but aren't strictly necessary.</p>
<p>What you should bring:</p>
<ul>
<li>Managing Linux or Unix-like systems as we will living largely within the terminal.</li>
<li>A basic understanding of Vagrant, Docker, and Ansible would be helpful.</li>
<li>But mostly being a software engineer.</li>
</ul>
<p>What's on the classroom computer:</p>
<ul>
<li>The latest version of VirtualBox is expected to be installed.</li>
</ul>
<h1 class="mume-header" id="6-devops-unpacked">6. DevOps unpacked</h1>

<h2 class="mume-header" id="61-what-is-devops">6.1. What is DevOps?</h2>

<p>DevOps (a clipped compound of the words &quot;development&quot; and &quot;operations&quot;) is a software development methodology with an emphasis on a more reliable release pipeline, automation, and stronger collaboration across all stakeholders with the goal of deploying working functionality into the hands of users (i.e., production) faster.</p>
<p>Yeah, that's the formal definition.  I've grown to prefer the axiom:</p>
<p><em>You are what you code.</em></p>
<p>For example,</p>
<ol>
<li>If a developer or software engineer, you're at least coding the application, its build automation, unit tests, and CI/CD automation.</li>
<li>If a tester, you're coding the rest of the test automation.</li>
<li>If a security engineer, the compliance and policy test automation.</li>
<li>If ops, the deployment and infrastructure configuration management automation.</li>
</ol>
<h2 class="mume-header" id="62-what-devops-is-not">6.2. What DevOps is not.</h2>

<p>DevOps will not stop all bugs nor all vulnerabilities from making it into production, but that's not really the point.</p>
<h2 class="mume-header" id="63-devops-is-really-about">6.3. DevOps is really about</h2>

<p>DevOps point is about providing the culture and release pipeline that once a bug or vulnerability is discovered for the issue to be quickly remediated and return functionality back to the user.</p>
<h2 class="mume-header" id="64-how-does-it-related-to-the-agile">6.4. How does it related to the Agile?</h2>

<p>Agile Software Development is an umbrella term for a set of methods and practices based on the <a href="http://www.agilealliance.org/agile101/the-agile-manifesto/">values</a> and <a href="http://www.agilealliance.org/agile101/12-principles-behind-the-agile-manifesto/">principles</a> expressed in the Agile Manifesto.</p>
<p>Agile Software Development shares the same goal, but DevOps extends Agile methods and practices by adding communication and collaboration between</p>
<ul>
<li>development,</li>
<li>quality assurance, and</li>
<li>technology operations</li>
<li>to ensure software systems are delivered in a rapid, reliable, low-risk manner.</li>
</ul>
<p>For Agile, solutions evolve through collaboration between self-organizing, cross-functional teams utilizing the appropriate practices for their context.</p>
<p>Again, in DevOps everyone is developing software, so it is my view DevOps builds on Agile.</p>
<h2 class="mume-header" id="65-how-do-they-differ">6.5. How do they differ?</h2>

<p>While Agile Software Development methods encourage collaboration among the cross-functional teams, the focus in DevOps is on the</p>
<ul>
<li>inclusion of analysis,</li>
<li>design,</li>
<li>development, and</li>
<li>quality assurance functionaries as stakeholders into the development effort.</li>
</ul>
<h2 class="mume-header" id="66-why">6.6. Why?</h2>

<p>In Agile Software Development, there is rarely an integration of these individuals outside the immediate application development team with members of technology operations (e.g., network engineers administrators, testers, cyber security engineers.)</p>
<h2 class="mume-header" id="67-what-are-the-principles-of-devops">6.7. What are the principles of DevOps?</h2>

<p>As DevOps matures, several principles have emerged, namely the necessity for product teams to:</p>
<ul>
<li>Apply holistic thinking to solve problems,</li>
<li>Develop and test against production-like environments,</li>
<li>Deploy with repeatable, and reliable processes,</li>
<li>Remove the drudgery through automation,</li>
<li>Validate and monitor operational quality, and</li>
<li>Provide rapid, automated feedback to the stakeholders</li>
</ul>
<h2 class="mume-header" id="68-how-is-this-achieved">6.8. How is this achieved?</h2>

<p>Achieved through Continuous Integration (CI) and Continuous Delivery (CD) often conflated into CI/CD.</p>
<p>This is what is commonly (albeit mistakenly) thought to be the totality of DevOps.</p>
<h2 class="mume-header" id="69-what-is-continuous-integration-ci">6.9. What is Continuous Integration (CI)?</h2>

<p>It is an Agile software development practice associated where members of a product team frequently integrate their work in order to detect integration issues as quickly as possible thereby shifting discovery of issues &quot;left&quot; (i.e., early) in the software release.</p>
<h2 class="mume-header" id="610-how">6.10. How?</h2>

<p>Each integration is orchestrated through a CI service/orchestrator (e.g., Jenkins CI, Drone CI, Concourse CI) that essentially assembles a build, runs unit and integration tests every time a predetermined trigger has been met; and then reports with immediate feedback.</p>
<h2 class="mume-header" id="611-ci-best-practices">6.11. CI best practices</h2>

<h3 class="mume-header" id="6111-utilize-a-configuration-management-system">6.11.1. Utilize a Configuration Management System</h3>

<p>For the software's source code, where the mainline (i.e., master branch) is the most the most recent working version, past releases held in branches, and new features not yet merged into the mainline branch being worked on their own branches.</p>
<h3 class="mume-header" id="6112-automate-the-build">6.11.2. Automate the build</h3>

<p>By accompanying build automation (e.g., Gradle, Apache Maven, Make) alongside the source code.</p>
<h3 class="mume-header" id="6113-employ-one-or-more-ci-servicesorchestrators">6.11.3. Employ one or more CI services/orchestrators</h3>

<p>Perform source code analysis via automate formal code inspection and assessment.</p>
<h3 class="mume-header" id="6114-make-builds-self-testing">6.11.4. Make builds self-testing</h3>

<p>In other words, ingrain testing by including unit and integration tests (e.g., Spock, JUnit, Mockito, SOAPUI, go package <em>Testing</em>) with the source code so as to be executed by the build automation to be execute by the CI service.</p>
<h3 class="mume-header" id="6115-never-commit-broken">6.11.5. Never commit broken</h3>

<p>Or untested source code to the CMS mainline or otherwise risk breaking a build.</p>
<h3 class="mume-header" id="6116-developers-are-expected-to-pre-flight-new-code">6.11.6. Developers are expected to pre-flight new code</h3>

<p>Prior to committing source code in their own workspace.</p>
<h3 class="mume-header" id="6117-the-ci-serviceorchestrator-provides-feedback">6.11.7. The CI service/orchestrator provides feedback</h3>

<p>On the success or fail of a build integration to all stakeholders.</p>
<h2 class="mume-header" id="612-what-is-continuous-delivery">6.12. What is Continuous Delivery?</h2>

<p>It is a software development practice of providing a rapid, reliable, low-risk product delivery achieved through automating all facets of building, testing, and deploying software.</p>
<h3 class="mume-header" id="6121-extends-continuous-integration-ci">6.12.1. Extends Continuous Integration (CI)</h3>

<p>With additional stages/steps aimed to provide ongoing validation that a newly assembled software build meets all desired requirements and thereby is releasable.</p>
<h3 class="mume-header" id="6122-consistency">6.12.2. Consistency</h3>

<p>Delivery of applications into production is achieved through individual repeatable pipelines of ingrained system configuration management and testing</p>
<h2 class="mume-header" id="613-but-wait-whats-a-pipeline">6.13. But wait. What's a pipeline?</h2>

<p>A pipeline automates the various stages/steps (e.g., Static Application Security Testing (SAST), build, unit testing, Dynamic Application Security Testing (DAST), secure configuration acceptance compliance, integration, function and non-functional testing, delivery, and deployment) to enforce quality conformance.</p>
<h2 class="mume-header" id="614-but-really-why-do-we-code-err-automate">6.14. But really why do we code err. automate?</h2>

<p>In 2001, I think Larry Wall in his1st edition of Programming Perl book put it best with &quot;We will encourage you to develop the three great virtues of a programmer:</p>
<p>laziness,</p>
<p>impatience, and</p>
<p>hubris.&quot;</p>
<p>The second edition of the same book provided definitions for these terms</p>
<h3 class="mume-header" id="6141-laziness">6.14.1. Laziness</h3>

<p>*<em>he quality that makes you go to great effort to reduce overall energy expenditure. It makes you write labor-saving programs that other people will find useful, and document what you wrote so you don't have to answer so many questions about it. Hence, the first great virtue of a programmer.</em> (p.609)</p>
<h3 class="mume-header" id="6142-impatience">6.14.2. Impatience</h3>

<p><em>The anger you feel when the computer is being lazy. This makes you write programs that don't just react to your needs, but actually anticipate them. Or at least pretend to. Hence, the second great virtue of a programmer.</em> (p.608)</p>
<h3 class="mume-header" id="6143-hubris">6.14.3. Hubris</h3>

<p><em>Excessive pride, the sort of thing Zeus zaps you for. Also, the quality that makes you write (and maintain) programs that other people won't want to say bad things about. Hence, the third great virtue of a programmer.</em> (p.607)</p>
<h3 class="mume-header" id="6144-but-really-we-automate-for">6.14.4. But really we automate for</h3>

<ul>
<li>Faster, coordinated, repeatable, and therefore more reliable deployments.</li>
<li>Discover bugs sooner. Shifting their discovery left in the process.</li>
<li>To accelerates the feedback loop between Dev and Ops.</li>
<li>Reduce tribal knowledge, where one group or person holds the keys to how things get done. Yep, this is about making us all replaceable.</li>
<li>Reduce shadow IT (i.e., hardware or software within an enterprise that is not supported by IT. Just waiting for its day to explode.)</li>
</ul>
<h2 class="mume-header" id="615-how-is-a-pipeline-manifested">6.15. How is a pipeline manifested?</h2>

<p>Each delivery pipeline is manifested as <strong>Pipeline as Code</strong> (i.e., software automation) accompanying software's source code in its version control repository.</p>
<h2 class="mume-header" id="616-what-underlines-all-of-this">6.16. What underlines all of this?</h2>

<p>I'd argue, <em>a ubiquitous access to shared pools of configurable system resources and higher-level services that can be rapidly provisioned with minimal management effort</em> (i.e., cloud services) without CI/CD (the repeated practices of DevOps) will struggle.</p>
<h2 class="mume-header" id="617-monitoring">6.17. Monitoring</h2>

<p>Once deployed, the work is done, right?</p>
<p>A development team's work is not complete once a product leaves CI/CD and enters production; especially, under DevOps where the development teams include members of operations.</p>
<h3 class="mume-header" id="6171-the-most-important-metric">6.17.1. The most important metric</h3>

<p>Working software is the <em>primary</em>, but not the only, measure of progress.  The key to successful DevOps is knowing how well the methodology and the software it produces are performing.</p>
<h3 class="mume-header" id="6172-an-understanding-of-performance">6.17.2. An Understanding of Performance</h3>

<p>Is achieved by collecting and analyzing data produced by environments used for CI/CD and production.</p>
<h3 class="mume-header" id="6173-establish-a-baseline">6.17.3. Establish a baseline</h3>

<p>To determine what the baseline performance is so that improvements can be gauged and anomalies detected.</p>
<h3 class="mume-header" id="6174-set-reaction-thresholds">6.17.4. Set Reaction Thresholds</h3>

<p>Agile methods and practices should formulate and prioritize reactions weighting factors, such as, the frequency at which an anomaly arises and who is impacted.</p>
<h3 class="mume-header" id="6175-reacting">6.17.5. Reacting</h3>

<p>A reaction could be as simple as operations instructing users through training to not do something that triggers the anomaly, or more ideally, result in an issue being entered into the product's backlog culminating in the development team delivering a fix into production.</p>
<h3 class="mume-header" id="6176-gaps-in-cicd">6.17.6. Gaps in CI/CD</h3>

<p>Monitoring will also inform development teams of gaps in CI/CD resulting in additional testing for the issue that triggered the necessity for the improvement.</p>
<h3 class="mume-header" id="6177-eliminating-waste">6.17.7. Eliminating Waste</h3>

<p>Further, monitoring may result in the re-scoping of requirements, re-prioritizing of a backlog, or the deprecation of un-used features.</p>
<h2 class="mume-header" id="618-crawl-walk-run">6.18. Crawl, Walk, Run</h2>

<h3 class="mume-header" id="6181-ultimately-devops-is-goal">6.18.1. Ultimately, DevOps is Goal</h3>

<ul>
<li>With DevOps one does not simply hit the ground running.</li>
<li>One must first crawl, walk, and then ultimately run as you embrace the necessary culture change, methods, and repeated practices.</li>
<li>Collaboration and automation are expected continually improve so to achieve more frequent and more reliable releases.</li>
</ul>
<h1 class="mume-header" id="7-reading-list">7. Reading list</h1>

<p><strong><em>AntiPatterns: Refactoring Software, Architectures, and Projects in Crisis</em></strong><br>
William J. Brown, Raphael C. Malveau, Hays W. &quot;Skip&quot; McCormick, Thomas J. Mowbray<br>
ISBN: 978-0-471-19713-3<br>
Apr 1998</p>
<p><strong><em>Continuous Delivery: Reliable Software Releases through Build, Test, and Deployment Automation (Addison-Wesley Signature Series (Fowler))</em></strong><br>
David Farley and Jez Humble<br>
ISBN-13: 978-0321601919<br>
August 2010</p>
<p><strong><em>The DevOps Handbook: How to Create World-Class Agility, Reliability, and Security in Technology Organizations</em></strong><br>
Gene Kim Jez Humble,‎ Patrick Debois,‎ John Willis<br>
ISBN-13: 978-1942788003<br>
October 2016</p>
<p><strong><em>Release It!: Design and Deploy Production-Ready Software 2nd Edition</em></strong><br>
Michael T. Nygard<br>
ISBN-13: 978-1680502398<br>
January 18, 2018</p>
<h1 class="mume-header" id="8-now-the-hands-on-part">8. Now the hands-on part</h1>

<h2 class="mume-header" id="81-configuring-environmental-variables">8.1. Configuring environmental variables</h2>

<p>On Mac OS X</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash"><span class="token function">export</span> proxy<span class="token operator">=</span><span class="token string">"http://gatekeeper.mitre.org:80"</span>
<span class="token function">export</span> http_proxy<span class="token operator">=</span><span class="token string">"http://gatekeeper.mitre.org:80"</span>
<span class="token function">export</span> https_proxy<span class="token operator">=</span><span class="token string">"http://gatekeeper.mitre.org:80"</span>
<span class="token function">export</span> no_proxy<span class="token operator">=</span>127.0.0.1,localhost,.mitre.org,.local,192.168.0.10,192.168.0.11
<span class="token function">export</span> VAGRANT_ALLOW_PLUGIN_SOURCE_ERRORS<span class="token operator">=</span>0
</pre><p>On Windows</p>
<ol>
<li>In the Windows taskbar, enter <code>edit the systems environment variables</code> into <code>Search Windows</code> and select the icon with the corresponding name.</li>
<li>On the <code>Advanced</code> tab select <code>Environment Variables...</code> button.</li>
<li>In <code>Environment Variables</code> windows that opens, under <code>User variables for...</code>press <code>New ...</code> to  open a <code>New User Variable</code> window, enter <code>proxy</code> for <code>variable name:</code> and <code>variable value:</code> for each pair in the table below</li>
</ol>
<table>
<thead>
<tr>
<th>Variable Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>proxy</td>
<td><a href="http://gatekeeper.mitre.org:80">http://gatekeeper.mitre.org:80</a></td>
</tr>
<tr>
<td>http_proxy</td>
<td><a href="http://gatekeeper.mitre.org:80">http://gatekeeper.mitre.org:80</a></td>
</tr>
<tr>
<td>https_proxy</td>
<td><a href="http://gatekeeper.mitre.org:80">http://gatekeeper.mitre.org:80</a></td>
</tr>
<tr>
<td>no_proxy</td>
<td>127.0.0.1,localhost,.mitre.org,.local,192.168.0.10,192.168.0.11</td>
</tr>
<tr>
<td>VAGRANT_ALLOW_PLUGIN_SOURCE_ERRORS</td>
<td>0</td>
</tr>
</tbody>
</table>
<h2 class="mume-header" id="82-virtualbox">8.2. VirtualBox</h2>

<p>VirtualBox is a general-purpose full virtualizer for x86 hardware, targeted at server, desktop and embedded use.</p>
<h3 class="mume-header" id="821-installing-virtualbox">8.2.1. Installing VirtualBox</h3>

<p>For the class, it is assumed VirtualBox is installed, but below are the instructions for installing it on Windows 10.</p>
<ol>
<li>Open your browser to <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></li>
<li>Click <code>Windows hosts</code> link under <code>VirtualBox 5.2.6 platform packages</code>.</li>
<li>Find and click the installer to install.</li>
</ol>
<p>Then turn for Windows 10 turn off Hyper-V</p>
<ol>
<li>Click Windows <code>Start</code> and then type <code>turn Windows features on or off</code> into the search bar.</li>
<li>Select the icon with the corresponding name.</li>
<li>This will open the <code>Windows Features</code> page and then unselect the <code>Hyper-V</code> checkbox if it is enabled and then click <code>Okay</code>.</li>
</ol>
<p>The same site has the Mac OS X download. The install is less involved.</p>
<h2 class="mume-header" id="83-git-bash">8.3. Git Bash</h2>

<p>Is <code>git</code> packaged for Windows with bash (a command-line shell) and a collection of other, separate *NIX utilities, such as, <code>ssh</code>, <code>scp</code>, <code>cat</code>, <code>find</code> and others compiled for Windows.</p>
<h3 class="mume-header" id="831-installing-git-bash">8.3.1. Installing Git Bash</h3>

<p>If you are on Windows or on a lab computer, you'll need to install <code>git</code>.</p>
<ol>
<li>
<p>Download from <a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a></p>
</li>
<li>
<p>Click the installer.</p>
</li>
<li>
<p>Click <code>next</code> until you reach the <code>Configuring the line ending conversions</code> page select <code>Checkout as, commit Unix-style line endings</code>.</p>
</li>
<li>
<p>Then <code>next</code>, <code>next</code>, <code>next</code>...</p>
</li>
<li>
<p>On the Windows task bar, enter <code>git</code> into <code>Search Windows</code> then select <code>Git Bash</code>.  Use <code>Git Bash</code> instead of <code>Command</code> or <code>Powershell</code>.</p>
</li>
</ol>
<h2 class="mume-header" id="84-retrieve-course-material">8.4. Retrieve course material</h2>

<p>If you are reading this on paper and have nothing else, you only have a small portion of the class material. You will need to download the class project containing all the automation to spin up a DevOps toolchain and development, etc.</p>
<p>In a shell, for the purposes of the class, this means in <code>Git Bash</code>, clone the project from <a href="https://gitlab.mitre.org/mjwalsh/hands-on-DevOps.git">https://gitlab.mitre.org/mjwalsh/hands-on-DevOps.git</a> via git like so:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git -c http.sslVerify=false clone https://gitlab.mitre.org/mjwalsh/hands-on-DevOps.git
</code></pre><p>Output will resemble:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>&#x279C; git -c http.sslVerify=false clone https://gitlab.mitre.org/mjwalsh/hands-on-DevOps.git
Cloning into &apos;hands-on-DevOps&apos;...
remote: Counting objects: 742, done.
remote: Compressing objects: 100% (30/30), done.
remote: Total 742 (delta 12), reused 0 (delta 0)
Receiving objects: 100% (742/742), 233.15 MiB | 14.82 MiB/s, done.
Resolving deltas: 100% (285/285), done.
</code></pre><h2 class="mume-header" id="85-vagrant">8.5. Vagrant</h2>

<p>This class uses Vagrant, a command line utility for managing the lifecycle of virtual machines as a vagrant in that the VMs are not meant to hang around in the same place for long.</p>
<p>Unless you want to pollute your machine with every imaginable programming language, framework and library version you'll find yourself often creating a virtual machine (VM) for each software project. Sometimes more than one. And if you're like me of the past you'll end up with a VirtualBox full of VMs. If you haven't gone about this the right way, you'll end up wondering what VM went with which project and now how did I create it? The anti-pattern around this problem is to write documentation. A better way that aligns with  DevOps repeatable practices is to create automation to provision and configure your development VMs. This is where Vagrant comes in as it is &quot;a command line utility for managing the lifecycle of virtual machines.&quot;</p>
<h3 class="mume-header" id="851-documentation-and-source">8.5.1. Documentation and source</h3>

<p>Vagrant's documentation can be found at</p>
<p><a href="https://www.vagrantup.com/docs/index.html">https://www.vagrantup.com/docs/index.html</a></p>
<p>It's canonical (i.e., authoritative) source can be found at</p>
<p><a href="https://github.com/hashicorp/vagrant/">https://github.com/hashicorp/vagrant/</a></p>
<p>Vagrant is written in Ruby. In fact, a Vagrantfile is written in a Ruby DSL.</p>
<h3 class="mume-header" id="852-installing">8.5.2. Installing</h3>

<ol>
<li>
<p>Download the latest Vagrant release</p>
<p><a href="https://www.vagrantup.com/downloads.html">https://www.vagrantup.com/downloads.html</a></p>
<p>We have verified version 2.0.3 works on Windows</p>
<p><a href="https://releases.hashicorp.com/vagrant/2.0.3/vagrant_2.0.3_x86_64.msi">https://releases.hashicorp.com/vagrant/2.0.3/vagrant_2.0.3_x86_64.msi</a></p>
<p>Version 2.0.3 for Mac OS X works fine.</p>
</li>
<li>
<p>Click on the installer once downloaded and follow along. The installer may bury modals you need to respond to in the Windows Task bar, so keep an eye out for that. The installer will automatically add the <code>vagrant</code> command to your system path so that it is available on the command line. If it is not found, the documentation advises to try logging out and logging back into your system. It advises this is particularly necessary sometimes for Windows.  Windows will require a reboot, so remember to <strong>come back and complete step-3</strong>.</p>
</li>
<li>
<p>Replace the <code>vagrant_files/cacert.pem</code> into <code>C:\hashicorp\vagrant\embedded</code> for Windows, and for Mac OS X copy it to <code>/opt/vagrant/embedded</code>.  On Windows use the File Explorer to replace the existing <code>cacert.pem</code> file. The replacement has MITRE's certificates necessary for the SSL inspection hell.</p>
</li>
</ol>
<h3 class="mume-header" id="853-installing-plugins">8.5.3. Installing Plugins</h3>

<p>In the command line (in <code>Git Bash</code>, if on Windows) on the host</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant plugin install vagrant-proxyconf
vagrant plugin install vagrant-ca-certificates
vagrant plugin install vagrant-cachier
vagrant plugin install vagrant-vbguest
</code></pre><p>Verify with</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant plugin list
</code></pre><p>Resembles this</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant-ca-certificates (1.3.0)
vagrant-cachier (1.2.1)
vagrant-proxyconf (1.5.2)
vagrant-vbguest (0.15.1)
</code></pre><p><strong>NOTE</strong></p>
<ul>
<li>For lab computers remember to re-authenticate through <a href="http://info.mitre.org">http://info.mitre.org</a> to be able to access the Internet otherwise <code>vagrant</code> will error trying to retrieve the plugins.</li>
</ul>
<h3 class="mume-header" id="854-the-vagrantfile-explained">8.5.4. The Vagrantfile explained</h3>

<p>The Vagrantfile describes how to provision and configure one or more virtual machines.</p>
<p>Vagrant's own documentation puts it best:</p>
<p><em>Vagrant is meant to run with one Vagrantfile per project, and the Vagrantfile is supposed to be committed to version control. This allows other developers involved in the project to check out the code, run vagrant up, and be on their way. Vagrantfiles are portable across every platform Vagrant supports.</em></p>
<p>This project's Vagrantfile can be found at the root of the project and it contains the following components I broken apart in order to discuss.</p>
<h4 class="mume-header" id="8541-modelines">8.5.4.1. Modelines</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby"><span class="token comment"># -*- mode: ruby -*-</span>
<span class="token comment"># vi: set ft=ruby :</span>
</pre><p>When authoring, tells your text editor (e.g. emacs or vim) to choose a specific editing mode for the Vagrantfile. Line one is a <a href="http://www.gnu.org/software/emacs/manual/html_node/emacs/Choosing-Modes.html">modeline for emacs</a> and line two is a <a href="http://vim.wikia.com/wiki/Modeline_magic">modeline for vim</a>.</p>
<h4 class="mume-header" id="8542-proxy-reset-script">8.5.4.2. Proxy reset script</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby"><span class="token variable">$proxy_script</span> <span class="token operator">=</span> <span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">SCRIPT</span>
tmp<span class="token operator">=</span>`mktemp`
echo <span class="token string">"Remove prior proxy settings across the OS"</span> <span class="token number">2</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span>
egrep <span class="token operator">-</span>vi <span class="token string">"^\s*h?[ft]tps?_proxy.*"</span> <span class="token operator">/</span>etc<span class="token operator">/</span>environment <span class="token operator">></span> <span class="token variable">$tmp</span> <span class="token operator">&amp;&amp;</span> mv <span class="token variable">$tmp</span> <span class="token operator">/</span>etc<span class="token operator">/</span>environment
egrep <span class="token operator">-</span>vi <span class="token string">"^\s*proxy=.*"</span> <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>conf <span class="token operator">></span> <span class="token variable">$tmp</span> <span class="token operator">&amp;&amp;</span> mv <span class="token variable">$tmp</span> <span class="token operator">/</span>etc<span class="token operator">/</span>yum<span class="token punctuation">.</span>conf
rm <span class="token operator">-</span>f <span class="token operator">/</span>etc<span class="token operator">/</span>profile<span class="token punctuation">.</span>d<span class="token operator">/</span>proxy<span class="token punctuation">.</span>sh
<span class="token punctuation">[</span> <span class="token operator">-</span>e <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>docker <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> egrep <span class="token operator">-</span>vi <span class="token string">"^\s*h?[ft]tps?_proxy.*"</span> <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>docker <span class="token operator">></span> <span class="token variable">$tmp</span> <span class="token operator">&amp;&amp;</span> mv <span class="token variable">$tmp</span> <span class="token operator">/</span>etc<span class="token operator">/</span>sysconfig<span class="token operator">/</span>docker
rm <span class="token operator">-</span>f <span class="token variable">$tmp</span>
<span class="token constant">SCRIPT</span>
</pre><p><code>$proxy_script</code> is variable to hold the contents of a script used to remove proxy settings on the OS. I'm working to make it so the class project can be run off the MII.</p>
<h4 class="mume-header" id="8543-inserting-proxy-setting-via-host-environmental-variables">8.5.4.3. Inserting Proxy setting via host environmental variables</h4>

<p>The proxy setting section above uses the <code>vagrant-proxyconf</code> plugin to set vagrants (i.e., managed VMs) to use specified proxies by using http_proxy and no_proxy environment variable.</p>
<pre data-role="codeBlock" data-info="ruby" class="language-ruby"><span class="token constant">Vagrant</span><span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>

    <span class="token comment"># Set proxy settings (Depends on vagrant-proxyconf plugin) for all vagrants,</span>
    <span class="token comment"># if environment holds variables for</span>
    <span class="token keyword">if</span> <span class="token constant">Vagrant</span><span class="token punctuation">.</span>has_plugin<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">'vagrant-proxyconf'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">'http_proxy'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token constant">ENV</span><span class="token punctuation">[</span><span class="token string">'https_proxy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        puts <span class="token string">"http_proxy = <span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'http_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>http <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'http_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span> 
        puts <span class="token string">"https_proxy = <span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'https_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>   
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>https <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'https_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        puts <span class="token string">"ftp_proxy = <span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'ftp_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>ftp <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'https_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        puts <span class="token string">"no_proxy = <span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'no_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>no_proxy <span class="token operator">=</span> <span class="token string">"<span class="token interpolation"><span class="token delimiter tag">#{</span>ENV<span class="token punctuation">[</span><span class="token string">'no_proxy'</span><span class="token punctuation">]</span><span class="token delimiter tag">}</span></span>"</span>
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token keyword">true</span>
      <span class="token keyword">else</span>
        puts <span class="token string">"Not using an http proxy."</span>
        config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token keyword">false</span>
      <span class="token keyword">end</span>
    <span class="token keyword">else</span>
      <span class="token keyword">raise</span> <span class="token string">"Missing vagrant-proxyconf plugin.  Install via: vagrant plugin install vagrant-proxyconf"</span>
    <span class="token keyword">end</span> 
</pre><h4 class="mume-header" id="8544-alternatively-inserting-hard-coded-proxy-setting">8.5.4.4. Alternatively, inserting hard coded Proxy setting</h4>

<p>Or you can hard code the same settings. This later method will likely reduce issues in the class as I found a bug in the <code>vagrant-proxyconf</code> plugin.</p>
<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token comment"># Hard coded proxy settings</span>
  <span class="token keyword">if</span> <span class="token constant">Vagrant</span><span class="token punctuation">.</span>has_plugin<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">'vagrant-proxyconf'</span><span class="token punctuation">)</span>
    puts <span class="token string">"http_proxy = http://gatekeeper.mitre.org:80"</span> 
    config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>http <span class="token operator">=</span> <span class="token string">"http://gatekeeper.mitre.org:80"</span> <span class="token comment">#"http://129.83.31.1:80"</span>
    puts <span class="token string">"https_proxy = http://gatekeeper.mitre.org:80"</span> 
    config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>https <span class="token operator">=</span> <span class="token string">"http://gatekeeper.mitre.org:80"</span> <span class="token comment">#"http://129.83.31.1:80"</span>
    puts <span class="token string">"ftp_proxy = http://gatekeeper.mitre.org:80"</span> 
    config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>ftp <span class="token operator">=</span> <span class="token string">"http://gatekeeper.mitre.org:80"</span> <span class="token comment">#"http://129.83.31.1:80"</span>
    puts <span class="token string">"no_proxy = 127.0.0.1,localhost,.mitre.org,.local,192.168.0.10,192.168.0.11,192.168.0.12"</span>
    config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>no_proxy <span class="token operator">=</span> <span class="token string">"127.0.0.1,localhost,.mitre.org,.local,192.168.0.10,192.168.0.11,192.168.0.12"</span>
    config<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token keyword">true</span>
  <span class="token keyword">else</span>
    <span class="token keyword">raise</span> <span class="token string">"Missing vagrant-proxyconf plugin.  Install via: vagrant plugin install vagrant-proxyconf"</span>
  <span class="token keyword">end</span>
</pre><h4 class="mume-header" id="8545-inserting-mitre-ca-certificates">8.5.4.5. Inserting MITRE CA Certificates</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token comment"># add MITRE CA Certificates (Depends on vagrant-ca-certificates plugin) to all vagrants</span>
  <span class="token keyword">if</span> <span class="token constant">Vagrant</span><span class="token punctuation">.</span>has_plugin<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">'vagrant-ca-certificates'</span><span class="token punctuation">)</span>
    config<span class="token punctuation">.</span>ca_certificates<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token keyword">true</span>
    config<span class="token punctuation">.</span>ca_certificates<span class="token punctuation">.</span>certs <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token string">"http://pki.mitre.org/MITRE%20BA%20ROOT.crt"</span><span class="token punctuation">,</span>
      <span class="token string">"http://pki.mitre.org/MITRE%20BA%20NPE%20CA-1.crt"</span><span class="token punctuation">,</span>
      <span class="token string">"http://pki.mitre.org/MITRE%20BA%20NPE%20CA-3.crt"</span>
    <span class="token punctuation">]</span>
  <span class="token keyword">else</span>
    <span class="token keyword">raise</span> <span class="token string">"Missing vagrant-ca-certificates plugin.  Install via: vagrant plugin install vagrant-ca-certificates"</span>
  <span class="token keyword">end</span>
</pre><p>This section uses <code>vagrant-ca-certificates</code> to as the plugin's documentation puts it <em>configures the virtual machine to inject the specified certificates into the guest's root bundle. This is useful, for example, if your enterprise network has a firewall (or appliance) which utilizes SSL interception.</em> So, we aren't the only ones that have to deal with the havoc SSL interception brings to development.</p>
<h4 class="mume-header" id="8546-configuring-the-cache-plugin-to-speed-things-along">8.5.4.6. Configuring the cache plugin to speed things along</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token keyword">if</span> <span class="token constant">Vagrant</span><span class="token punctuation">.</span>has_plugin<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">"vagrant-cachier"</span><span class="token punctuation">)</span>
    <span class="token comment"># configure cached packages to be shared between instances of the same base box.</span>
    <span class="token comment"># more info on http://fgrehm.viewdocs.io/vagrant-cachier/usage</span>
    config<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>scope <span class="token operator">=</span> <span class="token symbol">:box</span>
  <span class="token keyword">else</span>
    <span class="token keyword">raise</span> <span class="token string">"Missing vagrant-cachier plugin.  Install via: vagrant plugin install vagrant-cachier"</span>
  <span class="token keyword">end</span>
</pre><p>This section uses the currently unmainained <code>vagrant-cachier</code> plugin to spead up things by sharing common package cache among vagrants.</p>
<h4 class="mume-header" id="8547-requiring-_vagrant-vbquest_-for-windows">8.5.4.7. Requiring <em>vagrant-vbquest</em> for Windows</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token keyword">if</span> <span class="token constant">Vagrant</span><span class="token punctuation">.</span>has_plugin<span class="token operator">?</span><span class="token punctuation">(</span><span class="token string">'vagrant-vbguest'</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span>
    <span class="token keyword">raise</span> <span class="token string">"Missing vagrant-vbguest plugin.  Install via: vagrant plugin install vagrant-guest"</span>    
  <span class="token keyword">end</span>
</pre><p><code>vagrant-vbguest</code> automatically installs the host's VirtualBox Guest Additions on the guest system. Not needed on Mac OS X, but needed on Windows.</p>
<h4 class="mume-header" id="8548-configuring-the-dev-vagrant">8.5.4.8. Configuring the <em>dev</em> vagrant</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token comment"># Provision multiple machines</span>

  <span class="token comment">## provision development vagrant</span>
  config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>define <span class="token string">"dev"</span><span class="token punctuation">,</span> primary<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token keyword">do</span> <span class="token operator">|</span>dev<span class="token operator">|</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>box <span class="token operator">=</span> <span class="token string">"centos/7"</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token string">"private_network"</span><span class="token punctuation">,</span> ip<span class="token punctuation">:</span> <span class="token string">"192.168.0.10"</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token symbol">:forwarded_port</span><span class="token punctuation">,</span> guest<span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> host<span class="token punctuation">:</span> <span class="token number">2222</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token string">'ssh'</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>hostname <span class="token operator">=</span> <span class="token string">"dev"</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>synced_folder <span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"/vagrant"</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">"virtualbox"</span>
    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provider <span class="token symbol">:virtualbox</span> <span class="token keyword">do</span> <span class="token operator">|</span>virtualbox<span class="token operator">|</span>
      virtualbox<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"DevOps Class - dev"</span>
      virtualbox<span class="token punctuation">.</span>customize <span class="token punctuation">[</span><span class="token string">"guestproperty"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token symbol">:id</span><span class="token punctuation">,</span> <span class="token string">"/VirtualBox/GuestAdd/VBoxService/--timesync-set-threshold"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
      virtualbox<span class="token punctuation">.</span>memory <span class="token operator">=</span> <span class="token number">2048</span>
      virtualbox<span class="token punctuation">.</span>cpus <span class="token operator">=</span> <span class="token number">2</span>
      virtualbox<span class="token punctuation">.</span>gui <span class="token operator">=</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span>

    <span class="token keyword">if</span> <span class="token operator">!</span>dev<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>enabled
      <span class="token comment"># remove all traces of proxy settings</span>
      dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provision <span class="token string">"shell"</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token string">"always"</span><span class="token punctuation">,</span> inline<span class="token punctuation">:</span> <span class="token variable">$proxy_sript</span>
    <span class="token keyword">end</span>

    <span class="token comment"># configure the vagrant via Ansible on the Vagrant</span>
    config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provision <span class="token string">"ansible_local"</span> <span class="token keyword">do</span> <span class="token operator">|</span>ansible<span class="token operator">|</span>
      ansible<span class="token punctuation">.</span>playbook <span class="token operator">=</span> <span class="token string">"ansible/development-playbook.yml"</span>
      ansible<span class="token punctuation">.</span>inventory_path <span class="token operator">=</span> <span class="token string">"hosts"</span>
      ansible<span class="token punctuation">.</span>limit <span class="token operator">=</span> <span class="token string">"all"</span>
      ansible<span class="token punctuation">.</span>install_mode <span class="token operator">=</span> <span class="token string">"pip"</span>
      ansible<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token string">"2.4.3.0"</span>
      ansible<span class="token punctuation">.</span>compatibility_mode <span class="token operator">=</span> <span class="token string">"2.0"</span>
      ansible<span class="token punctuation">.</span>verbose <span class="token operator">=</span> <span class="token string">"vvvv"</span> <span class="token comment"># true (equivalent to v), vvv, vvvv</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
</pre><p>This section provisions and configures a <code>dev</code> vagrant used for development</p>
<ul>
<li>
<p>The <code>config.vm.provision</code> block uses <code>ansible_local</code> to configure the <code>dev</code> vagrant. I've written Ansible roles under <code>ansible/roles</code> to automate the configuration of the vagrants.</p>
<ul>
<li><code>toolchain.vm.box</code> loads the vagrant with this <code>centos/7</code> vagrant base box.  Vagrant curates a listing of base boxes here <a href="https://app.vagrantup.com/boxes/search">https://app.vagrantup.com/boxes/search</a></li>
<li><code>dev.vm.synced_folder</code> mounts the class's project folder to <code>/vagrant</code> path in the vagrant.</li>
<li>The <code>dev.vm.provider</code> section tells the hypervisor how to configure the vagrant (i.e., how much memory, how many procesors)</li>
</ul>
</li>
<li>
<p><code>ansible_local</code> does not require one to have Ansible installed on the host. Vagrant handles installing it on the vagrant and executing the specified playbook.</p>
<ul>
<li>In this instance, I have <code>ansible.verbose</code> jacked to its highest setting providing loads of <em>dev</em> logging.  If too much information about what is going on unnerves you changing this to <code>false</code> will disable verbose logging.</li>
</ul>
</li>
</ul>
<h4 class="mume-header" id="8549-configuring-the-toolchain-vagrant">8.5.4.9. Configuring the <em>toolchain</em> vagrant</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token comment">## provision the pipeline vagrant</span>
  config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>define <span class="token string">"toolchain"</span><span class="token punctuation">,</span> autostart<span class="token punctuation">:</span> <span class="token keyword">false</span> <span class="token keyword">do</span> <span class="token operator">|</span>toolchain<span class="token operator">|</span>
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>box <span class="token operator">=</span> <span class="token string">"centos/7"</span>
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token string">"private_network"</span><span class="token punctuation">,</span> ip<span class="token punctuation">:</span> <span class="token string">"192.168.0.11"</span>  
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token symbol">:forwarded_port</span><span class="token punctuation">,</span> guest<span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span> host<span class="token punctuation">:</span> <span class="token number">2223</span><span class="token punctuation">,</span> id<span class="token punctuation">:</span> <span class="token string">'ssh'</span>
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>hostname <span class="token operator">=</span> <span class="token string">"toolchain"</span>
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>synced_folder <span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"/vagrant"</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">"virtualbox"</span><span class="token punctuation">,</span> mount_options<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'dmode=777'</span><span class="token punctuation">,</span><span class="token string">'fmode=777'</span><span class="token punctuation">]</span>
    toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provider <span class="token symbol">:virtualbox</span> <span class="token keyword">do</span> <span class="token operator">|</span>virtualbox<span class="token operator">|</span>
      virtualbox<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"DevOps Class - toolchain"</span>
      virtualbox<span class="token punctuation">.</span>customize <span class="token punctuation">[</span><span class="token string">"guestproperty"</span><span class="token punctuation">,</span> <span class="token string">"set"</span><span class="token punctuation">,</span> <span class="token symbol">:id</span><span class="token punctuation">,</span> <span class="token string">"/VirtualBox/GuestAdd/VBoxService/--timesync-set-threshold"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
      virtualbox<span class="token punctuation">.</span>customize <span class="token punctuation">[</span><span class="token string">"modifyvm"</span><span class="token punctuation">,</span> <span class="token symbol">:id</span><span class="token punctuation">,</span> <span class="token string">"--clipboard"</span><span class="token punctuation">,</span> <span class="token string">"bidirectional"</span><span class="token punctuation">]</span>
      virtualbox<span class="token punctuation">.</span>customize <span class="token punctuation">[</span><span class="token string">"modifyvm"</span><span class="token punctuation">,</span> <span class="token symbol">:id</span><span class="token punctuation">,</span> <span class="token string">"--draganddrop"</span><span class="token punctuation">,</span> <span class="token string">"bidirectional"</span><span class="token punctuation">]</span>
      virtualbox<span class="token punctuation">.</span>memory <span class="token operator">=</span> <span class="token number">4096</span>
      virtualbox<span class="token punctuation">.</span>cpus <span class="token operator">=</span> <span class="token number">4</span>
      virtualbox<span class="token punctuation">.</span>gui <span class="token operator">=</span> <span class="token keyword">false</span>
    <span class="token keyword">end</span>

    <span class="token keyword">if</span> <span class="token operator">!</span>toolchain<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>enabled
      <span class="token comment"># remove all traces of proxy settings</span>
      toolchain<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provision <span class="token string">"shell"</span><span class="token punctuation">,</span> run<span class="token punctuation">:</span> <span class="token string">"always"</span><span class="token punctuation">,</span> inline<span class="token punctuation">:</span> <span class="token variable">$proxy_sript</span>
    <span class="token keyword">end</span>

    <span class="token comment"># configure the vagrant via Ansible on the Vagrant</span>
    config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>provision <span class="token string">"ansible_local"</span> <span class="token keyword">do</span> <span class="token operator">|</span>ansible<span class="token operator">|</span>
      ansible<span class="token punctuation">.</span>playbook <span class="token operator">=</span> <span class="token string">"ansible/toolchain-playbook.yml"</span>
      ansible<span class="token punctuation">.</span>inventory_path <span class="token operator">=</span> <span class="token string">"hosts"</span>
      ansible<span class="token punctuation">.</span>limit <span class="token operator">=</span> <span class="token string">"all"</span>
      ansible<span class="token punctuation">.</span>install_mode <span class="token operator">=</span> <span class="token string">"pip"</span>
      ansible<span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token string">"2.4.2.0"</span>
      ansible<span class="token punctuation">.</span>compatibility_mode <span class="token operator">=</span> <span class="token string">"2.0"</span>
      ansible<span class="token punctuation">.</span>verbose <span class="token operator">=</span> <span class="token string">"vvvv"</span> <span class="token comment"># true (equivalent to v), vvv, vvvv</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
</pre><p>This section provisions and configures the <code>toolchain</code> vagrant. This is the beefy vagrant running GitLab. Drone CI, the private Docker registry, SonarQube, Selenium, Taiga...</p>
<h4 class="mume-header" id="85410-configuring-the-vagrants-from-one-playbook">8.5.4.10. Configuring the vagrants from one playbook</h4>

<pre data-role="codeBlock" data-info="ruby" class="language-ruby">  <span class="token comment"># # configure the vagrants via Ansible on the Vagrant</span>
  <span class="token comment"># config.vm.provision "ansible_local" do |ansible|</span>
  <span class="token comment">#   ansible.playbook = "ansible/playbook.yml"</span>
  <span class="token comment">#   ansible.inventory_path = "hosts"</span>
  <span class="token comment">#   ansible.limit = "all"</span>
  <span class="token comment">#   ansible.install_mode = "pip"</span>
  <span class="token comment">#   ansible.version = "2.4.2.0"</span>
  <span class="token comment">#   ansible.compatibility_mode = "2.0"</span>
  <span class="token comment">#   ansible.verbose = true # true (equivalent to v), vvv, vvvv</span>
  <span class="token comment"># end</span>
<span class="token keyword">end</span>
</pre><p>Instead of individually configuring each VM one could comment out vagrants individual <code>config.vm.provision</code> and uncomment this section to configure all the vagrants from one single playbook.</p>
<h2 class="mume-header" id="86-ansible">8.6. Ansible</h2>

<p>Ansible is a &quot;configuration management&quot; tool that automates software provisioning, configuration management, and application deployment.  Configuration management, deployment automation are two core repeated practices in DevOps, so for the purposes of the class Ansible addresses this concern in configuring the two vagrants.</p>
<p>Ansible was open source and then subsumed by Red Hat.</p>
<p>There are other &quot;configuration management&quot; tools, such as Chef and Puppet. There are of course even more, but they hold little or no market share (e.g., BOSH, Salt.)</p>
<h3 class="mume-header" id="861-playbooks">8.6.1. Playbooks</h3>

<p>In Ansible one defines playbooks to manage configurations of and deployments to remote machines. The playbooks I'm using to configure the vagrants exist in <code>ansible/</code>.</p>
<p>The <code>toolchain</code> vagrant Ansible playbook (<code>ansible/development-playbook.yml</code>) contains:</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token punctuation">---</span>
<span class="token comment"># Ansible playbook for toolchain </span>

<span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> toolchains
  <span class="token key atrule">remote_user</span><span class="token punctuation">:</span> vagrant
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> common
    <span class="token punctuation">-</span> docker
    <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>compose
    <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>registry
    <span class="token punctuation">-</span> taiga
    <span class="token punctuation">-</span> gitlab
    <span class="token punctuation">-</span> drone
    <span class="token punctuation">-</span> sonarqube
    <span class="token punctuation">-</span> golang<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> python<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> golang<span class="token punctuation">-</span>sonarqube<span class="token punctuation">-</span>scanner<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> standalone<span class="token punctuation">-</span>firefox<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> owasp<span class="token punctuation">-</span>zap2docker<span class="token punctuation">-</span>stable<span class="token punctuation">-</span>image
<span class="token comment">#    - standalone-chrome-container-image</span>
<span class="token comment">#    - gnome-desktop</span>
<span class="token comment">#    - firefox</span>
<span class="token comment">#    - chrome</span>
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">docker_compose_version</span><span class="token punctuation">:</span> <span class="token string">"1.21.0"</span>
</pre><p>The file is written in a YAML-based DSL (domain specific language.)</p>
<h3 class="mume-header" id="862-roles">8.6.2. Roles</h3>

<p>The roles exist in <code>ansible/roles</code> and permit Roles easy sharing of bits of configuration content with other users. Roles can also be found in the <a href="https://galaxy.ansible.com/">Ansible Galaxy</a>, retrieved and placed into the <code>ansible/roles</code> folder to be used, but I wrote all the roles for the class.</p>
<p>A role, such as a Taiga role is comprised of many components (e.g., files, templates), but at its core is the main task. The main task for the <code>taiga</code> roles contains</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token punctuation">---</span>
<span class="token comment"># tasks file for taiga</span>

<span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> copy taiga files to /root/taiga
  <span class="token key atrule">become</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">copy</span><span class="token punctuation">:</span>
    <span class="token key atrule">src</span><span class="token punctuation">:</span> files/
    <span class="token key atrule">dest</span><span class="token punctuation">:</span> /root/taiga

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> make /root/taiga/dockerfile_build.sh executable
  <span class="token key atrule">become</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">file</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> /root/taiga/dockerfile_build.sh
    <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">"u=rwx,g=r,o=r"</span>

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> template files into /root/taiga
  <span class="token key atrule">become</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"{{ item.src }}"</span>
    <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"{{ item.dest }}"</span>
  <span class="token key atrule">with_items</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"templates/README.j2"</span><span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/root/taiga/README.MD"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"templates/docker-compose.j2"</span><span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/root/taiga/docker-compose.yml"</span> <span class="token punctuation">}</span>
    <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">"templates/taiga-front-dist/dist/conf.j2"</span><span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">"/root/taiga/volumes/taiga-front-dist/dist/conf.json"</span> <span class="token punctuation">}</span>

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> build nemonik/taiga<span class="token punctuation">:</span>latest docker image w/ buildargs to handle possible http proxy
  <span class="token key atrule">become</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">docker_image</span><span class="token punctuation">:</span>
    <span class="token key atrule">path</span><span class="token punctuation">:</span> /root/taiga
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nemonik/taiga<span class="token punctuation">:</span>latest
    <span class="token key atrule">buildargs</span><span class="token punctuation">:</span>
      <span class="token key atrule">https_proxy</span><span class="token punctuation">:</span> <span class="token string">"{{ ansible_env.HTTP_PROXY }}"</span>
      <span class="token key atrule">http_proxy</span><span class="token punctuation">:</span> <span class="token string">"{{ ansible_env.HTTP_PROXY }}"</span>
      <span class="token key atrule">HTTP_PROXY</span><span class="token punctuation">:</span> <span class="token string">"{{ ansible_env.HTTP_PROXY }}"</span>
      <span class="token key atrule">HTTPS_PROXY</span><span class="token punctuation">:</span> <span class="token string">"{{ ansible_env.HTTP_PROXY }}"</span>
      <span class="token key atrule">NO_PROXY</span><span class="token punctuation">:</span> <span class="token string">"{{ no_proxy }}"</span>
      <span class="token key atrule">no_proxy</span><span class="token punctuation">:</span> <span class="token string">"{{ no_proxy }}"</span> 

<span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> spin up taiga via docker<span class="token punctuation">-</span>compose
  <span class="token key atrule">become</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">docker_service</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> no
    <span class="token key atrule">debug</span><span class="token punctuation">:</span> yes
    <span class="token key atrule">project_src</span><span class="token punctuation">:</span> /root/taiga/
</pre><p>The <code>Taiga</code> role dependes on <code>docker-compose</code>, <code>docker</code>, and <code>common</code> having configured the vagrant.</p>
<h4 class="mume-header" id="8621-docker-image-and-containers">8.6.2.1. Docker image and containers</h4>

<p>So, what is Docker?  What are container images?  What are Containers?</p>
<p>A container image is a lightweight, self-contained, executable package that includes everything needed to run your application including runtime, system tools, system libraries, and settings.</p>
<p>A container is essentially an isolated processes running in user space.  The benefit over Virtual Machines in that multiple containers can run on the same machine (in case of this class, a vagrant) sharing the OS kernel with other containers.  Whereas a VM would require a full copy of an operating system in order to run the application.  This makes containers insanely light-weight.</p>
<p>More can be read on the topic at</p>
<p><a href="https://www.docker.com/what-container">https://www.docker.com/what-container</a></p>
<p>You will build a Docker image and spin up a container in this class.</p>
<h4 class="mume-header" id="8622-docker-image-and-containers">8.6.2.2. Docker image and containers</h4>

<p>And what is docker-compose?</p>
<p>Doceker-compose is a tool and domain specific language based on YAML used to define and run multi-container Docker applications.</p>
<p>What is YAML?  YAML bills itself as <em>a human-friendly data serialization standard for all programming languages.</em> YAML also follows in in the computing tradition of being a recursive acronym, <em>YAML Ain't Markup Language.</em>  Many of the tools used in this course make use of YAML, so you will see plenty examples of it.</p>
<p>You will edit a <code>docker-compose.yml</code> file in this class in order to complete the configuration of one the key CI/CD tools.</p>
<h2 class="mume-header" id="87-spinning-up-the-_toolchain_-vagrant">8.7. Spinning up the <em>toolchain</em> vagrant</h2>

<p>In the command line of the host in the root of the class project, open <code>ansible/tool-chain-playbook.yml</code> and make sure the roles are as so:</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token punctuation">---</span>
<span class="token comment"># Ansible playbook for toolchain </span>

<span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> toolchains
  <span class="token key atrule">remote_user</span><span class="token punctuation">:</span> vagrant
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> common
    <span class="token punctuation">-</span> docker
    <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>compose
    <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>registry
    <span class="token punctuation">-</span> taiga
    <span class="token punctuation">-</span> gitlab
    <span class="token punctuation">-</span> drone
    <span class="token punctuation">-</span> sonarqube
    <span class="token punctuation">-</span> golang<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> python<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> golang<span class="token punctuation">-</span>sonarqube<span class="token punctuation">-</span>scanner<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> standalone<span class="token punctuation">-</span>firefox<span class="token punctuation">-</span>container<span class="token punctuation">-</span>image
    <span class="token punctuation">-</span> owasp<span class="token punctuation">-</span>zap2docker<span class="token punctuation">-</span>stable<span class="token punctuation">-</span>image
<span class="token comment">#    - standalone-chrome-container-image</span>
<span class="token comment">#    - gnome-desktop</span>
<span class="token comment">#    - firefox</span>
<span class="token comment">#    - chrome</span>
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">docker_compose_version</span><span class="token punctuation">:</span> <span class="token string">"1.21.0"</span>
</pre><p>Then enter into the command-line of the host at the root of the class project</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant up toolchain
</code></pre><p>You will see a good deal of output and on the Windows OS it will pester you to approve certain things.  Blindly approve everything.</p>
<p>Once complete open a secure shell (ssh) to the <code>toolchain</code> vagrant</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant ssh toolchain
</code></pre><p>The command line will open a prompt a bash shell on the vagrant</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@toolchain ~]$
</code></pre><p>On this vagrant will be running a number of DevOps tools.  This will take a while, so let's discuss what is being installed.  Caution, it is easy to forget DevOps is as much about culture as it is about a methodology and repeated practices (often further mistakenly thought as &quot;tools and automation&quot;), so keep this in mind.  The tools, methodology, an repeated practices exist to support the culture.</p>
<h3 class="mume-header" id="871-taiga-an-example-of-agile-project-management-software">8.7.1. Taiga, an example of Agile project management software</h3>

<p>Taiga is an Open Source project management platform for agile development.</p>
<p>There are many project management platforms for Agile.</p>
<p>Typically, Agile teams work using a visual task management tool such as a project board, task board or Kanban or Scrum visual management board. These boards can be implemented using a whiteboard or open space on a wall or in software. The board is at a minimum segmented into a few columns <em>To do</em>, <em>In process</em>, and <em>Done</em>, but the board can be tailored. I've personally seen boards for very large projects consume every bit of wallspace of a very large cavernous room, but as Lean-Agile has matured, teams have grown larger and more disparate, tools have emerged to provide a clear view into a project's management to all levels of concern (e.g., developers, managers, product owner, and the customer) answering:</p>
<ul>
<li>Are deadlines being achieved?</li>
<li>Are team members overloaded?</li>
<li>How much is complete?</li>
<li>What's next?</li>
</ul>
<p>Further, the Lean-Agile Software tools should provide the following capabilities:</p>
<ul>
<li>Dividing integration and development effort into multiple projects.</li>
<li>Defining, allocating, and viewing resources and their workload across each product.</li>
<li>Defining, maintaining, and prioritizing the accumulation of an individual product's requirements, features or technical tasks which, at a given moment, are known to be necessary and sufficient to complete a project's release.</li>
<li>Facilitating the selection and assignment of individual requirements to resources, and the tracking of progress for a release.</li>
<li>Permit collaboration with external third parties.</li>
</ul>
<p>The 800lb Gorilla in this market segment is JIRA Software. Some of my co-workers hate it. It is part of the Atlassian suite providing provides collaboration software for teams with products including JIRA Software, Confluence, HipChat, Bitbucket, and Stash.</p>
<p>MITRE provides:</p>
<ul>
<li>JIRA Software as part of CODEV at <a href="https://tracker.codev.mitre.org/secure/Dashboard.jspa">https://tracker.codev.mitre.org/secure/Dashboard.jspa</a> where you have to first login via <a href="https://login.codev.mitre.org/portal">https://login.codev.mitre.org/portal</a>.</li>
<li>Taiga at <a href="https://taiga.mitre.org/">https://taiga.mitre.org/</a> using your MITRE username and password to log in.</li>
</ul>
<p>There may be more. I'm simply not aware of them.</p>
<p>A number of MITRE projects also use Pivotal Lab's Pivotal Tracker, a SaaS.</p>
<h4 class="mume-header" id="8711-documentation-source-container-image">8.7.1.1. Documentation, source, container image</h4>

<p>Taiga's documentation can be found at</p>
<p>It's canonical source can be found at</p>
<p><a href="https://github.com/taigaio/taiga-front-dist/">https://github.com/taigaio/taiga-front-dist/</a></p>
<p>dedicated to the front-end, and</p>
<p><a href="https://github.com/taigaio/taiga-back/">https://github.com/taigaio/taiga-back/</a></p>
<p>dedicated to the back-end.</p>
<p>Taiga doesn't directly offer a Docker container image for, but I've authored an image that collapses both taiga-front-dist and -back onto one container behind an NGINX reverse proxy.</p>
<h4 class="mume-header" id="8712-url-username-and-password">8.7.1.2. URL, Username and password</h4>

<p>Once, stood up your instance of Taiga will reachable at</p>
<p><a href="http://192.168.0.11:8080/">http://192.168.0.11:8080/</a></p>
<p>The default admin accont username and password are</p>
<p><strong>admin</strong> <strong>123123</strong></p>
<h3 class="mume-header" id="872-gitlab-ce-an-example-of-configuration-management-software">8.7.2. GitLab CE, an example of configuration management software</h3>

<p>GitLab is installed on the <code>toolchain</code> vagrant, where it will be accessible at <a href="http://192.168.0.11:10080/">http://192.168.0.11:10080/</a>.</p>
<p>GitLab Community Edition (CE) is an open source end-to-end software development platform with built-in version control, issue tracking, code review, and CI/CD.</p>
<p>For Agile teams to collaborate, a Configuration management (CM) is necessary to coordinate the development of new feature, changes, and experimentation. Also, a CM system (CMS) provides a history of changes, and thereby, the ability to roll back to a version known to be acceptable.</p>
<p>At a minimum, the following items will be placed under revision control in CM:</p>
<ul>
<li>
<p>Source code,</p>
</li>
<li>
<p>If a database is needed, schema initialization and the migration between versions,</p>
</li>
<li>
<p>Text documentation containing</p>
<ul>
<li>
<p>a synopsis (i.e., project name, overview, etc.),</p>
</li>
<li>
<p>version description,</p>
</li>
<li>
<p>guidance covering</p>
<ul>
<li>build,</li>
<li>unit testing, and</li>
<li>installation</li>
</ul>
</li>
<li>
<p>a contributor enumeration,</p>
</li>
<li>
<p>license and/or ownership declaration with contacts, etc.,</p>
</li>
</ul>
</li>
</ul>
<p>A single CMS and the associated workflow (e.g., GitHub Workflow) can serve as the focal point for the entire enterprise thereby provide centralized version control if all documentation is authored in a lightweight markup language with plain text formatting syntax (e.g., Markdown, PlantUML).</p>
<p>A CMS must facilitate best practices, not limited to:</p>
<ul>
<li>
<p>A means for developers to copy and work off a complete repository thereby permitting</p>
<ul>
<li>Private individual work to later be synchronized via exchanging sets of changes (i.e., patches) through a means described as &quot;distributed version control&quot;, and</li>
<li>Pre-flight build and test of their source code in their own private workspace, so as to minimize the chance of committing broken or untested source code thereby encouraging</li>
<li>The committing of completed source code only.</li>
</ul>
</li>
<li>
<p>Granular commits that communicate the motivation for the commit (i.e., the what and why). For example, for a change these could be:</p>
<ul>
<li>the inclusion of a new feature,</li>
<li>a bug fix,</li>
<li>the removal of dead code</li>
</ul>
</li>
<li>
<p>Reducing the risk breaking a build by</p>
<ul>
<li>Utilize branching to separate different lines of development, and</li>
<li>Standardize on CMS workflows (e.g., GitHub Workflow),</li>
</ul>
</li>
<li>
<p>Make builds be self-testing (i.e., ingrain testing) by including unit and integration test with the source code so that it can be executed by</p>
<ul>
<li>the build automation, and</li>
<li>the Continuous Integration service.</li>
</ul>
</li>
<li>
<p>Trigger follow-on activities orchestrated by the Continuous Integration Service.</p>
</li>
</ul>
<p>MITRE provides:</p>
<ul>
<li>A GitLab at <a href="https://gitlab.mitre.org/users/sign_in">https://gitlab.mitre.org/users/sign_in</a> uses your MITRE username and password to authenticate. This is where you retrieved this class, so you already knew this.</li>
<li>Bitbucket (formally Stash) under CODEV at <a href="https://git.codev.mitre.org/dashboard">https://git.codev.mitre.org/dashboard</a> where you have to first login via <a href="https://login.codev.mitre.org/portal">https://login.codev.mitre.org/portal</a>.</li>
</ul>
<h4 class="mume-header" id="8721-documentation-source-container-image">8.7.2.1. Documentation, source, container image</h4>

<p>GitLab's documentation can be found at</p>
<p><a href="https://docs.gitlab.com/ce/">https://docs.gitlab.com/ce/</a></p>
<p>It's canonical source can be found at</p>
<p><a href="https://hub.docker.com/r/sameersbn/gitlab/">https://hub.docker.com/r/sameersbn/gitlab/</a></p>
<p><a href="https://gitlab.com/gitlab-org/gitlab-ce">https://gitlab.com/gitlab-org/gitlab-ce</a></p>
<p>I'm using Sameer Naik's Docker container image for GitLab. The image can be found at</p>
<p><a href="https://hub.docker.com/r/sameersbn/gitlab/">https://hub.docker.com/r/sameersbn/gitlab/</a></p>
<p>And its canonical source is located at</p>
<p><a href="https://github.com/sameersbn/docker-gitlab">https://github.com/sameersbn/docker-gitlab</a></p>
<h4 class="mume-header" id="8722-url-username-and-password">8.7.2.2. URL, Username and password</h4>

<p>Once, stood up your instance of GitLab will reachable at</p>
<p><a href="http://192.168.0.11:10080/">http://192.168.0.11:10080/</a></p>
<p>GitLab requires you to enter a password for its <strong>root</strong> account. You will be using the root account to host your repositories vice creating your own, but if you want you can. There is nothing stopping you.</p>
<p>I would suggest for the purposes of the class choosing something simple, but at least the same number of characters as &quot;password&quot;.</p>
<h3 class="mume-header" id="873-drone-ci-an-example-of-cicd-orchestrator">8.7.3. Drone CI, an example of CI/CD orchestrator</h3>

<p>Drone CI often referred to simply as &quot;Drone&quot; is installed on the <code>toolchain</code> vagrant, where it will be accessible at <a href="http://192.168.0.11:8000/">http://192.168.0.11:8000/</a> after some user configuration that will be explained later in the <em>Integrate Drone CI with GitLab</em> section.</p>
<p>Drone is essentially a Continuous Delivery system built on container technology.</p>
<p>Drone is distributed as a Docker image. Drone CI can be run with an internal SQLite database, but it is advisable to run with an external database and this the configuration the class uses. It also integrates with multiple version control providers (i.e., GitHub, GitLab, BitBucket, Stash, and Gogs). Both CMS and database are configured using environment variables passed when the Drone CI container is first to run. Drone plugins (really just containers) can be used to deploy code, publish artifacts, send a notification, etc. Drone's approach to plugins is novel as plugins are really just Docker containers distributed in a typical manner. Each plugin is designed to perform pre-defined tasks and is configured as steps in your pipeline. Plugins are executed with read/write/execution access at the root of the source branch, therefore, permitting the pipeline to interact with the specific branch of source to build, test, bundle, deliver, and deploy. Developers create a Drone CI pipeline by placing a <code>.drone.yml</code> file in the root of the repository. The .drone.yml is authored in a domain specific language (DSL) that is a superset of the docker-compose DSL to describe the build with multiple named steps executed in a separate Docker container having shared disk access to the specific branch of the source repository.</p>
<p>Drone and its brethren (e.g., Jenkins CI, GitLab CI/CD) is used to facilitate Continuous Integration (CI), a software development practice where members of an Agile team frequently integrate their work in order to detect integration issues as soon as possible. Each integration is orchestrated through a service that essentially assembles a build and runs tests every time a predetermined trigger has been met; and then reports with immediate feedback.</p>
<p>MITRE provides a Jenkins CI server at <a href="https://jenkins.mitre.org/">https://jenkins.mitre.org/</a>. Use you MITRE username and password to authenticate and you can have at all that Jenkins CI goodness. I don't use it unless I have to. Why? I'm simply not a fan. Initially, because its plugin architecture is painful to manage and your pipelines existed entirely in the Jenkins CI tool itself. Later, Jenkins CI introduced Groovy-based Jenkin Pipelines that were CMed wit your project's source. Every orchestrator has based their DSL on YAML and although I love the Groovy language for its power, I don't find it makes for a good orchestration language. Your opinion may differ. I'm okay with that.</p>
<p>There are also SaaS CI/CD tools, such as Travis CI and Circle CI. These are great, free CI/CD orchestrators.</p>
<p>My <a href="https://github.com/STIXProject/java-stix">java-stix</a> project hosted on <a href="http://GitHub.com">GitHub.com</a> uses both Travis CI and Circle CI as part of its continuous integration.</p>
<p>The <a href="https://github.com/STIXProject/java-stix/blob/master/.travis.yml">Travis CI orchestration</a> contains</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token key atrule">language</span><span class="token punctuation">:</span>  java
<span class="token key atrule">dist</span><span class="token punctuation">:</span> precise
<span class="token key atrule">jdk</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> oraclejdk7

<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> chmod +x gradlew

<span class="token key atrule">env</span><span class="token punctuation">:</span> GRADLE_OPTS=<span class="token punctuation">-</span>Dorg.gradle.daemon=true
<span class="token key atrule">env</span><span class="token punctuation">:</span> CI_OPTS=<span class="token punctuation">-</span><span class="token punctuation">-</span>stacktrace

<span class="token key atrule">install</span><span class="token punctuation">:</span> /bin/true
<span class="token key atrule">script</span><span class="token punctuation">:</span> <span class="token string">"./gradlew -x signArchives"</span>
</pre><p>Whereas, the <a href="https://github.com/STIXProject/java-stix/blob/master/circle.yml">Circle CI orchestration</a> contains</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token key atrule">machine</span><span class="token punctuation">:</span>
  <span class="token key atrule">java</span><span class="token punctuation">:</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> oraclejdk7
  <span class="token key atrule">environment</span><span class="token punctuation">:</span>
    <span class="token key atrule">GRADLE_OPTS</span><span class="token punctuation">:</span> <span class="token punctuation">-</span>Dorg.gradle.daemon=true
    <span class="token key atrule">CI_OPTS</span><span class="token punctuation">:</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>stacktrace <span class="token punctuation">-</span><span class="token punctuation">-</span>debug

<span class="token key atrule">test</span><span class="token punctuation">:</span>
  <span class="token key atrule">override</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> ./gradlew <span class="token punctuation">-</span>x signArchives
</pre><p>They are essentially similar both requiring the Oracle JDK and use Gradle to build and unit test the code. Both SaaS under the covers uses containers to run the builds.</p>
<p>In another GitHub hosted project, the <a href="https://github.com/STIXProject/java-stix-validator">java-stix-validator</a> the <a href="https://github.com/STIXProject/java-stix-validator/blob/master/.travis.yml">Travis CI orchestration</a> contains</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token key atrule">language</span><span class="token punctuation">:</span> java
<span class="token key atrule">jdk</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> oraclejdk8
<span class="token key atrule">before_install</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> chmod +x gradlew
<span class="token key atrule">env</span><span class="token punctuation">:</span> CI_OPTS=<span class="token punctuation">-</span><span class="token punctuation">-</span>stacktrace
<span class="token key atrule">install</span><span class="token punctuation">:</span> <span class="token string">"/bin/true"</span>
<span class="token key atrule">script</span><span class="token punctuation">:</span> <span class="token string">"./gradlew build -d"</span>
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> heroku
  <span class="token key atrule">api_key</span><span class="token punctuation">:</span>
    <span class="token key atrule">secure</span><span class="token punctuation">:</span> m9Gbt0Oyqtjwyu4Y8CVobNNnj1q5mFt+Ygi2wiDWlf/RunLOj2CE8YAYuRyEAbpCOd1lrmrhmQb8uQAfiydauYBcQE5yyOlyIhNkrLi2m1+we0VeWWr6gxIVz57VuAhfbzoMtvkhmxl/Ey0U+1vI7tYurK0thzFUyQFqZh1wNq6EldIfHxVNxDZbEVtkDzFtK5cmVnPE8HM9xaQmuV7k3NhrvRS4pzN87uvndfFVb0vDhLmg5DulF+PLkdpP9UC5jsAE1HXMBL0cTtsvSHUkIyO7qhLb0RFAzVdRMvn7kEW2Q0ekoK09sPR13VwmfjewzHSNrWIf+rjJx7EzoBzbq5/VmC9nxH1oiGpXxoAG08pJjcQYMSxsa2JZLH8dSIEaMgOFNOxkrAhcqP59xXWZ9WVLCYPSN4atmg4L6etJOzFqfz3jAp40AB4Eu2QU49c60r6BH31Xj8ymjKMKqnlL199qCoqfZtv7FYqOFG3keLeWvL/F7JhmtV+JdvuqVPEvNq2D1b3kdCKk2cw4lmRCwC9hdT2oXTCwhjQvYwSm0sHQ98aeV55FkE7DuH4B+CuzYw4N9K78j3eQtW2Oas1lLCoHSDXgA/4O79RlM8p0nLa3MjdVq5OSIjbcCqhDLBe8nc5ucSpMMjnjNvhAKvcyrc5AbXdIVaLVvE2azMuZJLo=
  <span class="token key atrule">app</span><span class="token punctuation">:</span> agile<span class="token punctuation">-</span>journey<span class="token punctuation">-</span><span class="token number">9583</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span>
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> STIXProject/java<span class="token punctuation">-</span>stix<span class="token punctuation">-</span>validator
</pre><p>To deploy the web application to <a href="https://www.heroku.com/">Heroku</a>, one of the first PaaS (Platforms-as-Service). The code was last committed in 2015 and the code is still running free on Heroku at <a href="http://agile-journey-9583.herokuapp.com/#/">http://agile-journey-9583.herokuapp.com/#/</a></p>
<p>More details on Drone is sprinkled across the class. As you can see I favor being a polyglot when it comes to CI/CD.</p>
<h4 class="mume-header" id="8731-documentation-source-container-image">8.7.3.1. Documentation, source, container image</h4>

<p>Drone's main site is at</p>
<p><a href="https://drone.io/">https://drone.io/</a></p>
<p>Its documentation is at</p>
<p><a href="http://docs.drone.io/">http://docs.drone.io/</a></p>
<p>Its plugin market is at</p>
<p><a href="http://plugins.drone.io/">http://plugins.drone.io/</a></p>
<p>Drone's canonical source can be found at</p>
<p><a href="https://github.com/drone/drone">https://github.com/drone/drone</a></p>
<p>Drone is distributed as a container image and can be found respectfully at</p>
<p><a href="https://hub.docker.com/r/drone/drone/">https://hub.docker.com/r/drone/drone/</a></p>
<p>and</p>
<p><a href="https://hub.docker.com/r/drone/agent/">https://hub.docker.com/r/drone/agent/</a></p>
<h4 class="mume-header" id="8732-url-username-and-password">8.7.3.2. URL, Username and password</h4>

<p>Once, stood up your instance of Drone CI will reachable at</p>
<p><a href="http://192.168.0.11:8000/">http://192.168.0.11:8000/</a></p>
<p>Drone will authenticate you off GitLab once integrated.</p>
<h3 class="mume-header" id="874-integrate-drone-ci-with-gitlab">8.7.4. Integrate Drone CI with GitLab</h3>

<p>Once, Drone is configured, accomplish the steps.</p>
<p>The Ansible automation will install patched docker containers for Drone and template the docker-compose file used to spin it up, but the automation will not spin up Drone as it requires human intervention in the absence of automation.</p>
<p>So, you will need to accomplish the following steps, while at the same time becoming familiar with GitLab.</p>
<ol>
<li>As <code>Root</code> log into GitLab with the password you entered in the prior step,</li>
<li>Click on the <code>wrench</code> to enter the <code>Admin Area</code>,</li>
<li>Click <code>Applications</code>,</li>
<li>Click <code>New Application</code>,</li>
<li>Enter <code>Drone CI</code> for <code>Name</code>,</li>
<li>Enter <code>http://192.168.0.11:8000/authorize</code>,</li>
<li>Click <code>submit</code>,</li>
<li>In a command line on the host (i.e., the machine running the vagrants) at the root of the class project enter into the host's command line at the root of the project:</li>
</ol>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant ssh toolchain
</code></pre><ol start="9">
<li>On the <code>toolchain</code> vagrant enter into the command line</li>
</ol>
<pre data-role="codeBlock" data-info="" class="language-"><code>sudo su
cd /root/drone
</code></pre><ol start="10">
<li>Around line 50, apply the <code>Application Id</code> and <code>Secret</code> provided by GitLab by setting <code>DRONE_GITLAB_CLIENT</code> and <code>DRONE_GITLAB_SECRET</code> respectively by editing  <code>docker-compose.yml</code>.</li>
</ol>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">            <span class="token punctuation">-</span> DRONE_GITLAB_CLIENT=Your Application Id
            <span class="token punctuation">-</span> DRONE_GITLAB_SECRET=Your Secret
</pre><p>Delete <code>Your Application Id</code> and <code>Your Secret</code> text and replace with <code>Application Id</code> and <code>Secret</code>, respectively.</p>
<ol start="11">
<li>Then enter into the command line</li>
</ol>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker-compose up -d
</code></pre><p>Command line output will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@toolchain drone]$ ./start.sh
Creating drone_drone-server_1     ... done
Creating drone_drone-server_1     ...
Creating drone_drone-agent_1      ... done
</code></pre><p>You can drop <code>-d</code> on the <code>docker-compose</code> so as to not daemonize the drone, so you can monitor its logging for issues.</p>
<ol start="12">
<li>Exit the root session.</li>
</ol>
<pre data-role="codeBlock" data-info="" class="language-"><code>exit
</code></pre><ol start="13">
<li>Head over or <a href="http://192.168.0.11:8000">http://192.168.0.11:8000</a> and click <code>Authorize</code> to permit Drone to use your GitLab account.</li>
</ol>
<p>You will only have to do these step in regards to Drone once. Drone should always restart in the toolchain vagrant even if you <code>halt</code> the vagrant and later bring it <code>up</code>.</p>
<h3 class="mume-header" id="875-sonarqube-an-example-of-a-platform-for-the-inspection-of-code-quality">8.7.5. SonarQube, an example of a platform for the inspection of code quality</h3>

<p>SonarQube provides the capability to show the health of an application's source code, highlighting issues as they are introduced. SonarQube can be extended by language-specific extensions/plugins to report on duplicated code, coding standards, unit tests, code coverage, code complexity, comments, bugs, and security vulnerabilities.</p>
<h4 class="mume-header" id="8751-documentation-source-container-image">8.7.5.1. Documentation, source, container image</h4>

<p>SonarQube's main site is at</p>
<p><a href="https://www.sonarqube.org/">https://www.sonarqube.org/</a></p>
<p>Its documentation is at</p>
<p><a href="https://docs.sonarqube.org/display/SONAR/Documentation">https://docs.sonarqube.org/display/SONAR/Documentation</a></p>
<p>SonarQube's canonical source can be found here</p>
<p><a href="https://github.com/SonarSource/sonarqube">https://github.com/SonarSource/sonarqube</a></p>
<p>I'm using the container image provided at</p>
<p><a href="https://hub.docker.com/_/sonarqube/">https://hub.docker.com/_/sonarqube/</a></p>
<h4 class="mume-header" id="8752-url-username-and-password">8.7.5.2. URL, Username and password</h4>

<p>Once, stood up your instance of SonarQube will reachable at</p>
<p><a href="http://192.168.0.11:9000/">http://192.168.0.11:9000/</a></p>
<p>The default admin account username and password is</p>
<p><strong>admin</strong></p>
<h2 class="mume-header" id="88-spin-up-the-_dev_-vagrant">8.8. Spin up the <em>dev</em> vagrant</h2>

<p>In another command line of the host in the root of the class project</p>
<p>Open <code>ansible/tool-chain-playbook.yml</code> and make sure these roles are uncommented:</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token punctuation">---</span>
<span class="token comment"># Ansible playbook for dev vagrant</span>

<span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>development<span class="token punctuation">]</span>
  <span class="token key atrule">remote_user</span><span class="token punctuation">:</span> vagrant
  <span class="token key atrule">roles</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> common
    <span class="token punctuation">-</span> golang
    <span class="token punctuation">-</span> golint
    <span class="token punctuation">-</span> docker
    <span class="token punctuation">-</span> drone<span class="token punctuation">-</span>cli
    <span class="token punctuation">-</span> docker<span class="token punctuation">-</span>compose 
    <span class="token punctuation">-</span> sonar<span class="token punctuation">-</span>scanner
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token key atrule">golang_version</span><span class="token punctuation">:</span> <span class="token string">"1.10.1"</span>
    <span class="token key atrule">docker_compose_version</span><span class="token punctuation">:</span> <span class="token string">"1.21.0"</span>
</pre><p>Then in the command-line of the host (not while ssh'ed into the toolchain vagrant) at the root of the class project</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant up dev
</code></pre><p>You will see a good deal of output.</p>
<p>Once complete open a secure shell to the <code>dev</code> vagrant</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant ssh dev
</code></pre><p>Command line will open a prompt to the vagrant</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev ~]$
</code></pre><h2 class="mume-header" id="89-golang-_helloworld_-project">8.9. Golang <em>helloworld</em> project</h2>

<p>The prior <code>toolchain</code> and <code>dev</code> vagrants are required to be up and running for the following sections.</p>
<p>In this next part, we will create a simple helloworld GoLang project to demonstrate Continuous Integration. GoLang lends itself well to DevOps and underlines almost every new tool you can think of related to DevOps and cloud (e.g., <a href="https://github.com/golang/go">golang / go</a>, <a href="https://github.com/docker/docker-ce">docker / docker-ce</a>, <a href="https://github.com/kubernetes/kubernetes">kubernetes / kubernetes</a>, <a href="https://github.com/hashicorp/terraform">hashicorp / terraform</a>, <a href="https://github.com/coreos/etcd">coreos / etcd</a>, <a href="https://github.com/hashicorp/vault">hashicorp / vault</a>, <a href="https://github.com/hashicorp/packer">hashicorp / packer</a>, <a href="https://github.com/hashicorp/consul">hashicorp / consul</a>, <a href="https://github.com/gogits/gogs">gogits / gogs</a>, <a href="https://github.com/drone/drone">drone / drone</a>.)</p>
<h3 class="mume-header" id="891-create-the-projects-backlog">8.9.1. Create the project's backlog</h3>

<p>A backlog is essentially your to-do list, a prioritized list of work derived from the roadmap (e.g., the outline for future product functionality and when new features will be released) and its requirements.</p>
<p>Open Taiga in your web browser</p>
<p><a href="http://192.168.0.11:8080">http://192.168.0.11:8080</a></p>
<p>The default admin account username and password are</p>
<p><strong>admin</strong> <strong>123123</strong></p>
<p>Complete the follow to track your progress in completing the Golang <em>helloworld</em> project</p>
<ol>
<li>
<p>Click <code>Create Project</code>.</p>
</li>
<li>
<p>Select <code>Kanban</code>.  A Kanban board shows how work moves from left to right, each column represents a stage within the value stream.</p>
</li>
<li>
<p>Give your project a name.  For example, <code>Helloworld</code> and a description, such as, <code>My Kanban board for this awesome helloworld app</code> and then click <code>CREATE PROJECT</code>.</p>
</li>
<li>
<p>You can skip this step and opt to chose to click <code>&gt;&lt;</code> to fold <code>READY</code>, <code>USER STORY STATUS</code> and <code>ARCHIVED</code> only after completing step 6.  Otherwise, you can edit your Kanban board to just <code>NEW</code>, <code>IN PROGRESS</code>, and <code>DONE</code> by</p>
<p>a. On the bottom left, click the <code>ADMIN</code> gear.<br>
b. Click <code>ATTRIBUTES</code>.<br>
c. Scroll down to <code>USER STORY STATUS</code>.<br>
d. Hover over <code>Ready</code>, click the trash icon to delete and click <code>ACCEPT</code>.<br>
c. Do the same for <code>Ready for test</code> and <code>Archived</code>.<br>
d. Click the <code>KANBAN</code> icon on the far left. It Looks like columns.  And then reload the browser to get the changes to take</p>
</li>
<li>
<p>In the <code>NEW</code> column select <code>Add New bulk</code> icon that looks like a list and when the page updates cut-and-paste the lines below into the text box and click <code>SAVE</code>.</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>Create the project&apos;s backlog
Create the project in GitLab
Setup your project on the dev Vagrant
Author the application
Align source code with Go coding standards
Lint your code
Build the application
Execute your application
Author a unit test
Run sonar-scanner on the application
Register your app in SonarQube
Run the sonar-scanner on the command line
Write build and test automation
Author Drone-based Continuous Integration
Configure Drone to execute your pipeline
Trigger the build
</code></pre></li>
</ol>
<p>Track your progress in Taiga as you work through each section.</p>
<h3 class="mume-header" id="892-create-the-project-in-gitlab">8.9.2. Create the project in GitLab</h3>

<ol>
<li>
<p>In GitLab (<a href="http://192.168.0.11:10080/">http://192.168.0.11:10080/</a>) click on <code>Projects</code> in the upper left.</p>
<p>a. Select <code>Create Project</code>.<br>
b. Or click <a href="http://192.168.0.11:10080/projects/new">http://192.168.0.11:10080/projects/new</a></p>
</li>
<li>
<p>Leave the <code>Project path</code> defaulted to <code>http://192.168.0.11:10080/root/</code>.</p>
</li>
<li>
<p>Enter <code>helloworld</code> (the form field the page defaults to) for the <code>Project name</code>.</p>
</li>
<li>
<p>Provide an optional <code>Project description</code>. Something descriptive, such as, <em>&quot;GoLang helloworld application for the hands-on DevOps class.&quot;</em>.</p>
</li>
<li>
<p>Make the application <code>public</code> to save yourself from entering your username and password when cloning.</p>
</li>
<li>
<p>Click the green <code>Create Project</code> button on the lower left.</p>
</li>
</ol>
<p>The UI will refresh to show you a landing page for the project that should be accessible from <a href="http://192.168.0.11:10080/root/helloworld">http://192.168.0.11:10080/root/helloworld</a></p>
<h3 class="mume-header" id="893-setup-your-project-on-the-_dev_-vagrant">8.9.3. Setup your project on the <em>dev</em> Vagrant</h3>

<p>On your host open in a shell to <code>dev</code> vagrant configure your user name and email:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git config --global user.name &quot;Administrator&quot;
git config --global user.email &quot;admin@example.com&quot;
</code></pre><p>The Ansible <code>golang</code> role (Found at <code>ansible/roles/golang</code> in the class project on your host.) will already have configured:</p>
<ol>
<li>Your <code>$GOPATH</code> and <code>$GOBIN</code> environmental variable.</li>
<li>Added <code>$GOBIN</code> to your PATH environmental variable.</li>
<li>Created <code>go</code> workspace in vagrant user's home directory (i.e., <code>/home/vagrant/go</code> directory containing <code>bin</code>, <code>pkg</code>, and <code>src</code>.)</li>
</ol>
<p>Source code for Go code is placed in the <code>src</code> directory under a namespace (i.e., a unique base path to avoid naming collisions under which all your go code will reside.) In open source software development, it is typical to use <a href="http://github.com">github.com</a> account path. Mine is <code>github.com/nemonik</code>, so I would create this base path via (You do the same., so we are all on the same page.)</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>mkdir $GOPATH/src/github.com/nemonik
</code></pre><p>Now lets create the GoLang <code>helloworld</code> project to demonstrate Continuous Integration via</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cd $GOPATH/src/github.com/nemonik
git clone http://192.168.0.11:10080/root/helloworld.git
cd helloworld
</code></pre><p>So that you do not commit certian files to GitLab when you push, create a <code>.gitignore</code> file with your editor with this content</p>
<pre data-role="codeBlock" data-info="" class="language-"><code># OS-specific
.DS_Store

.scannerwork

helloworld
</code></pre><h3 class="mume-header" id="894-author-the-application">8.9.4. Author the application</h3>

<p>In the project follder (i.e., <code>/home/vagrant/go/src/github.com/nemonik/helloworld</code>), create <code>main.go</code> in emacs, nano, vi, or vim with this content:</p>
<pre data-role="codeBlock" data-info="go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"hello world"</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="895-align-source-code-with-go-coding-standards">8.9.5. Align source code with Go coding standards</h3>

<p>Format source code according to Go coding standards using</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go fmt
</code></pre><p>Results in the code being formatted to</p>
<pre data-role="codeBlock" data-info="go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"hello world"</span>
<span class="token punctuation">}</span>
</pre><p>You'll see the difference if you <code>cat</code> your source</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cat main.go
</code></pre><h3 class="mume-header" id="896-lint-your-code">8.9.6. Lint your code</h3>

<p>Already installed on your <code>dev</code> vagrant is <code>golint</code>. Where <code>go fmt</code> reformatted the code to GoLang standards, <code>golint</code> prints style mistakes.</p>
<p>To run <code>golint</code>, in the root of the <code>helloworld</code> project execute</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>golint
</code></pre><p>Command line out will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld]$ golint
hello.go:9:1: exported function HelloWorld should have comment or be unexported
</code></pre><p>Fix the error by editing <code>main.go</code> to</p>
<pre data-role="codeBlock" data-info="go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">"fmt"</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// HelloWorld returns "hello world"</span>
<span class="token keyword">func</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"hello world"</span>
<span class="token punctuation">}</span>
</pre><p>Run <code>golint</code> again and it should return no output indicating it sees nothing wrong.</p>
<h3 class="mume-header" id="897-build-the-application">8.9.7. Build the application</h3>

<p>Build the project by executing</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go build -o helloworld .
</code></pre><p>Success returns no command line output.  What?  Did you want a cookie?  No cookie for you.  This is GoLangs way of doing things.  Silence is golden and means things went fine. Otherwise, go back and fix the mistakes in your code.</p>
<h3 class="mume-header" id="898-execute-your-application">8.9.8. Execute your application</h3>

<p>Execute your application</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>./helloworld
</code></pre><p>The command line output will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev hello]$ ./helloworld
hello world
</code></pre><h3 class="mume-header" id="899-author-a-unit-test">8.9.9. Author a unit test</h3>

<p>GoLang ships with a built-in <code>testing</code> package</p>
<p><a href="https://golang.org/pkg/testing/">https://golang.org/pkg/testing/</a></p>
<p>for automated unit testing of Go packages.  Unit testing is a software development process where the smallest testable components of an application are individually tested for proper operation. Unit testing offers the biggest return for dollars spent in comparison to integration and functional testing.</p>
<p>For more on this topic read Martin Fowler's</p>
<p><a href="https://martinfowler.com/bliki/TestPyramid.html">https://martinfowler.com/bliki/TestPyramid.html</a></p>
<p>In your editor create <code>main_test.go</code> with this content:</p>
<pre data-role="codeBlock" data-info="go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
  <span class="token string">"os"</span>
  <span class="token string">"testing"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestMain</span><span class="token punctuation">(</span>m <span class="token operator">*</span>testing<span class="token punctuation">.</span>M<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestHelloWorld</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"hello world"</span> <span class="token punctuation">{</span>
    t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"got %s expected %s"</span><span class="token punctuation">,</span> <span class="token function">HelloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"hello world"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre><p>Execute the unit test by entering</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go test
</code></pre><p>The command line returns</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld]$ go test
PASS
ok      github.com/nemonik/helloworld    0.003s
</code></pre><p>This step and all the proceeding follows of a DevOps tenant of Devops, &quot;Developers are expected to pre-flight new code.&quot;</p>
<h3 class="mume-header" id="8910-run-sonar-scanner-on-the-application">8.9.10. Run sonar-scanner on the application</h3>

<p>SonarQube provides the capability to show the health of an application's source code, highlighting issues as they are introduced.</p>
<h4 class="mume-header" id="89101-register-your-app-in-sonarqube">8.9.10.1. Register your app in SonarQube</h4>

<p>These section is optional as the <code>sonar-scanner</code>command line tool will do this for you.</p>
<p>Open in your browser</p>
<p><a href="http://192.168.0.11:9000/admin/projects_management">http://192.168.0.11:9000/admin/projects_management</a></p>
<p>If you have to authenticate, your username and password is</p>
<p><strong>admin</strong></p>
<p>Click <code>Create project</code>.</p>
<p>Provide the <code>name</code> of</p>
<p><strong>helloworld</strong></p>
<p>Provide the <code>key</code> of</p>
<p><strong>helloworld</strong></p>
<h4 class="mume-header" id="89102-run-the-sonar-scanner-on-the-command-line">8.9.10.2. Run the <em>sonar-scanner</em> on the command line</h4>

<p>In the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go get github.com/alecthomas/gometalinter
go get github.com/axw/gocov/...
go get github.com/AlekSi/gocov-xml
go get github.com/jstemmer/go-junit-report
gometalinter --install
gometalinter --checkstyle &gt; report.xml
gocov test ./... | gocov-xml &gt; coverage.xml
go test -v ./... | go-junit-report &gt; test.xml
sonar-scanner -D sonar.host.url=http://192.168.0.11:9000 -D sonar.projectKey=helloworld -D sonar-scanner -D sonar.projectKey=helloworld -D sonar.projectName=helloworld -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go
</code></pre><p>Let me unpack what the above commands are doing</p>
<ul>
<li>The first 4 lines starting with <code>go get</code> install dependencies for linting, coverage reporting, report conversioning.</li>
<li>The lines ending with an XML file being created (e.g., <code>report.xml</code>, <code>coverage.xml</code> and <code>test.xml</code>) are the reports that will be submitted to SonarQube.</li>
<li><code>sonar-scanner</code> through <code>-D</code> parameters is configured to submit the reports.  If you skipped the prior section, SonarQube will automatically create the project for you.</li>
</ul>
<p>Output written to the command line will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld]$ go get github.com/alecthomas/gometalinter
[vagrant@dev helloworld]$ go get github.com/axw/gocov/...
[vagrant@dev helloworld]$ go get github.com/AlekSi/gocov-xml
[vagrant@dev helloworld]$ go get github.com/jstemmer/go-junit-report
[vagrant@dev helloworld]$ gometalinter --install
Installing:
  deadcode
  dupl
  errcheck
  gas
  goconst
  gocyclo
  goimports
  golint
  gosimple
  gotype
  gotypex
  ineffassign
  interfacer
  lll
  maligned
  megacheck
  misspell
  nakedret
  safesql
  staticcheck
  structcheck
  unconvert
  unparam
  unused
  varcheck
  vet
[vagrant@dev helloworld]$ gometalinter --checkstyle &gt; report.xml
[vagrant@dev helloworld]$ gocov test ./... | gocov-xml &gt; coverage.xml
ok  	github.com/nemonik/helloworld	0.003s	coverage: 50.0% of statements
[vagrant@dev helloworld]$ go test -v ./... | go-junit-report &gt; test.xml
[vagrant@dev helloworld]$ sonar-scanner -D sonar.host.url=http://192.168.0.11:9000 -D sonar.projectKey=helloworld -D sonar-scanner -D sonar.projectKey=helloworld -D sonar.projectName=helloworld -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go
INFO: Scanner configuration file: /usr/local/sonar-scanner-3.1.0.1141-linux/conf/sonar-scanner.properties
INFO: Project root configuration file: NONE
INFO: SonarQube Scanner 3.1.0.1141
INFO: Java 1.8.0_121 Oracle Corporation (64-bit)
INFO: Linux 3.10.0-693.21.1.el7.x86_64 amd64
INFO: User cache: /home/vagrant/.sonar/cache
INFO: SonarQube server 7.0.0
INFO: Default locale: &quot;en_US&quot;, source code encoding: &quot;UTF-8&quot; (analysis is platform dependent)
INFO: Publish mode
INFO: Load global settings
INFO: Load global settings (done) | time=327ms
INFO: Server id: AWLZ3KmeIXzDnCPHcQJq
INFO: User cache: /home/vagrant/.sonar/cache
INFO: Load plugins index
INFO: Load plugins index (done) | time=97ms
INFO: Load/download plugins
INFO: Load/download plugins (done) | time=216ms
INFO: Process project properties
INFO: Load project repositories
INFO: Load project repositories (done) | time=84ms
INFO: Load quality profiles
INFO: Load quality profiles (done) | time=218ms
INFO: Load active rules
INFO: Load active rules (done) | time=1580ms
INFO: Load metrics repository
INFO: Load metrics repository (done) | time=135ms
WARN: SCM provider autodetection failed. No SCM provider claims to support this project. Please use sonar.scm.provider to define SCM of your project.
INFO: Project key: helloworld
INFO: -------------  Scan helloworld
INFO: Load server rules
INFO: Load server rules (done) | time=45ms
INFO: Base dir: /home/vagrant/go/src/github.com/nemonik/helloworld
INFO: Working dir: /home/vagrant/go/src/github.com/nemonik/helloworld/.scannerwork
INFO: Source paths: .
INFO: Source encoding: UTF-8, default locale: en_US
INFO: Index files
INFO: Excluded sources:
INFO:   **/*test.go
INFO: 5 files indexed
INFO: 1 file ignored because of inclusion/exclusion patterns
INFO: Quality profile for go: Golint Rules
INFO: Sensor GoMetaLinter issues loader sensor [golang]
INFO: Parsing the file report.xml
INFO: Parsing &apos;GoMetaLinter&apos; Analysis Results
INFO: Sensor GoMetaLinter issues loader sensor [golang] (done) | time=37ms
INFO: Sensor Go Coverage [golang]
INFO: /home/vagrant/go/src/github.com/nemonik/helloworld
INFO: Analyse for /home/vagrant/go/src/github.com/nemonik/helloworld/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/heads/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/tags/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/branches/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/hooks/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/info/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/pack/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/info/coverage.xml
INFO: Sensor Go Coverage [golang] (done) | time=47ms
INFO: Sensor Go test JUnit loader sensor [golang]
INFO: base dir /home/vagrant/go/src/github.com/nemonik/helloworld
WARN: The key is null
INFO: Sensor Go test JUnit loader sensor [golang] (done) | time=6ms
INFO: Sensor Go Highlighter Sensor [golang]
INFO: Sensor Go Highlighter Sensor [golang] (done) | time=27ms
INFO: Sensor Go Metrics Sensor [golang]
INFO: Sensor Go Metrics Sensor [golang] (done) | time=1ms
INFO: Sensor Zero Coverage Sensor
INFO: Sensor Zero Coverage Sensor (done) | time=12ms
INFO: Sensor CPD Block Indexer
INFO: Sensor CPD Block Indexer (done) | time=0ms
INFO: No SCM system was detected. You can use the &apos;sonar.scm.provider&apos; property to explicitly specify it.
INFO: Calculating CPD for 0 files
INFO: CPD calculation finished
INFO: Analysis report generated in 58ms, dir size=3 KB
INFO: Analysis reports compressed in 8ms, zip size=2 KB
INFO: Analysis report uploaded in 1422ms
INFO: ANALYSIS SUCCESSFUL, you can browse http://192.168.0.11:9000/dashboard/index/helloworld
INFO: Note that you will be able to access the updated dashboard once the server has processed the submitted analysis report
INFO: More about the report processing at http://192.168.0.11:9000/api/ce/task?id=AWLaCkiXE0IcvTpxuSns
INFO: Task total time: 4.257 s
INFO: ------------------------------------------------------------------------
INFO: EXECUTION SUCCESS
INFO: ------------------------------------------------------------------------
INFO: Total time: 7.262s
INFO: Final Memory: 7M/78M
INFO: ------------------------------------------------------------------------
</code></pre><p>Then open in your host's web browser</p>
<p><a href="http://192.168.0.11:9000/dashboard?id=helloworld">http://192.168.0.11:9000/dashboard?id=helloworld</a></p>
<p>to view your SonarQube report.</p>
<p>We have some code coverage issues, but otherwise, things look fine.</p>
<h3 class="mume-header" id="8911-write-build-and-test-automation">8.9.11. Write build and test automation</h3>

<p>Build automation is a key practice of CI.  So, let's make the build reproducible be automate everything we've done this far via authoring a Makefile.</p>
<p>In the root of the project edit the file, <code>Makefile</code> and add the following contents</p>
<pre data-role="codeBlock" data-info="makefile" class="language-makefile">GOCMD<span class="token operator">=</span>go
GOFMT<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> fmt
GOBUILD<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> build
GOCLEAN<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> clean
GOTEST<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> test
GOGET<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> get
BINARY_NAME<span class="token operator">=</span>helloworld

SONAR_DEPENDENCIES <span class="token operator">:=</span> \
    github.com/alecthomas/gometalinter \
    github.com/axw/gocov/... \
    github.com/AlekSi/gocov-xml \
    github.com/jstemmer/go-junit-report

<span class="token symbol">all</span><span class="token punctuation">:</span> fmt lint test build
<span class="token symbol">clean</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOCLEAN<span class="token punctuation">)</span>
    rm -f <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span>
<span class="token symbol">fmt</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOFMT<span class="token punctuation">)</span>
<span class="token symbol">lint</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOGET<span class="token punctuation">)</span> github.com/golang/lint/golint
    golint
<span class="token symbol">test</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOTEST<span class="token punctuation">)</span> -v ./...
<span class="token symbol">build</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOBUILD<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span> -v
<span class="token symbol">run</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOBUILD<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span> -v ./...
    ./<span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span>
<span class="token symbol">sonar</span><span class="token punctuation">:</span>
    <span class="token variable">$</span><span class="token punctuation">(</span>GOGET<span class="token punctuation">)</span> -u <span class="token variable">$</span><span class="token punctuation">(</span>SONAR_DEPENDENCIES<span class="token punctuation">)</span>
    gometalinter --install
    -gometalinter --checkstyle > report.xml
    -gocov test ./... <span class="token operator">|</span> gocov-xml > coverage.xml
    -<span class="token variable">$</span><span class="token punctuation">(</span>GOTEST<span class="token punctuation">)</span> -v ./... <span class="token operator">|</span> go-junit-report > test.xml
    sonar-scanner -D sonar.host.url<span class="token operator">=</span>http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span>9000 -D sonar.projectKey<span class="token operator">=</span>helloworld -D sonar-scanner -D sonar.projectKey<span class="token operator">=</span>helloworld -D sonar.projectName<span class="token operator">=</span>helloworld -D sonar.projectVersion<span class="token operator">=</span>1.0 -D sonar.sources<span class="token operator">=</span>. -D sonar.golint.reportPath<span class="token operator">=</span>report.xml -D sonar.coverage.reportPath<span class="token operator">=</span>coverage.xml -D sonar.coverage.dtdVerification<span class="token operator">=</span>false -D sonar.test.reportPath<span class="token operator">=</span>test.xml -D sonar.exclusions<span class="token operator">=</span>**/*test.go
</pre><p><strong>NOTE</strong></p>
<ul>
<li>Each indent is a <code>tab</code> and <strong>not</strong> a series of <code>space</code> characters.</li>
<li>Cutting-and-pasting the last line starting with <code>sonar-scanner</code> may paste this single line as multiple lines.  It needs to be one single line in order to work.</li>
</ul>
<p>Save the file and exit your editor.</p>
<p>Okay, let's try it out</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>make lint
make test
make build
make run
make sonar
</code></pre><p>The output will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld]$ make lint
go get github.com/golang/lint/golint
golint
[vagrant@dev helloworld]$ make test
go test -v ./...
=== RUN   TestHelloWorld
--- PASS: TestHelloWorld (0.00s)
PASS
ok  	github.com/nemonik/helloworld	(cached)
[vagrant@dev helloworld]$ make build
go build -o helloworld -v
[vagrant@dev helloworld]$ make run
go build -o helloworld -v ./...
./helloworld
hello world
[vagrant@dev helloworld]$ make sonar
go get -u github.com/alecthomas/gometalinter github.com/axw/gocov/... github.com/AlekSi/gocov-xml github.com/jstemmer/go-junit-report
gometalinter --install
Installing:
  deadcode
  dupl
  errcheck
  gas
  goconst
  gocyclo
  goimports
  golint
  gosimple
  gotype
  gotypex
  ineffassign
  interfacer
  lll
  maligned
  megacheck
  misspell
  nakedret
  safesql
  staticcheck
  structcheck
  unconvert
  unparam
  unused
  varcheck
  vet
gometalinter --checkstyle &gt; report.xml
gocov test ./... | gocov-xml &gt; coverage.xml
ok  	github.com/nemonik/helloworld	0.003s	coverage: 50.0% of statements
go test -v ./... | go-junit-report &gt; test.xml
sonar-scanner -D sonar.host.url=http://192.168.0.11:9000 -D sonar.projectKey=helloworld -D sonar-scanner -D sonar.projectKey=helloworld -D sonar.projectName=helloworld -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go
INFO: Scanner configuration file: /usr/local/sonar-scanner-3.1.0.1141-linux/conf/sonar-scanner.properties
INFO: Project root configuration file: NONE
INFO: SonarQube Scanner 3.1.0.1141
INFO: Java 1.8.0_121 Oracle Corporation (64-bit)
INFO: Linux 3.10.0-693.21.1.el7.x86_64 amd64
INFO: User cache: /home/vagrant/.sonar/cache
INFO: SonarQube server 7.0.0
INFO: Default locale: &quot;en_US&quot;, source code encoding: &quot;UTF-8&quot; (analysis is platform dependent)
INFO: Publish mode
INFO: Load global settings
INFO: Load global settings (done) | time=92ms
INFO: Server id: AWLZ3KmeIXzDnCPHcQJq
INFO: User cache: /home/vagrant/.sonar/cache
INFO: Load plugins index
INFO: Load plugins index (done) | time=56ms
INFO: Load/download plugins
INFO: Load/download plugins (done) | time=6ms
INFO: Process project properties
INFO: Load project repositories
INFO: Load project repositories (done) | time=211ms
INFO: Load quality profiles
INFO: Load quality profiles (done) | time=129ms
INFO: Load active rules
INFO: Load active rules (done) | time=266ms
INFO: Load metrics repository
INFO: Load metrics repository (done) | time=51ms
WARN: SCM provider autodetection failed. No SCM provider claims to support this project. Please use sonar.scm.provider to define SCM of your project.
INFO: Project key: helloworld
INFO: -------------  Scan helloworld
INFO: Load server rules
INFO: Load server rules (done) | time=28ms
INFO: Base dir: /home/vagrant/go/src/github.com/nemonik/helloworld
INFO: Working dir: /home/vagrant/go/src/github.com/nemonik/helloworld/.scannerwork
INFO: Source paths: .
INFO: Source encoding: UTF-8, default locale: en_US
INFO: Index files
INFO: Excluded sources:
INFO:   **/*test.go
INFO: 6 files indexed
INFO: 1 file ignored because of inclusion/exclusion patterns
INFO: Quality profile for go: Golint Rules
INFO: Sensor GoMetaLinter issues loader sensor [golang]
INFO: Parsing the file report.xml
INFO: Parsing &apos;GoMetaLinter&apos; Analysis Results
INFO: Sensor GoMetaLinter issues loader sensor [golang] (done) | time=22ms
INFO: Sensor Go Coverage [golang]
INFO: /home/vagrant/go/src/github.com/nemonik/helloworld
INFO: Analyse for /home/vagrant/go/src/github.com/nemonik/helloworld/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/heads/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/refs/tags/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/branches/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/hooks/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/info/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/pack/coverage.xml
INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld/.git/objects/info/coverage.xml
INFO: Sensor Go Coverage [golang] (done) | time=42ms
INFO: Sensor Go test JUnit loader sensor [golang]
INFO: base dir /home/vagrant/go/src/github.com/nemonik/helloworld
WARN: The key is null
INFO: Sensor Go test JUnit loader sensor [golang] (done) | time=5ms
INFO: Sensor Go Highlighter Sensor [golang]
INFO: Sensor Go Highlighter Sensor [golang] (done) | time=19ms
INFO: Sensor Go Metrics Sensor [golang]
INFO: Sensor Go Metrics Sensor [golang] (done) | time=2ms
INFO: Sensor Zero Coverage Sensor
INFO: Sensor Zero Coverage Sensor (done) | time=9ms
INFO: Sensor CPD Block Indexer
INFO: Sensor CPD Block Indexer (done) | time=1ms
INFO: No SCM system was detected. You can use the &apos;sonar.scm.provider&apos; property to explicitly specify it.
INFO: Calculating CPD for 0 files
INFO: CPD calculation finished
INFO: Analysis report generated in 56ms, dir size=3 KB
INFO: Analysis reports compressed in 10ms, zip size=2 KB
INFO: Analysis report uploaded in 60ms
INFO: ANALYSIS SUCCESSFUL, you can browse http://192.168.0.11:9000/dashboard/index/helloworld
INFO: Note that you will be able to access the updated dashboard once the server has processed the submitted analysis report
INFO: More about the report processing at http://192.168.0.11:9000/api/ce/task?id=AWLaD8OGE0IcvTpxuSnt
INFO: Task total time: 1.604 s
INFO: ------------------------------------------------------------------------
INFO: EXECUTION SUCCESS
INFO: ------------------------------------------------------------------------
INFO: Total time: 2.708s
INFO: Final Memory: 10M/116M
INFO: ------------------------------------------------------------------------```
</code></pre><h3 class="mume-header" id="8912-author-drone-based-continuous-integration">8.9.12. Author Drone-based Continuous Integration</h3>

<p>CI integrates all of the steps we have worked to ensure a high quality build into a pipeline, so let's do that.</p>
<p>We're going to author a continuous integration pipeline for our application and execute it on Drone. Drone expects a <code>.drone.yml</code> to exist at the root of the project and will execute the pipeline it contains when the project is committed to GitLab.</p>
<p>A pipeline is broken up into multiple named steps, where each step executes in an ephemeral Docker container with shared disk access to the project's workspace. The benefit of this approach is that it relieves you from having to create and maintain slaves to execute your pipelines.</p>
<p>Drone automatically clones your project's repo (Short for &quot;repository.&quot;) into a volume (referred to as the workspace) shared by each Docker container (including plugins service containers).</p>
<p>In your editor create <code>.drone.yml</code> file (<strong>Make sure you pre-pend that dot.</strong>) at the root of the <code>helloworld</code> project:</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token key atrule">pipeline</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/golang<span class="token punctuation">:</span>1.10.1
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> make lint
      <span class="token punctuation">-</span> make test
      <span class="token punctuation">-</span> make build
  <span class="token key atrule">run</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/golang<span class="token punctuation">:</span>1.10.1
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> make run
</pre><p>The pipeline is authored in YAML like almost all the CI orchestrators out there except for Jenkin's Pipelines, whose you author in Groovy-based DSL.</p>
<ul>
<li><code>pipeline:</code> - defines a list of steps to build, test and deploy your code.</li>
<li><code>build:</code> and <code>run:</code> - are the names of the step. These are  yours to name. Name steps something meaningful as to what the step is orchestrating. Each step is executed serially, in the order defined.</li>
<li><code>image: 192.168.0.11:5000/nemonik/golang:1.10.1</code> - The build step is using the nemonik/golang container tagged <code>1.10.1</code> retrieved from private Docker registry located at <code>192.168.0.11:5000</code>. Drone uses Docker images for the build environment, plugins and service containers. Drone spins them up for the execution of the pipeline and when no longer needed they go poof.</li>
<li><code>commands</code> - Is a collection of terminal commands to be executed. These are all the same commands we executed previously in the command line. If anyone of these commands were to fail returning a non-zero exit code, the pipeline will immediately end resulting in a failed build.</li>
</ul>
<h3 class="mume-header" id="8913-configure-drone-to-execute-your-pipeline">8.9.13. Configure Drone to execute your pipeline</h3>

<ol>
<li>Open <a href="http://192.168.0.11:8000/">http://192.168.0.11:8000/</a> in your browser and authenticate through GitLab on into Drone, if you need to.</li>
<li>In the upper right corner find the hamburger icon (displayed as ☰) and click it and then select <code>Repositories</code>.</li>
<li>Then click hamburger icon again and select <code>Synchronize</code>, if you don't see your project's repo.</li>
<li>Then click the slider to for the <code>root/helloworld</code> repo to enable Drone orchestration for the project.</li>
<li>Clicking the box icon with the arrow pointing toward upper-right to open root/helloworld's builds.</li>
</ol>
<p>You won't have any builds to start, but when you do the builds will increment starting from 1. Red is failed the build. Yellow-orange is a presently executing build. Green is a build that passed. When a build does start, click on its row to open and monitor it. The UI will update as the build proceeds informing you as to its progress.</p>
<h3 class="mume-header" id="8914-trigger-the-build">8.9.14. Trigger the build</h3>

<p>To trigger the build, in your ssh connection to <code>dev</code> simply commit your code:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .
git commit -m &quot;Added Drone pipeline&quot;
git push -u origin master
</code></pre><p>Immediately after you enter your GitLab username/password open <a href="http://192.168.0.11:8000/root/hello">http://192.168.0.11:8000/root/hello</a> in your browser, if you re-use an existing tab to this page refresh the page.</p>
<p>The execution of this pipeline will follow as so:</p>
<ol>
<li>A new build will appear. Click on it.</li>
<li>Drone will clone your project's repository in a <code>clone</code> step.</li>
<li>And then spin up <code>nemonik/golang:1.9.4</code> container, whose container image was patched to work behind MITRE's http proxy and SSL introspection. (Later, you may want examine the contents of ansible/roles/golang-container-image/files/Dockerfile for more details as to how this was accomplished.)</li>
<li>And then execute the following shell command in the same way you executed them yourself: a. make lint b. make test c. make build d. make run</li>
</ol>
<p>The output of the <code>build</code> (An arbitrary name. You could use &quot;skippy&quot;.) step will resemble:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ make lint
go get github.com/golang/lint/golint
golint
+ make test
go test -v ./...
=== RUN   TestHelloWorld
--- PASS: TestHelloWorld (0.00s)
PASS
ok  	_/drone/src/192.168.0.11/root/helloworld	0.003s
+ make build
go build -o helloworld -v
_/drone/src/192.168.0.11/root/helloworld
</code></pre><p>The output of the <code>run</code> step will resemble:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ make run
go build -o helloworld -v ./...
./helloworld
hello world
</code></pre><p>Our build was successful.  Drone uses a container's exit code to determine success or failure. A container's non-zero exit code will cause the pipeline to exit immediately.</p>
<p>That's it.  This is essentially CI.</p>
<h3 class="mume-header" id="8915-the-completed-source-for-helloworld">8.9.15. The completed source for <em>helloworld</em></h3>

<p>The <code>helloworld</code> project can be viewed completed at</p>
<p><a href="https://gitlab.mitre.org/mjwalsh/helloworld">https://gitlab.mitre.org/mjwalsh/helloworld</a></p>
<h2 class="mume-header" id="810-golang-helloworld-web-project">8.10. Golang <em>helloworld-web</em> project</h2>

<p>Like <code>helloworld</code>, the <code>helloworld-web</code> project is a very simple application that we will use to explore Continuous Deliver.  Remember, Continuous Delivery builds upon Continuous Integration.</p>
<h3 class="mume-header" id="8101-create-the-projects-backlog">8.10.1. Create the project's backlog</h3>

<p>Open Taiga in your web browser</p>
<p><a href="http://192.168.0.11:8080">http://192.168.0.11:8080</a></p>
<p>Complete the follow to track your progress in completing the <em>helloworld-web</em> project</p>
<ol>
<li>Click <code>Create Project</code>.</li>
<li>Select <code>Kanban</code>.  A Kanban board shows how work moves from left to right, each column represents a stage within the value stream.</li>
<li>Give your project a name.  For example, <code>Helloworld-web</code> and a description, such as, <code>My Kanban board for this awesome helloworld-web app</code> and then click <code>CREATE PROJECT</code>.</li>
<li>You can skip this step and opt to chose to click <code>&gt;&lt;</code> to fold <code>READY</code>, <code>USER STORY STATUS</code> and <code>ARCHIVED</code> only after completing step 6.  Otherwise, you can edit your Kanban board to just <code>NEW</code>, <code>IN PROGRESS</code>, and <code>DONE</code> by<br>
a. On the bottom left, click the <code>ADMIN</code> gear.<br>
b. Click <code>ATTRIBUTES</code>.<br>
c. Scroll down to <code>USER STORY STATUS</code>.<br>
d. Hover over <code>Ready</code>, click the trash icon to delete and click <code>ACCEPT</code>.<br>
c. Do the same for <code>Ready for test</code> and <code>Archived</code>.<br>
d. Click the <code>KANBAN</code> icon on the far left. It Looks like columns.  And then reload the browser to get the changes to take</li>
<li>In the <code>NEW</code> column select <code>Add New bulk</code> icon that looks like a list and when the page updates cut-and-paste the lines below into the text box and click <code>SAVE</code>.<pre data-role="codeBlock" data-info="" class="language-"><code>Create the project in GitLab
Create the project
Retrieve dependencies
Author the application
Build and Run the application
Run sonar-scanner on the application
Write the Makefile
Dockerize the application
Run the container
Push the container image to the private registry
Author the build step for the pipeline
Author the publish step for the pipeline
Add a deploy step to the pipeline
Add SonarQube to the pipeline 
Author an automated functional test
Add a selenium step to our pipeline
Add a DAST step for the pipeline
</code></pre></li>
</ol>
<p>Track your progress in Taiga as you work through each section.</p>
<h3 class="mume-header" id="8102-create-the-project-in-gitlab">8.10.2. Create the project in GitLab</h3>

<ol>
<li>In GitLab (<a href="http://192.168.0.11:10080/">http://192.168.0.11:10080/</a>) click on <code>Projects</code> in the upper left.<br>
a. Select <code>Your projects</code> from the dropdown.<br>
b. Click the green <code>New Project</code> on the far right under <code>Projects</code>, or<br>
c. Click <a href="http://192.168.0.11:10080/projects/new">http://192.168.0.11:10080/projects/new</a></li>
<li>Leave the <code>Project path</code> defaulted to <code>http://192.168.0.11:10080/root/</code>.</li>
<li>Enter <code>helloworld-web</code> for the <code>Project name</code>.  <strong>Be careful with the spelling.</strong></li>
<li>Provide an optional <code>Project description</code>. Something descriptive, such as, <em>&quot;GoLang helloworld application for the hands-on DevOps class.&quot;</em>.</li>
<li>Make the application <code>public</code>.</li>
<li>Click the green <code>Create Project</code> button on the lower left.</li>
</ol>
<p>The UI will refresh to show you landing page for the project that should be accessible from</p>
<p><a href="http://192.168.0.11:10080/root/helloworld-web">http://192.168.0.11:10080/root/helloworld-web</a></p>
<h3 class="mume-header" id="8103-setup-your-project-on-the-dev-vagrant">8.10.3. Setup your project on the <em>dev</em> Vagrant</h3>

<p>Create a <code>helloworld-web</code> GitLab hosted repo as you did prior for the <code>helloworld</code> project.</p>
<p>On your host in secure shell to <code>dev</code> vagrant by running at the root of the class project</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant ssh dev
</code></pre><p>If you had just ented <code>vagrant ssh</code> you will be connected to the <code>dev</code> vagrant by default.</p>
<p>Then in the command line enter</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cd ~/go/src/github.com/nemonik
git clone http://192.168.0.11:10080/root/helloworld-web.git
cd helloworld-web
</code></pre><p><strong>NOTE</strong></p>
<ul>
<li>The  <code>git clone</code> will fail if you did not name your project correctly while in GitLab.</li>
</ul>
<p>So that you do not commit certian files to GitLab when you push, create a <code>.gitignore</code> file with your editor with this content</p>
<pre data-role="codeBlock" data-info="" class="language-"><code># OS-specific
.DS_Store

*.xml

helloworld-web

.scannerwork
</code></pre><h3 class="mume-header" id="8104-author-the-application">8.10.4. Author the application</h3>

<p>Create <code>main.go</code> in emacs, nano, vi, or vim with this content:</p>
<pre data-role="codeBlock" data-info="Go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
	<span class="token string">"net/http"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">"listening on :3000\n"</span><span class="token punctuation">)</span>
	http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":3000"</span><span class="token punctuation">,</span> <span class="token function">logRequest</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>DefaultServeMux<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Fprintf</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token string">"Hello world!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">logRequest</span><span class="token punctuation">(</span>handler http<span class="token punctuation">.</span>Handler<span class="token punctuation">)</span> http<span class="token punctuation">.</span>Handler <span class="token punctuation">{</span>
	<span class="token keyword">return</span> http<span class="token punctuation">.</span><span class="token function">HandlerFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> r <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">"%s  %s  %s\n"</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>RemoteAddr<span class="token punctuation">,</span> r<span class="token punctuation">.</span>Method<span class="token punctuation">,</span> r<span class="token punctuation">.</span>URL<span class="token punctuation">)</span>
		handler<span class="token punctuation">.</span><span class="token function">ServeHTTP</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="8105-build-and-run-the-application">8.10.5. Build and Run the application</h3>

<p>Run the application</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go build -o helloworld-web .
</code></pre><p>No output means things are peachy. Otherwise fix your mistakes.</p>
<p>Now run</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>./helloworld-web
</code></pre><p>Command line output will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ ./helloworld-web
listening on :3000
</code></pre><p>Open in a web browser:</p>
<p><a href="http://192.168.0.10:3000">http://192.168.0.10:3000</a></p>
<p>The browser will load</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>Hello world!
</code></pre><p>The command line will output</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>192.168.0.1:63201  GET  /
192.168.0.1:63201  GET  /favicon.ico
</code></pre><h3 class="mume-header" id="8106-run-sonar-scanner-on-the-application">8.10.6. Run sonar-scanner on the application</h3>

<p>The following command line steps are optional as you have installed these dependencies for the <code>helloworld</code> application</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go get github.com/alecthomas/gometalinter
go get github.com/axw/gocov/...
go get github.com/AlekSi/gocov-xml
go get github.com/jstemmer/go-junit-report
gometalinter --install
</code></pre><p>But these must be entered to generate the reports and submit to SonarQube</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>gometalinter --checkstyle &gt; report.xml
gocov test ./... | gocov-xml &gt; coverage.xml
go test -v ./... | go-junit-report &gt; test.xml
sonar-scanner -D sonar.projectKey=helloworld-web -D sonar-scanner -D sonar.projectKey=helloworld-web -D sonar.projectName=helloworld-web -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go
</code></pre><p>Open in your host's web browser</p>
<p><a href="http://192.168.0.11:9000/dashboard?id=helloworld-web">http://192.168.0.11:9000/dashboard?id=helloworld-web</a></p>
<p>to view your SonarQube report.</p>
<p>SonarQube has picked up we have no code coverage (i.e., unit test.)</p>
<h3 class="mume-header" id="8107-lets-write-some-unit-test-to-up-that-coverage">8.10.7. Let's write some unit test to up that coverage</h3>

<p>So, not writing any unit tests prior to running Sonar we had code coverage issues.</p>
<p>Let's fix that.</p>
<p>Create <code>main_test.go</code> in emacs, nano, vi, or vim with this content:</p>
<pre data-role="codeBlock" data-info="Go" class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
        <span class="token string">"net/http"</span>
        <span class="token string">"net/http/httptest"</span>
        <span class="token string">"os"</span>
        <span class="token string">"testing"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">TestHandler</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Create an http request</span>
        req<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> http<span class="token punctuation">.</span><span class="token function">NewRequest</span><span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

        <span class="token comment">// Create  http.ResponseWriter for test inspection</span>
        w <span class="token operator">:=</span> httptest<span class="token punctuation">.</span><span class="token function">NewRecorder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment">// Call the handler</span>
        <span class="token function">handler</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> req<span class="token punctuation">)</span>

        <span class="token comment">// Inspect the http.ResponseWriter</span>
        <span class="token keyword">if</span> w<span class="token punctuation">.</span>Code <span class="token operator">!=</span> http<span class="token punctuation">.</span>StatusOK <span class="token punctuation">{</span>
                t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Server did not return %v"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> w<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"Hello world!"</span> <span class="token punctuation">{</span>
                t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"Body contain \"%v\" instead of expected \"Hello world!\""</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>Body<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestMain</span><span class="token punctuation">(</span>m <span class="token operator">*</span>testing<span class="token punctuation">.</span>M<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        os<span class="token punctuation">.</span><span class="token function">Exit</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</pre><p>Execute the unit test by entering</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>go test
</code></pre><p>The command line returns</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ go test
PASS
ok  	github.com/nemonik/helloworld-web	0.005s
</code></pre><p>Re-generate the reports and submit to SonarQube</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>gometalinter --checkstyle &gt; report.xml
gocov test ./... | gocov-xml &gt; coverage.xml
go test -v ./... | go-junit-report &gt; test.xml
sonar-scanner -D sonar.projectKey=helloworld-web -D sonar-scanner -D sonar.projectKey=helloworld-web -D sonar.projectName=helloworld-web -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go
</code></pre><p>Open in your host's web browser</p>
<p><a href="http://192.168.0.11:9000/dashboard?id=helloworld-web">http://192.168.0.11:9000/dashboard?id=helloworld-web</a></p>
<p>to view your SonarQube report.</p>
<p>SonarQube has picked up we have better code coverage.  Better, but not perfect.</p>
<h3 class="mume-header" id="8108-write-the-makefile">8.10.8. Write the Makefile</h3>

<p>In your editor create a <code>Makefile</code> to ensure the build and the steps leading to are repeatable.</p>
<pre data-role="codeBlock" data-info="makefile" class="language-makefile">GOCMD<span class="token operator">=</span>go
GOFMT<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> fmt
GOBUILD<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> build
GOCLEAN<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> clean
GOTEST<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> test
GOGET<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>GOCMD<span class="token punctuation">)</span> get
BINARY_NAME<span class="token operator">=</span>helloworld-web
HTTP_PROXY<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">{</span>http_proxy<span class="token punctuation">}</span>
NO_PROXY<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">{</span>no_proxy<span class="token punctuation">}</span>

SONAR_DEPENDENCIES <span class="token operator">:=</span> \
	github.com/alecthomas/gometalinter \
	github.com/axw/gocov/... \
	github.com/AlekSi/gocov-xml \
	github.com/jstemmer/go-junit-report

<span class="token symbol">all</span><span class="token punctuation">:</span> fmt lint test build
<span class="token symbol">clean</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOCLEAN<span class="token punctuation">)</span>
	rm -f <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span>
<span class="token symbol">fmt</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOFMT<span class="token punctuation">)</span>
<span class="token symbol">lint</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOGET<span class="token punctuation">)</span> github.com/golang/lint/golint
	golint
<span class="token symbol">test</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOTEST<span class="token punctuation">)</span> -v ./...
<span class="token symbol">build</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOBUILD<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span> -v
<span class="token symbol">run</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOBUILD<span class="token punctuation">)</span> -o <span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span> -v ./...
	./<span class="token variable">$</span><span class="token punctuation">(</span>BINARY_NAME<span class="token punctuation">)</span>
<span class="token symbol">sonar</span><span class="token punctuation">:</span>
	<span class="token variable">$</span><span class="token punctuation">(</span>GOGET<span class="token punctuation">)</span> <span class="token variable">$</span><span class="token punctuation">(</span>SONAR_DEPENDENCIES<span class="token punctuation">)</span>
	gometalinter --install
	-gometalinter --checkstyle > report.xml
	-gocov test ./... <span class="token operator">|</span> gocov-xml > coverage.xml
	-<span class="token variable">$</span><span class="token punctuation">(</span>GOTEST<span class="token punctuation">)</span> -v ./... <span class="token operator">|</span> go-junit-report > test.xml
	sonar-scanner -X -D http.nonProxyHosts<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>NO_PROXY<span class="token punctuation">)</span> -D http.proxyHost<span class="token operator">=</span><span class="token variable">$</span><span class="token punctuation">(</span>HTTP_PROXY<span class="token punctuation">)</span> -D sonar.host.url<span class="token operator">=</span>http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span>9000 -D sonar.projectKey<span class="token operator">=</span>helloworld-web -D sonar.projectName<span class="token operator">=</span>helloworld-web -D sonar.coverage.dtdVerification<span class="token operator">=</span>false -D sonar.projectVersion<span class="token operator">=</span>1.0 -D sonar.sources<span class="token operator">=</span>. -D sonar.golint.reportPath<span class="token operator">=</span>report.xml -D sonar.coverage.reportPath<span class="token operator">=</span>coverage.xml -D sonar.coverage.dtdVerification<span class="token operator">=</span>false -D sonar.test.reportPath<span class="token operator">=</span>test.xml  -D sonar.exclusions<span class="token operator">=</span>**/*test.go
</pre><p>Looks more or less like <code>helloworld</code>'s Makefile with the addition of <code>deps</code>.</p>
<p>Again, remember</p>
<ul>
<li>The indents are <code>tab</code> characters and not <code>spaces</code> characters.</li>
<li>And cut-and-paste may split the single line beginning with <code>sonar-scanner</code> into multiple lines.  You want this to be single line of text.</li>
</ul>
<p>Test out your <code>Makefile</code></p>
<pre data-role="codeBlock" data-info="" class="language-"><code>make lint
make test
make build
make sonar
make run
</code></pre><p>And so, you have build and test automation whose output resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ make lint
go get github.com/golang/lint/golint
golint
[vagrant@dev helloworld-web]$ make test
go test -v ./...
=== RUN   TestHandler
--- PASS: TestHandler (0.00s)
PASS
ok  	github.com/nemonik/helloworld-web	(cached)
[vagrant@dev helloworld-web]$ make build
go build -o helloworld-web -v
[vagrant@dev helloworld-web]$ make sonar
go get github.com/alecthomas/gometalinter github.com/axw/gocov/... github.com/AlekSi/gocov-xml github.com/jstemmer/go-junit-report
gometalinter --install
Installing:
  deadcode
  dupl
  errcheck
  gas
  goconst
  gocyclo
  goimports
  golint
  gosimple
  gotype
  gotypex
  ineffassign
  interfacer
  lll
  maligned
  megacheck
  misspell
  nakedret
  safesql
  staticcheck
  structcheck
  unconvert
  unparam
  unused
  varcheck
  vet
gometalinter --checkstyle &gt; report.xml
make: [sonar] Error 1 (ignored)
gocov test ./... | gocov-xml &gt; coverage.xml
ok  	github.com/nemonik/helloworld-web	0.005s	coverage: 14.3% of statements
go test -v ./... | go-junit-report &gt; test.xml
sonar-scanner -X -D http.nonProxyHosts=127.0.0.1,localhost,.mitre.org,.local,192.168.0.1,192.168.0.2,192.168.0.3,192.168.0.4,192.168.0.5,192.168.0.6,192.168.0.7,192.168.0.8,192.168.0.9,192.168.0.10,192.168.0.11,192.168.0.12,192.168.0.13,192.168.0.14,192.168.0.15,192.168.0.16,192.168.0.17,192.168.0.18,192.168.0.19,192.168.0.20,192.168.0.21,192.168.0.22,192.168.0.23,192.168.0.24,192.168.0.25,192.168.0.26,192.168.0.27,192.168.0.28,192.168.0.29,192.168.0.30,192.168.0.31,192.168.0.32,192.168.0.33,192.168.0.34,192.168.0.35,192.168.0.36,192.168.0.37,192.168.0.38,192.168.0.39,192.168.0.40,192.168.0.41,192.168.0.42,192.168.0.43,192.168.0.44,192.168.0.45,192.168.0.46,192.168.0.47,192.168.0.48,192.168.0.49,192.168.0.50,192.168.0.51,192.168.0.52,192.168.0.53,192.168.0.54,192.168.0.55,192.168.0.56,192.168.0.57,192.168.0.58,192.168.0.59,192.168.0.60,192.168.0.61,192.168.0.62,192.168.0.63,192.168.0.64,192.168.0.65,192.168.0.66,192.168.0.67,192.168.0.68,192.168.0.69,192.168.0.70,192.168.0.71,192.168.0.72,192.168.0.73,192.168.0.74,192.168.0.75,192.168.0.76,192.168.0.77,192.168.0.78,192.168.0.79,192.168.0.80,192.168.0.81,192.168.0.82,192.168.0.83,192.168.0.84,192.168.0.85,192.168.0.86,192.168.0.87,192.168.0.88,192.168.0.89,192.168.0.90,192.168.0.91,192.168.0.92,192.168.0.93,192.168.0.94,192.168.0.95,192.168.0.96,192.168.0.97,192.168.0.98,192.168.0.99,192.168.0.100,192.168.0.101,192.168.0.102,192.168.0.103,192.168.0.104,192.168.0.105,192.168.0.106,192.168.0.107,192.168.0.108,192.168.0.109,192.168.0.110,192.168.0.111,192.168.0.112,192.168.0.113,192.168.0.114,192.168.0.115,192.168.0.116,192.168.0.117,192.168.0.118,192.168.0.119,192.168.0.120,192.168.0.121,192.168.0.122,192.168.0.123,192.168.0.124,192.168.0.125,192.168.0.126,192.168.0.127,192.168.0.128,192.168.0.129,192.168.0.130,192.168.0.131,192.168.0.132,192.168.0.133,192.168.0.134,192.168.0.135,192.168.0.136,192.168.0.137,192.168.0.138,192.168.0.139,192.168.0.140,192.168.0.141,192.168.0.142,192.168.0.143,192.168.0.144,192.168.0.145,192.168.0.146,192.168.0.147,192.168.0.148,192.168.0.149,192.168.0.150,192.168.0.151,192.168.0.152,192.168.0.153,192.168.0.154,192.168.0.155,192.168.0.156,192.168.0.157,192.168.0.158,192.168.0.159,192.168.0.160,192.168.0.161,192.168.0.162,192.168.0.163,192.168.0.164,192.168.0.165,192.168.0.166,192.168.0.167,192.168.0.168,192.168.0.169,192.168.0.170,192.168.0.171,192.168.0.172,192.168.0.173,192.168.0.174,192.168.0.175,192.168.0.176,192.168.0.177,192.168.0.178,192.168.0.179,192.168.0.180,192.168.0.181,192.168.0.182,192.168.0.183,192.168.0.184,192.168.0.185,192.168.0.186,192.168.0.187,192.168.0.188,192.168.0.189,192.168.0.190,192.168.0.191,192.168.0.192,192.168.0.193,192.168.0.194,192.168.0.195,192.168.0.196,192.168.0.197,192.168.0.198,192.168.0.199,192.168.0.200,192.168.0.201,192.168.0.202,192.168.0.203,192.168.0.204,192.168.0.205,192.168.0.206,192.168.0.207,192.168.0.208,192.168.0.209,192.168.0.210,192.168.0.211,192.168.0.212,192.168.0.213,192.168.0.214,192.168.0.215,192.168.0.216,192.168.0.217,192.168.0.218,192.168.0.219,192.168.0.220,192.168.0.221,192.168.0.222,192.168.0.223,192.168.0.224,192.168.0.225,192.168.0.226,192.168.0.227,192.168.0.228,192.168.0.229,192.168.0.230,192.168.0.231,192.168.0.232,192.168.0.233,192.168.0.234,192.168.0.235,192.168.0.236,192.168.0.237,192.168.0.238,192.168.0.239,192.168.0.240,192.168.0.241,192.168.0.242,192.168.0.243,192.168.0.244,192.168.0.245,192.168.0.246,192.168.0.247,192.168.0.248,192.168.0.249,192.168.0.250,192.168.0.251,192.168.0.252,192.168.0.253,192.168.0.254,192.168.0.255 -D http.proxyHost=http://gatekeeper.mitre.org:80 -D sonar.host.url=http://192.168.0.11:9000 -D sonar.projectKey=helloworld-web -D sonar.projectName=helloworld-web -D sonar.coverage.dtdVerification=false -D sonar.projectVersion=1.0 -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml  -D sonar.exclusions=**/*test.go
20:05:58.469 INFO: Scanner configuration file: /usr/local/sonar-scanner-3.1.0.1141-linux/conf/sonar-scanner.properties
20:05:58.476 INFO: Project root configuration file: NONE
20:05:58.517 INFO: SonarQube Scanner 3.1.0.1141
20:05:58.517 INFO: Java 1.8.0_121 Oracle Corporation (64-bit)
20:05:58.517 INFO: Linux 3.10.0-693.21.1.el7.x86_64 amd64
20:05:58.710 DEBUG: keyStore is :
20:05:58.710 DEBUG: keyStore type is : jks
20:05:58.710 DEBUG: keyStore provider is :
20:05:58.710 DEBUG: init keystore
20:05:58.710 DEBUG: init keymanager of type SunX509
20:05:58.807 DEBUG: Create: /home/vagrant/.sonar/cache
20:05:58.808 INFO: User cache: /home/vagrant/.sonar/cache
20:05:58.808 DEBUG: Create: /home/vagrant/.sonar/cache/_tmp
20:05:58.810 DEBUG: Extract sonar-scanner-api-batch in temp...
20:05:58.818 DEBUG: Get bootstrap index...
20:05:58.818 DEBUG: Download: http://192.168.0.11:9000/batch/index
20:05:58.885 DEBUG: Get bootstrap completed
20:05:58.894 DEBUG: Create isolated classloader...
20:05:58.903 DEBUG: Start temp cleaning...
20:05:58.911 DEBUG: Temp cleaning done
20:05:58.912 DEBUG: Execution getVersion
20:05:58.924 INFO: SonarQube server 7.0.0
20:05:58.926 INFO: Default locale: &quot;en_US&quot;, source code encoding: &quot;UTF-8&quot; (analysis is platform dependent)
20:05:58.927 DEBUG: Work directory: /home/vagrant/go/src/github.com/nemonik/helloworld-web/.scannerwork
20:05:58.928 DEBUG: Execution execute
20:05:59.164 INFO: Publish mode
20:05:59.301 INFO: Load global settings
20:05:59.351 DEBUG: GET 200 http://192.168.0.11:9000/api/settings/values.protobuf | time=40ms
20:05:59.374 INFO: Load global settings (done) | time=74ms
20:05:59.380 INFO: Server id: AWLZ3KmeIXzDnCPHcQJq
20:05:59.392 INFO: User cache: /home/vagrant/.sonar/cache
20:05:59.584 INFO: Load plugins index
20:05:59.591 DEBUG: GET 200 http://192.168.0.11:9000/api/plugins/installed | time=7ms
20:05:59.626 INFO: Load plugins index (done) | time=41ms
20:05:59.626 INFO: Load/download plugins
20:05:59.633 INFO: Load/download plugins (done) | time=7ms
20:05:59.652 DEBUG: Plugins:
20:05:59.652 DEBUG:   * Golang 1.2.11-rc13 (golang)
20:05:59.919 INFO: Process project properties
20:05:59.926 DEBUG: Process project properties (done) | time=7ms
20:05:59.950 INFO: Load project repositories
20:05:59.964 DEBUG: GET 200 http://192.168.0.11:9000/batch/project.protobuf?key=helloworld-web | time=11ms
20:06:00.027 INFO: Load project repositories (done) | time=77ms
20:06:00.103 DEBUG: Available languages:
20:06:00.103 DEBUG:   * GO =&gt; &quot;go&quot;
20:06:00.114 INFO: Load quality profiles
20:06:00.131 DEBUG: GET 200 http://192.168.0.11:9000/api/qualityprofiles/search.protobuf?projectKey=helloworld-web | time=17ms
20:06:00.137 INFO: Load quality profiles (done) | time=23ms
20:06:00.152 INFO: Load active rules
20:06:00.194 DEBUG: GET 200 http://192.168.0.11:9000/api/rules/search.protobuf?f=repo,name,severity,lang,internalKey,templateKey,params,actives,createdAt&amp;activation=true&amp;qprofile=AWLZ3MQiIXzDnCPHcQLh&amp;p=1&amp;ps=500 | time=41ms
20:06:00.241 INFO: Load active rules (done) | time=88ms
20:06:00.245 INFO: Load metrics repository
20:06:00.255 DEBUG: GET 200 http://192.168.0.11:9000/api/metrics/search?f=name,description,direction,qualitative,custom&amp;ps=500&amp;p=1 | time=10ms
20:06:00.271 INFO: Load metrics repository (done) | time=26ms
20:06:00.282 WARN: SCM provider autodetection failed. No SCM provider claims to support this project. Please use sonar.scm.provider to define SCM of your project.
20:06:00.287 INFO: Project key: helloworld-web
20:06:00.287 DEBUG: Start recursive analysis of project modules
20:06:00.288 INFO: -------------  Scan helloworld-web
20:06:00.354 INFO: Load server rules
20:06:00.361 DEBUG: GET 200 http://192.168.0.11:9000/api/rules/list.protobuf | time=6ms
20:06:00.365 INFO: Load server rules (done) | time=11ms
20:06:00.394 INFO: Base dir: /home/vagrant/go/src/github.com/nemonik/helloworld-web
20:06:00.394 INFO: Working dir: /home/vagrant/go/src/github.com/nemonik/helloworld-web/.scannerwork
20:06:00.396 INFO: Source paths: .
20:06:00.396 INFO: Source encoding: UTF-8, default locale: en_US
20:06:00.418 DEBUG: Declared extensions of language GO were converted to sonar.lang.patterns.go : **/*.go
20:06:00.422 DEBUG: Initializers :
20:06:00.424 INFO: Index files
20:06:00.431 INFO: Excluded sources:
20:06:00.431 INFO:   **/*test.go
20:06:00.441 DEBUG: &apos;main.go&apos; indexed with language &apos;go&apos;
20:06:00.443 DEBUG: &apos;helloworld-web&apos; indexed with language &apos;null&apos;
20:06:00.445 DEBUG: &apos;report.xml&apos; indexed with language &apos;null&apos;
20:06:00.446 DEBUG: &apos;coverage.xml&apos; indexed with language &apos;null&apos;
20:06:00.446 DEBUG: &apos;test.xml&apos; indexed with language &apos;null&apos;
20:06:00.446 DEBUG: &apos;Makefile&apos; indexed with language &apos;null&apos;
20:06:00.448 INFO: 6 files indexed
20:06:00.449 INFO: 1 file ignored because of inclusion/exclusion patterns
20:06:00.449 INFO: Quality profile for go: Golint Rules
20:06:00.459 DEBUG: &apos;Generic Coverage Report&apos; skipped because one of the required properties is missing
20:06:00.459 DEBUG: &apos;Generic Test Executions Report&apos; skipped because one of the required properties is missing
20:06:00.468 DEBUG: &apos;Generic Coverage Report&apos; skipped because one of the required properties is missing
20:06:00.469 DEBUG: &apos;Generic Test Executions Report&apos; skipped because one of the required properties is missing
20:06:00.472 DEBUG: Sensors : GoMetaLinter issues loader sensor -&gt; Go Coverage -&gt; Go test JUnit loader sensor -&gt; Go Highlighter Sensor -&gt; Go Metrics Sensor -&gt; Zero Coverage Sensor -&gt; CPD Block Indexer
20:06:00.473 INFO: Sensor GoMetaLinter issues loader sensor [golang]
20:06:00.511 INFO: Parsing the file report.xml
20:06:00.511 INFO: Parsing &apos;GoMetaLinter&apos; Analysis Results
20:06:00.512 DEBUG: Parsing file /home/vagrant/go/src/github.com/nemonik/helloworld-web/report.xml
20:06:00.533 DEBUG: violation found for the file main.go
20:06:00.534 INFO: Load /key.properties
20:06:00.535 INFO: loaded 52
20:06:00.551 DEBUG: &apos;main.go&apos; generated metadata  with charset &apos;UTF-8&apos;
20:06:00.565 INFO: Sensor GoMetaLinter issues loader sensor [golang] (done) | time=92ms
20:06:00.565 INFO: Sensor Go Coverage [golang]
20:06:00.565 INFO: /home/vagrant/go/src/github.com/nemonik/helloworld-web
20:06:00.569 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web
20:06:00.569 INFO: Analyse for /home/vagrant/go/src/github.com/nemonik/helloworld-web/coverage.xml
20:06:00.580 DEBUG: filepath from coverage file /home/vagrant/go/src/github.com/nemonik/helloworld-web/main.go
20:06:00.581 DEBUG: 7line coverage for file /home/vagrant/go/src/github.com/nemonik/helloworld-web/main.go
20:06:00.595 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs
20:06:00.595 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs/coverage.xml
20:06:00.595 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs/heads
20:06:00.595 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs/heads/coverage.xml
20:06:00.597 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs/tags
20:06:00.597 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/refs/tags/coverage.xml
20:06:00.597 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/branches
20:06:00.597 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/branches/coverage.xml
20:06:00.597 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/description
20:06:00.598 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks
20:06:00.598 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/coverage.xml
20:06:00.598 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/applypatch-msg.sample
20:06:00.598 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/commit-msg.sample
20:06:00.599 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/post-update.sample
20:06:00.599 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/pre-applypatch.sample
20:06:00.599 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/pre-commit.sample
20:06:00.599 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/pre-push.sample
20:06:00.599 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/pre-rebase.sample
20:06:00.600 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/prepare-commit-msg.sample
20:06:00.600 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/hooks/update.sample
20:06:00.600 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/info
20:06:00.600 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/info/coverage.xml
20:06:00.600 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/info/exclude
20:06:00.601 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/HEAD
20:06:00.601 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/config
20:06:00.601 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects
20:06:00.601 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects/coverage.xml
20:06:00.601 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects/pack
20:06:00.602 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects/pack/coverage.xml
20:06:00.602 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects/info
20:06:00.602 INFO: no coverage file in package /home/vagrant/go/src/github.com/nemonik/helloworld-web/.git/objects/info/coverage.xml
20:06:00.602 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/main.go
20:06:00.602 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/helloworld-web
20:06:00.603 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/report.xml
20:06:00.603 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/coverage.xml
20:06:00.604 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/test.xml
20:06:00.604 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/main_test.go
20:06:00.604 DEBUG: Path in stream/home/vagrant/go/src/github.com/nemonik/helloworld-web/Makefile
20:06:00.607 INFO: Sensor Go Coverage [golang] (done) | time=42ms
20:06:00.607 INFO: Sensor Go test JUnit loader sensor [golang]
20:06:00.608 INFO: base dir /home/vagrant/go/src/github.com/nemonik/helloworld-web
20:06:00.610 DEBUG: {}
20:06:00.610 DEBUG: {}
20:06:00.613 WARN: The key is null
20:06:00.614 INFO: Sensor Go test JUnit loader sensor [golang] (done) | time=6ms
20:06:00.614 INFO: Sensor Go Highlighter Sensor [golang]
20:06:00.615 DEBUG: Coloring the file: /home/vagrant/go/src/github.com/nemonik/helloworld-web/main.go
20:06:00.628 DEBUG: Line number 1 index start: 0 index end: 7
20:06:00.629 DEBUG: Line number 3 index start: 0 index end: 6
20:06:00.629 DEBUG: 	&quot;fmt&quot; 1
20:06:00.629 DEBUG: 	&quot;fmt&quot; 5
20:06:00.629 DEBUG: index 1 indexEnd 5
20:06:00.629 DEBUG: 	&quot;fmt&quot; -1
20:06:00.629 DEBUG: 	&quot;fmt&quot; 1
20:06:00.630 DEBUG: 	&quot;net/http&quot; 1
20:06:00.630 DEBUG: 	&quot;net/http&quot; 10
20:06:00.630 DEBUG: index 1 indexEnd 10
20:06:00.630 DEBUG: 	&quot;net/http&quot; -1
20:06:00.630 DEBUG: 	&quot;net/http&quot; 1
20:06:00.630 DEBUG: Line number 8 index start: 0 index end: 4
20:06:00.630 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 17
20:06:00.630 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 19
20:06:00.630 DEBUG: index 17 indexEnd 19
20:06:00.630 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) -1
20:06:00.630 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 17
20:06:00.630 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 11
20:06:00.630 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 32
20:06:00.630 DEBUG: index 11 indexEnd 32
20:06:00.631 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) -1
20:06:00.631 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 11
20:06:00.631 DEBUG: Line number 10 index start: 7 index end: 10
20:06:00.631 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 21
20:06:00.631 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 27
20:06:00.631 DEBUG: index 21 indexEnd 27
20:06:00.631 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) -1
20:06:00.631 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 21
20:06:00.631 DEBUG: Line number 14 index start: 0 index end: 4
20:06:00.631 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 16
20:06:00.632 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 29
20:06:00.632 DEBUG: index 16 indexEnd 29
20:06:00.632 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) -1
20:06:00.632 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 16
20:06:00.632 DEBUG: Line number 15 index start: 8 index end: 11
20:06:00.632 DEBUG: Line number 18 index start: 0 index end: 4
20:06:00.632 DEBUG: Line number 19 index start: 25 index end: 29
20:06:00.632 DEBUG: Line number 19 index start: 1 index end: 7
20:06:00.632 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 13
20:06:00.632 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 26
20:06:00.632 DEBUG: index 13 indexEnd 26
20:06:00.632 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) -1
20:06:00.633 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 13
20:06:00.633 DEBUG: Line number 20 index start: 8 index end: 11
20:06:00.639 INFO: Sensor Go Highlighter Sensor [golang] (done) | time=25ms
20:06:00.639 INFO: Sensor Go Metrics Sensor [golang]
20:06:00.641 INFO: Sensor Go Metrics Sensor [golang] (done) | time=2ms
20:06:00.641 INFO: Sensor Zero Coverage Sensor
20:06:00.651 INFO: Sensor Zero Coverage Sensor (done) | time=10ms
20:06:00.651 INFO: Sensor CPD Block Indexer
20:06:00.652 DEBUG: org.sonar.scanner.cpd.deprecated.DefaultCpdBlockIndexer is used for go
20:06:00.652 DEBUG: No CpdMapping for language go
20:06:00.652 INFO: Sensor CPD Block Indexer (done) | time=1ms
20:06:00.652 INFO: No SCM system was detected. You can use the &apos;sonar.scm.provider&apos; property to explicitly specify it.
20:06:00.653 INFO: Calculating CPD for 0 files
20:06:00.655 INFO: CPD calculation finished
20:06:00.717 INFO: Analysis report generated in 61ms, dir size=20 KB
20:06:00.730 INFO: Analysis reports compressed in 12ms, zip size=6 KB
20:06:00.730 INFO: Analysis report generated in /home/vagrant/go/src/github.com/nemonik/helloworld-web/.scannerwork/scanner-report
20:06:00.730 DEBUG: Upload report
20:06:00.753 DEBUG: POST 200 http://192.168.0.11:9000/api/ce/submit?projectKey=helloworld-web&amp;projectName=helloworld-web | time=22ms
20:06:00.755 INFO: Analysis report uploaded in 24ms
20:06:00.756 INFO: ANALYSIS SUCCESSFUL, you can browse http://192.168.0.11:9000/dashboard/index/helloworld-web
20:06:00.756 INFO: Note that you will be able to access the updated dashboard once the server has processed the submitted analysis report
20:06:00.756 INFO: More about the report processing at http://192.168.0.11:9000/api/ce/task?id=AWLaXScEE0IcvTpxuSn-
20:06:00.757 DEBUG: Report metadata written to /home/vagrant/go/src/github.com/nemonik/helloworld-web/.scannerwork/report-task.txt
20:06:00.759 DEBUG: Post-jobs :
20:06:00.764 INFO: Task total time: 1.110 s
20:06:00.833 INFO: ------------------------------------------------------------------------
20:06:00.833 INFO: EXECUTION SUCCESS
20:06:00.833 INFO: ------------------------------------------------------------------------
20:06:00.833 INFO: Total time: 2.402s
20:06:00.884 INFO: Final Memory: 10M/117M
20:06:00.884 INFO: ------------------------------------------------------------------------
[vagrant@dev helloworld-web]$ make run
go build -o helloworld-web -v ./...
./helloworld-web
listening on :3000
^Cmake: *** [run] Interrupt
</code></pre><h3 class="mume-header" id="8109-dockerize-the-application">8.10.9. Dockerize the application</h3>

<p>Build a Docker image named <code>nemonik/helloworld-web</code> for the application and all its dependencies to ensure a repeatable deployment on Docker by opening the file <code>Dockerfile</code> in an editor at the root of the project and copy the is content into it</p>
<pre data-role="codeBlock" data-info="docker" class="language-docker"><span class="token keyword">FROM</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/golang<span class="token punctuation">:</span>1.10.1
<span class="token keyword">MAINTAINER</span> Michael Joseph Walsh &lt;nemonik@gmail.com<span class="token punctuation">></span>

<span class="token keyword">RUN</span> mkdir /app
<span class="token keyword">ADD</span> main.go /app/

<span class="token keyword">WORKDIR</span> /app

<span class="token keyword">RUN</span> go build <span class="token punctuation">-</span>o helloworld<span class="token punctuation">-</span>web .

<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">"/app/helloworld-web"</span><span class="token punctuation">]</span>

<span class="token keyword">EXPOSE</span> 3000
</pre><p>Then create the Docker image</p>
<p><code>docker build -t nemonik/helloworld-web .</code>  Don't miss that last period (<code>.</code>).</p>
<p>Command line output will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker build -t nemonik/helloworld-web .
Sending build context to Docker daemon  6.704MB
Step 1/8 : FROM 192.168.0.11:5000/nemonik/golang:1.10.1
1.10.1: Pulling from nemonik/golang
c73ab1c6897b: Pull complete
1ab373b3deae: Pull complete
b542772b4177: Pull complete
57c8de432dbe: Pull complete
c81227e1ec90: Pull complete
df4d04d0f54c: Pull complete
8ed488a16a31: Pull complete
0828adce2551: Pull complete
9b8c7e5da5a1: Pull complete
0b398c7e2292: Pull complete
30e8e73c0c04: Pull complete
1de129fb171b: Pull complete
27eab3e938d4: Pull complete
17d8f862a4a2: Pull complete
38a4faa53d09: Pull complete
Digest: sha256:80864483daf76493863de6388a0bee977ddbc002d7b0cb19f253b3a1ddc8e14b
Status: Downloaded newer image for 192.168.0.11:5000/nemonik/golang:1.10.1
 ---&gt; 7c239dc2f416
Step 2/8 : MAINTAINER Michael Joseph Walsh &lt;nemonik@gmail.com&gt;
 ---&gt; Running in c90fdce9e639
Removing intermediate container c90fdce9e639
 ---&gt; b3aee577a01b
Step 3/8 : RUN mkdir /app
 ---&gt; Running in 24a817dd0a33
Removing intermediate container 24a817dd0a33
 ---&gt; 8be878c3b7d0
Step 4/8 : ADD main.go /app/
 ---&gt; ba34e7e243ce
Step 5/8 : WORKDIR /app
Removing intermediate container 763c31ec2c24
 ---&gt; dccda18cc25f
Step 6/8 : RUN go build -o helloworld-web .
 ---&gt; Running in 8e75c766891d
Removing intermediate container 8e75c766891d
 ---&gt; 39414f81a3dc
Step 7/8 : CMD [&quot;/app/helloworld-web&quot;]
 ---&gt; Running in 73a1b6ac25e5
Removing intermediate container 73a1b6ac25e5
 ---&gt; 65892d7e6440
Step 8/8 : EXPOSE 3000
 ---&gt; Running in 852b23e5dbd0
Removing intermediate container 852b23e5dbd0
 ---&gt; 5f47437b3b2a
Successfully built 5f47437b3b2a
Successfully tagged nemonik/helloworld-web:latest
</code></pre><p><code>docker build</code> places the image in the local Docker registry so that containers can be created locally. Check the local docker registry for</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker images
</code></pre><p>Command line output will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker images
REPOSITORY                         TAG                 IMAGE ID            CREATED             SIZE
nemonik/helloworld-web             latest              5f47437b3b2a        53 seconds ago      835MB
192.168.0.11:5000/nemonik/golang   1.10.1              7c239dc2f416        2 hours ago         828MB
</code></pre><p>We can update the project's Makefile adding a <code>docker-build</code> target</p>
<pre data-role="codeBlock" data-info="makefile" class="language-makefile"><span class="token symbol">docker-build</span><span class="token punctuation">:</span>
	docker build --no-cache -t nemonik/helloworld-web .
</pre><p>Remember to us tab characters vice space characters.</p>
<p>And then run in the command lin</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>make docker-build
</code></pre><h3 class="mume-header" id="81010-run-the-container">8.10.10. Run the container</h3>

<p>Spin up a new <code>nemonik/helloworld-web</code> container by entering</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker run -p 3000:3000 nemonik/helloworld-web
</code></pre><p>Where</p>
<ul>
<li><code>run</code> messages docker you are running a new container</li>
<li><code>-p 3000:3000</code> published the container's port as 3000 to the host.</li>
<li><code>nemonik/helloworld-web</code> states what container image to use.</li>
</ul>
<p>The command line output will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker run -p 3000:3000 nemonik/helloworld-web
listening on :3000 (
</code></pre><p><code>ctrl-c</code> in the command line to stop the container.</p>
<h3 class="mume-header" id="81011-push-the-container-image-to-the-private-registry">8.10.11. Push the container image to the private registry</h3>

<p>Push the <code>nemonik/hellowrold-web</code> container image into the private Docker registry running on the <code>Toolchain</code> vagrant, so that both vagrants can create containers from the image with the commands</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker tag nemonik/helloworld-web 192.168.0.11:5000/nemonik/helloworld-web
docker push 192.168.0.11:5000/nemonik/helloworld-web
</code></pre><p>Command line output will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker push 192.168.0.11:5000/nemonik/helloworld-web
The push refers to repository [192.168.0.11:5000/nemonik/helloworld-web]
733e19430470: Pushed
72b90bd18970: Pushed
65e96847b487: Pushed
5f69028652b8: Mounted from nemonik/golang
c6d8b0b39323: Mounted from nemonik/golang
a77a1a834917: Mounted from nemonik/golang
92ce06e068ca: Mounted from nemonik/golang
ab8d7a56d156: Mounted from nemonik/golang
30af257ded3b: Mounted from nemonik/golang
120f2e939f3b: Mounted from nemonik/golang
47823918137b: Mounted from nemonik/golang
2bd1ea5f0540: Mounted from nemonik/golang
f2ab791795ee: Mounted from nemonik/golang
e33f0ab4ff77: Mounted from nemonik/golang
20c527f217db: Mounted from nemonik/golang
61c06e07759a: Mounted from nemonik/golang
bcbe43405751: Mounted from nemonik/golang
e1df5dc88d2c: Mounted from nemonik/golang
latest: digest: sha256:59d026c810f0bec333674df6b19e3b8a8fc12c922843579147559996edc6f61a size: 4101
</code></pre><p>We can update the project's Makefile adding a <code>docker-push</code> target</p>
<pre data-role="codeBlock" data-info="makefile" class="language-makefile"><span class="token symbol">docker-push</span><span class="token punctuation">:</span>
<span class="token symbol">	docker tag nemonik/helloworld-web 192.168.0.11</span><span class="token punctuation">:</span>5000/nemonik/helloworld-web
<span class="token symbol">	docker push 192.168.0.11</span><span class="token punctuation">:</span>5000/nemonik/helloworld-web
</pre><p>And then run in the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>make docker-push
</code></pre><p>The Docker registry container image shipped by Docker does not provide a GUI, but we can verify by querying the catalog of the private registry through a web browser or Unix command line tool <code>curl</code> by entering into the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>curl -X GET http://192.168.0.11:5000/v2/_catalog
</code></pre><p>Returns in the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ curl -X GET http://192.168.0.11:5000/v2/_catalog
{&quot;repositories&quot;:[&quot;nemonik/golang&quot;,&quot;nemonik/golang-sonarqube-scanner&quot;,&quot;nemonik/helloworld-web&quot;,&quot;nemonik/python&quot;,&quot;nemonik/standalone-chrome&quot;,&quot;nemonik/standalone-firefox&quot;,&quot;nemonik/zap2docker-stable&quot;]}
</code></pre><p>Query for the container you pushed</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>curl -X GET http://192.168.0.11:5000/v2/nemonik/helloworld-web/tags/list
</code></pre><p>Returns in the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ curl -X GET http://192.168.0.11:5000/v2/nemonik/helloworld-web/tags/list
{&quot;name&quot;:&quot;nemonik/helloworld-web&quot;,&quot;tags&quot;:[&quot;latest&quot;]}
</code></pre><h3 class="mume-header" id="81012-configure-drone-to-execute-your-pipeline">8.10.12. Configure Drone to execute your pipeline</h3>

<ol>
<li>Open <a href="http://192.168.0.11:8000/">http://192.168.0.11:8000/</a> in your browser and authenticate through GitLab on into Drone, if you need to.</li>
<li>In the upper right corner find the hamburger icon (displayed as ☰) and click it and then select <code>Repositories</code>.</li>
<li>Then click hamburger icon again and select <code>Synchronize</code>, if you don't see your project's repo.</li>
<li>Then click the slider to for the <code>root/helloworld-web</code> repo to enable Drone orchestration for the project.</li>
<li>Clicking the box icon with the arrow pointing toward upper-right to open root/helloworld-web's builds.</li>
</ol>
<h3 class="mume-header" id="81013-author-the-build-step-for-the-pipeline">8.10.13. Author the build step for the pipeline</h3>

<p>At the root of the project open <code>.drone.yml</code> as a new file to edit</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml"><span class="token key atrule">pipeline</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> nemonik/golang<span class="token punctuation">:</span>1.10.1
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> make lint
      <span class="token punctuation">-</span> make test
      <span class="token punctuation">-</span> make build
</pre><p>Then commit to GitLab</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .
git commit -m &quot;added dockerfile&quot;
git push -u origin master
</code></pre><p>Since we have not registered an SSH key with GitLab, we will need to enter a <code>Username</code> and <code>Password</code> when prompted.</p>
<p>In the browser open Drone at <a href="http://192.168.0.11:8000/root/helloworld-web">http://192.168.0.11:8000/root/helloworld-web</a> and click on the build being executed to monitor progress.</p>
<p>Output for <code>build</code> resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ make lint
go get github.com/golang/lint/golint
golint
+ make test
go test -v ./...
=== RUN   TestHandler
--- PASS: TestHandler (0.00s)
PASS
ok  	_/drone/src/192.168.0.11/root/helloworld-web	0.027s
+ make build
go build -o helloworld-web -v
_/drone/src/192.168.0.11/root/helloworld-web
</code></pre><p>Mirroring what you saw in development in your local environment.</p>
<h3 class="mume-header" id="81014-author-the-publish-step-for-the-pipeline">8.10.14. Author the publish step for the pipeline</h3>

<p>Add the publish step to your <code>.drone.yml</code> so that the publish to the private registry will be automated through the pipeline.  The <code>publish:</code> step must be indented the same as the prior <code>build:</code> step.</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">  <span class="token key atrule">publish</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> plugins/docker
    <span class="token key atrule">storage_driver</span><span class="token punctuation">:</span> overlay
    <span class="token key atrule">insecure</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">registry</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span><span class="token number">5000</span>
    <span class="token key atrule">repo</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/helloworld<span class="token punctuation">-</span>web
    <span class="token key atrule">force_tag</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">tags</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> latest <span class="token punctuation">]</span>
    <span class="token key atrule">custom_dns</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"128.29.154.114"</span><span class="token punctuation">,</span> <span class="token string">"129.83.20.114"</span><span class="token punctuation">]</span>
    <span class="token key atrule">when</span><span class="token punctuation">:</span>
      <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</pre><p>This step must be past the DNS servers otherwise the build will fail to resolve the corporate proxy when it attempts to retrieve external dependency to include in the container image this step builds</p>
<p>Push your code into GitLab</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .
git commit -m &quot;added publish step&quot;
git push -u origin master
</code></pre><p>The publish step takes quite a bit of time and resebles:</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ /usr/local/bin/dockerd -g /var/lib/docker -s overlay --insecure-registry 192.168.0.11:5000 --dns 128.29.154.114 --dns 129.83.20.114
Registry credentials not provided. Guest mode enabled.
+ /usr/local/bin/docker version
Client:
 Version:	17.12.0-ce
 API version:	1.35
 Go version:	go1.9.2
 Git commit:	c97c6d6
 Built:	Wed Dec 27 20:05:38 2017
 OS/Arch:	linux/amd64

Server:
 Engine:
  Version:	17.12.0-ce
  API version:	1.35 (minimum version 1.12)
  Go version:	go1.9.2
  Git commit:	c97c6d6
  Built:	Wed Dec 27 20:12:29 2017
  OS/Arch:	linux/amd64
  Experimental:	false
+ /usr/local/bin/docker info
WARNING: bridge-nf-call-iptables is disabled
WARNING: bridge-nf-call-ip6tables is disabled
Containers: 0
 Running: 0
 Paused: 0
 Stopped: 0
Images: 0
Server Version: 17.12.0-ce
Storage Driver: overlay
 Backing Filesystem: xfs
 Supports d_type: true
Logging Driver: json-file
Cgroup Driver: cgroupfs
Plugins:
 Volume: local
 Network: bridge host macvlan null overlay
 Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog
Swarm: inactive
Runtimes: runc
Default Runtime: runc
Init Binary: docker-init
containerd version: 89623f28b87a6004d4b785663257362d1658a729
runc version: b2567b37d7b75eb4cf325b77297b140ea686ce8f
init version: 949e6fa
Security Options:
 seccomp
  Profile: default
Kernel Version: 3.10.0-693.21.1.el7.x86_64
Operating System: Alpine Linux v3.7 (containerized)
OSType: linux
Architecture: x86_64
CPUs: 4
Total Memory: 3.702GiB
Name: bb41b5849706
ID: 2CV5:2RY2:ID5N:XAAV:6VE7:NLCH:QC5I:AH6Z:RNYD:6HDD:G56W:SGMP
Docker Root Dir: /var/lib/docker
Debug Mode (client): false
Debug Mode (server): false
Registry: https://index.docker.io/v1/
Labels:
Experimental: false
Insecure Registries:
 192.168.0.11:5000
 127.0.0.0/8
Live Restore Enabled: false

+ /usr/local/bin/docker build --rm=true -f Dockerfile -t ff06b0d6f51dc80d6ec4cb11dce59503932a9f49 . --pull=true --label org.label-schema.build-date=2018-04-18T20:23:07Z --label org.label-schema.vcs-ref=ff06b0d6f51dc80d6ec4cb11dce59503932a9f49 --label org.label-schema.vcs-url=http://192.168.0.11:10080/root/helloworld-web.git
Sending build context to Docker daemon  9.328MB

Step 1/9 : FROM 192.168.0.11:5000/nemonik/golang:1.10.1
1.10.1: Pulling from nemonik/golang
c73ab1c6897b: Pulling fs layer
1ab373b3deae: Pulling fs layer
b542772b4177: Pulling fs layer
57c8de432dbe: Pulling fs layer
c81227e1ec90: Pulling fs layer
df4d04d0f54c: Pulling fs layer
8ed488a16a31: Pulling fs layer
0828adce2551: Pulling fs layer
9b8c7e5da5a1: Pulling fs layer
0b398c7e2292: Pulling fs layer
30e8e73c0c04: Pulling fs layer
1de129fb171b: Pulling fs layer
27eab3e938d4: Pulling fs layer
17d8f862a4a2: Pulling fs layer
38a4faa53d09: Pulling fs layer
c81227e1ec90: Waiting
df4d04d0f54c: Waiting
30e8e73c0c04: Waiting
1de129fb171b: Waiting
8ed488a16a31: Waiting
0828adce2551: Waiting
27eab3e938d4: Waiting
17d8f862a4a2: Waiting
9b8c7e5da5a1: Waiting
38a4faa53d09: Waiting
0b398c7e2292: Waiting
57c8de432dbe: Waiting
b542772b4177: Verifying Checksum
b542772b4177: Download complete
1ab373b3deae: Verifying Checksum
1ab373b3deae: Download complete
57c8de432dbe: Verifying Checksum
57c8de432dbe: Download complete
c73ab1c6897b: Verifying Checksum
c73ab1c6897b: Download complete
8ed488a16a31: Verifying Checksum
8ed488a16a31: Download complete
c81227e1ec90: Verifying Checksum
c81227e1ec90: Download complete
9b8c7e5da5a1: Verifying Checksum
0828adce2551: Verifying Checksum
9b8c7e5da5a1: Download complete
0828adce2551: Download complete
30e8e73c0c04: Verifying Checksum
30e8e73c0c04: Download complete
0b398c7e2292: Verifying Checksum
0b398c7e2292: Download complete
27eab3e938d4: Verifying Checksum
27eab3e938d4: Download complete
17d8f862a4a2: Verifying Checksum
17d8f862a4a2: Download complete
38a4faa53d09: Verifying Checksum
38a4faa53d09: Download complete
1de129fb171b: Verifying Checksum
1de129fb171b: Download complete
df4d04d0f54c: Verifying Checksum
df4d04d0f54c: Download complete
c73ab1c6897b: Pull complete
1ab373b3deae: Pull complete
b542772b4177: Pull complete
57c8de432dbe: Pull complete
c81227e1ec90: Pull complete
df4d04d0f54c: Pull complete
8ed488a16a31: Pull complete
0828adce2551: Pull complete
9b8c7e5da5a1: Pull complete
0b398c7e2292: Pull complete
30e8e73c0c04: Pull complete
1de129fb171b: Pull complete
27eab3e938d4: Pull complete
17d8f862a4a2: Pull complete
38a4faa53d09: Pull complete
Digest: sha256:80864483daf76493863de6388a0bee977ddbc002d7b0cb19f253b3a1ddc8e14b
Status: Downloaded newer image for 192.168.0.11:5000/nemonik/golang:1.10.1
 ---&gt; 7c239dc2f416
Step 2/9 : MAINTAINER Michael Joseph Walsh &lt;nemonik@gmail.com&gt;
 ---&gt; Running in ccb7b3f16069
Removing intermediate container ccb7b3f16069
 ---&gt; 674ade232277
Step 3/9 : RUN mkdir /app
 ---&gt; Running in 7c1e60ab294d
Removing intermediate container 7c1e60ab294d
 ---&gt; 695af24c4ba3
Step 4/9 : ADD main.go /app/
 ---&gt; 935159a71682
Step 5/9 : WORKDIR /app
Removing intermediate container 49159cfd694e
 ---&gt; 598bd28a1dcc
Step 6/9 : RUN go build -o helloworld-web .
 ---&gt; Running in 9c7db7f708f9
Removing intermediate container 9c7db7f708f9
 ---&gt; 161844c9f380
Step 7/9 : CMD [&quot;/app/helloworld-web&quot;]
 ---&gt; Running in 4b2ae946a10c
Removing intermediate container 4b2ae946a10c
 ---&gt; 379287345efa
Step 8/9 : EXPOSE 3000
 ---&gt; Running in 8cfb85a26d01
Removing intermediate container 8cfb85a26d01
 ---&gt; d3e4d8f8f384
Step 9/9 : LABEL &quot;org.label-schema.build-date&quot;=&apos;2018-04-18T20:23:07Z&apos; &quot;org.label-schema.vcs-ref&quot;=&apos;ff06b0d6f51dc80d6ec4cb11dce59503932a9f49&apos; &quot;org.label-schema.vcs-url&quot;=&apos;http://192.168.0.11:10080/root/helloworld-web.git&apos;
 ---&gt; Running in 559bf2111f9b
Removing intermediate container 559bf2111f9b
 ---&gt; 398456bad9b0
Successfully built 398456bad9b0
Successfully tagged ff06b0d6f51dc80d6ec4cb11dce59503932a9f49:latest
+ /usr/local/bin/docker tag ff06b0d6f51dc80d6ec4cb11dce59503932a9f49 192.168.0.11:5000/nemonik/helloworld-web:latest
+ /usr/local/bin/docker push 192.168.0.11:5000/nemonik/helloworld-web:latest
The push refers to repository [192.168.0.11:5000/nemonik/helloworld-web]
185786c47e18: Preparing
ca386051012f: Preparing
83a7149730ed: Preparing
5f69028652b8: Preparing
c6d8b0b39323: Preparing
a77a1a834917: Preparing
92ce06e068ca: Preparing
ab8d7a56d156: Preparing
30af257ded3b: Preparing
120f2e939f3b: Preparing
47823918137b: Preparing
2bd1ea5f0540: Preparing
f2ab791795ee: Preparing
e33f0ab4ff77: Preparing
20c527f217db: Preparing
61c06e07759a: Preparing
bcbe43405751: Preparing
e1df5dc88d2c: Preparing
120f2e939f3b: Waiting
47823918137b: Waiting
2bd1ea5f0540: Waiting
61c06e07759a: Waiting
f2ab791795ee: Waiting
e33f0ab4ff77: Waiting
20c527f217db: Waiting
a77a1a834917: Waiting
92ce06e068ca: Waiting
bcbe43405751: Waiting
ab8d7a56d156: Waiting
e1df5dc88d2c: Waiting
30af257ded3b: Waiting
5f69028652b8: Layer already exists
c6d8b0b39323: Layer already exists
a77a1a834917: Layer already exists
92ce06e068ca: Layer already exists
30af257ded3b: Layer already exists
ab8d7a56d156: Layer already exists
120f2e939f3b: Layer already exists
47823918137b: Layer already exists
2bd1ea5f0540: Layer already exists
f2ab791795ee: Layer already exists
e33f0ab4ff77: Layer already exists
20c527f217db: Layer already exists
61c06e07759a: Layer already exists
bcbe43405751: Layer already exists
ca386051012f: Pushed
83a7149730ed: Pushed
e1df5dc88d2c: Layer already exists
185786c47e18: Pushed
latest: digest: sha256:7f3030c35497e19a5677458be9b541f9e337c491d680a0fa5ad4e10127d50908 size: 4101
+ /usr/local/bin/docker rmi ff06b0d6f51dc80d6ec4cb11dce59503932a9f49
Untagged: ff06b0d6f51dc80d6ec4cb11dce59503932a9f49:latest
+ /usr/local/bin/docker system prune -f
Total reclaimed space: 0B
</code></pre><p>Indicating the <code>publish</code> executed successfully.</p>
<h3 class="mume-header" id="81015-add-a-deploy-step-to-the-pipeliine">8.10.15. Add a deploy step to the pipeliine</h3>

<p>Usually one adds a Drone secret and the <code>appleboy/ssh</code> plugin, but there appears to be a <a href="https://github.com/appleboy/drone-ssh/issues/51">bug in the plugin</a>, but one can accomplish the same goal using the plugin slightly differently.</p>
<p>First, enable the <code>Trusted</code> setting for the repository by opening</p>
<p><a href="http://192.168.0.11:8000/root/helloworld-web/settings">http://192.168.0.11:8000/root/helloworld-web/settings</a></p>
<p>And check off the following</p>
<p>Project Settings</p>
<ul>
<li>Trusted</li>
</ul>
<p>You can leave the others to their defaults.</p>
<p>Look for Drone to float a modal at the bottom left denoting</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>Successfully updated the repository settings
</code></pre><p>indicating success.</p>
<p>Since we let Vagrant manage the creation and configuration of each Vagrant's SSH keys for each of our variants (e.g., dev, toolchain) vagrant will have to create a unique key pair for each vagrant. Vagrant store each vagrant's private inside the <code>.vagrant</code> path created in the class project.</p>
<p>The <code>toolchain</code> vagrant's private keys exists at</p>
<p><code>/vagrant/.vagrant/machines/toolchain/virtualbox/private_key</code></p>
<p>We can access each private key though from inside each vagrant, because we configured each to mount the class project to the path <code>/vagrant</code> with the line</p>
<pre data-role="codeBlock" data-info="ruby" class="language-ruby">    dev<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>synced_folder <span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"/vagrant"</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">"virtualbox"</span>
</pre><p>placed inside of each vagrant's <code>config.vm.define</code> block.</p>
<p>For example, while on the <code>dev</code> vagrant enter the following command</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>ls /vagrant
</code></pre><p>It will show you class project.</p>
<p>Open <code>root/helloworld-web</code>'s <code>.drone.yml</code> in your editor and add an additional <code>deploy:</code> step below the ones you already have with the <code>deploy:</code> being indented the same as the prior <code>build:</code> and <code>deploy:</code> steps.</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> appleboy/drone<span class="token punctuation">-</span>ssh
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.0.11
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">22</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> vagrant
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /vagrant/.vagrant/machines/toolchain/virtualbox/private_key<span class="token punctuation">:</span>/root/ssh/drone_rsa
    <span class="token key atrule">key_path</span><span class="token punctuation">:</span> /root/ssh/drone_rsa
    <span class="token key atrule">command_timeout</span><span class="token punctuation">:</span> <span class="token number">360</span>
    <span class="token key atrule">script</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> docker stop helloworld<span class="token punctuation">-</span>web 2<span class="token punctuation">></span>/dev/null
      <span class="token punctuation">-</span> docker rm helloworld<span class="token punctuation">-</span>web 2<span class="token punctuation">></span>/dev/null
      <span class="token punctuation">-</span> docker rmi 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/helloworld<span class="token punctuation">-</span>web 2<span class="token punctuation">></span>/dev/null
      <span class="token punctuation">-</span> docker run <span class="token punctuation">-</span>d <span class="token punctuation">-</span><span class="token punctuation">-</span>restart=always <span class="token punctuation">-</span><span class="token punctuation">-</span>name helloworld<span class="token punctuation">-</span>web <span class="token punctuation">-</span><span class="token punctuation">-</span>publish 3000<span class="token punctuation">:</span>3000 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/helloworld<span class="token punctuation">-</span>web
    <span class="token key atrule">when</span><span class="token punctuation">:</span>
      <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</pre><p>Commit the code to GitLab hosted remote repo</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .drone.yml
git commit -m &quot;added deploy step to pipeline&quot;
git push -u origin master
</code></pre><p>Open on your host</p>
<p><a href="http://192.168.0.11:8000/root/helloworld-web">http://192.168.0.11:8000/root/helloworld-web</a></p>
<p>And monitor the progress of the build. The pipeline should execute in a few minutes.</p>
<p>Once completed sucessfully, on your host open secure shell to your <code>toolchain</code> vagrant via</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant ssh toolchain
</code></pre><p>Then list the running docker containers filtering for the one the pipeline just created</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker ps --filter &quot;name=helloworld-web&quot;
</code></pre><p>Command line output will resemble</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[root@toolchain drone]# docker ps --filter &quot;name=helloworld-web&quot;
CONTAINER ID        IMAGE                                      COMMAND                 CREATED             STATUS              PORTS                    NAMES
9d08909cc2ee        192.168.0.11:5000/nemonik/helloworld-web   &quot;/app/helloworld-web&quot;   6 seconds ago       Up 5 seconds        0.0.0.0:3000-&gt;3000/tcp   helloworld-web
</code></pre><p>Then on your docker host open</p>
<p><a href="http://192.168.0.11:3000">http://192.168.0.11:3000</a></p>
<p>The browser will render</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>Hello world!
</code></pre><p>So, now we have beggings of a real CI/CD pipeline. There are no strings on me.</p>
<h3 class="mume-header" id="81016-add-to-the-pipeline-sonarqube">8.10.16. Add to the pipeline SonarQube</h3>

<p>So, let us add <code>sonar-scan</code> to our pipeline to update SonarQube with code quality scans automatically by opening <code>.drone.yml</code> in our text editor and adding the following step right after our <code>build</code> step, so that we run the step prior to a deploy.</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">  <span class="token key atrule">sonarqube</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/golang<span class="token punctuation">-</span>sonarqube<span class="token punctuation">-</span>scanner<span class="token punctuation">:</span>3.1.0.1141
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> export DRONESRC=`pwd`
      <span class="token punctuation">-</span> export GOBIN=$GOPATH/bin
      <span class="token punctuation">-</span> mkdir <span class="token punctuation">-</span>p $GOPATH/src/github.com/nemonik
      <span class="token punctuation">-</span> cd $GOPATH/src/github.com/nemonik
      <span class="token punctuation">-</span> ln <span class="token punctuation">-</span>s $DRONESRC helloworld<span class="token punctuation">-</span>web
      <span class="token punctuation">-</span> gometalinter <span class="token punctuation">-</span><span class="token punctuation">-</span>install
      <span class="token punctuation">-</span> gometalinter <span class="token punctuation">-</span><span class="token punctuation">-</span>deadline=120s <span class="token punctuation">-</span><span class="token punctuation">-</span>checkstyle <span class="token punctuation">></span> report.xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> gocov test ./<span class="token punctuation">...</span> <span class="token punctuation">|</span> gocov<span class="token punctuation">-</span>xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> go test  <span class="token punctuation">-</span>v ./<span class="token punctuation">...</span> <span class="token punctuation">|</span> go<span class="token punctuation">-</span>junit<span class="token punctuation">-</span>report <span class="token punctuation">></span> test.xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> sonar<span class="token punctuation">-</span>scanner <span class="token punctuation">-</span>X <span class="token punctuation">-</span>D http.nonProxyHosts=$NO_PROXY <span class="token punctuation">-</span>D http.proxyHost=$HTTP_PROXY <span class="token punctuation">-</span>D sonar.host.url=http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span>9000 <span class="token punctuation">-</span>D sonar.projectKey=helloworld<span class="token punctuation">-</span>web <span class="token punctuation">-</span>D sonar.projectName=helloworld<span class="token punctuation">-</span>web <span class="token punctuation">-</span>D sonar.projectVersion=1.0 <span class="token punctuation">-</span>D sonar.coverage.dtdVerification=false <span class="token punctuation">-</span>D sonar.sources=. <span class="token punctuation">-</span>D sonar.golint.reportPath=report.xml <span class="token punctuation">-</span>D sonar.coverage.reportPath=coverage.xml <span class="token punctuation">-</span>D sonar.coverage.dtdVerification=false <span class="token punctuation">-</span>D sonar.test.reportPath=test.xml <span class="token punctuation">-</span>D sonar.exclusions=**/<span class="token important">*test</span>.go <span class="token punctuation">|</span><span class="token punctuation">|</span> true
</pre><p>Things to note in the above</p>
<ul>
<li>This step uses an image building ontop of the 192.168.0.11:5000/nemonik/golang:1.10.1 image adding all the GoLang lint tools and the installation of <code>sonar-scanner</code> to speed builds along.</li>
<li>And since, Drone mounts the source in the container in path other than  /go/src/github.com/nemonik/helloworld-web` this is handled as well by this sub-section</li>
<li>Cut-and-pasting may split the last <code>-sonar-scanner</code> line into multiple line resulting in your build failing.  Correct in the editor.</li>
</ul>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">      <span class="token punctuation">-</span> export DRONESRC=`pwd`
      <span class="token punctuation">-</span> export GOBIN=$GOPATH/bin
      <span class="token punctuation">-</span> mkdir <span class="token punctuation">-</span>p $GOPATH/src/github.com/nemonik
      <span class="token punctuation">-</span> cd $GOPATH/src/github.com/nemonik
      <span class="token punctuation">-</span> ln <span class="token punctuation">-</span>s $DRONESRC helloworld<span class="token punctuation">-</span>web
</pre><p>What follows handles running the scan absorbing errors as they arise, so as to not break the build.</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">      <span class="token punctuation">-</span> gometalinter <span class="token punctuation">-</span><span class="token punctuation">-</span>install
      <span class="token punctuation">-</span> gometalinter <span class="token punctuation">-</span><span class="token punctuation">-</span>deadline=120s <span class="token punctuation">-</span><span class="token punctuation">-</span>checkstyle <span class="token punctuation">></span> report.xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> gocov test ./<span class="token punctuation">...</span> <span class="token punctuation">|</span> gocov<span class="token punctuation">-</span>xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> go test  <span class="token punctuation">-</span>v ./<span class="token punctuation">...</span> <span class="token punctuation">|</span> go<span class="token punctuation">-</span>junit<span class="token punctuation">-</span>report <span class="token punctuation">></span> test.xml <span class="token punctuation">|</span><span class="token punctuation">|</span> true
      <span class="token punctuation">-</span> sonar<span class="token punctuation">-</span>scanner <span class="token punctuation">-</span>X <span class="token punctuation">-</span>D http.nonProxyHosts=$NO_PROXY <span class="token punctuation">-</span>D http.proxyHost=$HTTP_PROXY <span class="token punctuation">-</span>D sonar.host.url=http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span>9000 <span class="token punctuation">-</span>D sonar.projectKey=helloworld<span class="token punctuation">-</span>web <span class="token punctuation">-</span>D sonar.projectName=helloworld<span class="token punctuation">-</span>web <span class="token punctuation">-</span>D sonar.projectVersion=1.0 <span class="token punctuation">-</span>D sonar.coverage.dtdVerification=false <span class="token punctuation">-</span>D sonar.sources=. <span class="token punctuation">-</span>D sonar.golint.reportPath=report.xml <span class="token punctuation">-</span>D sonar.coverage.reportPath=coverage.xml <span class="token punctuation">-</span>D sonar.coverage.dtdVerification=false <span class="token punctuation">-</span>D sonar.test.reportPath=test.xml <span class="token punctuation">-</span>D sonar.exclusions=**/<span class="token important">*test</span>.go <span class="token punctuation">|</span><span class="token punctuation">|</span> true
</pre><p>Commit the code to GitLab hosted remote repo</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .drone.yml
git commit -m &quot;added deploy step to pipeline&quot;
git push -u origin master
</code></pre><p>Open on your host</p>
<p><a href="http://192.168.0.11:8000/root/helloworld-web">http://192.168.0.11:8000/root/helloworld-web</a></p>
<p>And monitor the progress of the build. The pipeline should execute in a few minutes.</p>
<p>Typical success resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ export DRONESRC=/drone/src/192.168.0.11/root/helloworld-web
+ export GOBIN=$GOPATH/bin
+ mkdir -p $GOPATH/src/github.com/nemonik
+ cd $GOPATH/src/github.com/nemonik
+ ln -s $DRONESRC helloworld-web
+ gometalinter --install
Installing:
  deadcode
  dupl
  errcheck
  gas
  goconst
  gocyclo
  goimports
  golint
  gosimple
  gotype
  gotypex
  ineffassign
  interfacer
  lll
  maligned
  megacheck
  misspell
  nakedret
  safesql
  staticcheck
  structcheck
  unconvert
  unparam
  unused
  varcheck
  vet
+ gometalinter --deadline=120s --checkstyle &gt; report.xml || true
+ gocov test ./... | gocov-xml || true
warning: &quot;./...&quot; matched no packages
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE coverage SYSTEM &quot;http://cobertura.sourceforge.net/xml/coverage-03.dtd&quot;&gt;
&lt;coverage line-rate=&quot;0&quot; branch-rate=&quot;0&quot; version=&quot;&quot; timestamp=&quot;1524084561079&quot;&gt;
	&lt;packages&gt;&lt;/packages&gt;
&lt;/coverage&gt;
+ go test  -v ./... | go-junit-report &gt; test.xml || true
warning: &quot;./...&quot; matched no packages
no packages to test
+ sonar-scanner -X -D http.nonProxyHosts=$NO_PROXY -D http.proxyHost=$HTTP_PROXY -D sonar.host.url=http://192.168.0.11:9000 -D sonar.projectKey=helloworld-web -D sonar.projectName=helloworld-web -D sonar.projectVersion=1.0 -D sonar.coverage.dtdVerification=false -D sonar.sources=. -D sonar.golint.reportPath=report.xml -D sonar.coverage.reportPath=coverage.xml -D sonar.coverage.dtdVerification=false -D sonar.test.reportPath=test.xml -D sonar.exclusions=**/*test.go || true
20:49:21.653 INFO: Scanner configuration file: /usr/local/sonar-scanner-3.1.0.1141-linux/conf/sonar-scanner.properties
20:49:21.661 INFO: Project root configuration file: NONE
20:49:21.712 INFO: SonarQube Scanner 3.1.0.1141
20:49:21.713 INFO: Java 1.8.0_121 Oracle Corporation (64-bit)
20:49:21.713 INFO: Linux 3.10.0-693.21.1.el7.x86_64 amd64
20:49:21.931 DEBUG: keyStore is : 
20:49:21.931 DEBUG: keyStore type is : jks
20:49:21.931 DEBUG: keyStore provider is : 
20:49:21.931 DEBUG: init keystore
20:49:21.932 DEBUG: init keymanager of type SunX509
20:49:22.029 DEBUG: Create: /root/.sonar/cache
20:49:22.030 INFO: User cache: /root/.sonar/cache
20:49:22.030 DEBUG: Create: /root/.sonar/cache/_tmp
20:49:22.033 DEBUG: Extract sonar-scanner-api-batch in temp...
20:49:22.045 DEBUG: Get bootstrap index...
20:49:22.045 DEBUG: Download: http://192.168.0.11:9000/batch/index
20:49:22.437 DEBUG: Get bootstrap completed
20:49:22.456 DEBUG: Download http://192.168.0.11:9000/batch/file?name=sonar-scanner-engine-shaded-7.0.jar to /root/.sonar/cache/_tmp/fileCache7629854250176291311.tmp
20:49:22.945 DEBUG: Create isolated classloader...
20:49:22.964 DEBUG: Start temp cleaning...
20:49:22.971 DEBUG: Temp cleaning done
20:49:22.972 DEBUG: Execution getVersion
20:49:22.975 INFO: SonarQube server 7.0.0
20:49:22.975 INFO: Default locale: &quot;en_US&quot;, source code encoding: &quot;US-ASCII&quot; (analysis is platform dependent)
20:49:22.976 DEBUG: Work directory: /go/src/github.com/nemonik/.scannerwork
20:49:22.977 DEBUG: Execution execute
20:49:23.325 INFO: Publish mode
20:49:23.457 INFO: Load global settings
20:49:23.798 DEBUG: GET 200 http://192.168.0.11:9000/api/settings/values.protobuf | time=333ms
20:49:23.818 INFO: Load global settings (done) | time=362ms
20:49:23.830 INFO: Server id: AWLZ3KmeIXzDnCPHcQJq
20:49:23.877 INFO: User cache: /root/.sonar/cache
20:49:24.093 INFO: Load plugins index
20:49:24.169 DEBUG: GET 200 http://192.168.0.11:9000/api/plugins/installed | time=75ms
20:49:24.207 INFO: Load plugins index (done) | time=114ms
20:49:24.207 INFO: Load/download plugins
20:49:24.208 DEBUG: Download plugin &apos;sonar-golang-plugin-1.2.11-rc13.jar&apos; to &apos;/root/.sonar/cache/_tmp/fileCache4373472418721829869.tmp&apos;
20:49:24.240 DEBUG: GET 200 http://192.168.0.11:9000/deploy/plugins/golang/sonar-golang-plugin-1.2.11-rc13.jar | time=30ms
20:49:24.402 INFO: Load/download plugins (done) | time=195ms
20:49:24.550 DEBUG: Plugins:
20:49:24.550 DEBUG:   * Golang 1.2.11-rc13 (golang)
20:49:24.881 INFO: Process project properties
20:49:24.890 DEBUG: Process project properties (done) | time=8ms
20:49:24.910 INFO: Load project repositories
20:49:25.158 DEBUG: GET 200 http://192.168.0.11:9000/batch/project.protobuf?key=helloworld-web | time=247ms
20:49:25.215 INFO: Load project repositories (done) | time=305ms
20:49:25.286 DEBUG: Available languages:
20:49:25.286 DEBUG:   * GO =&gt; &quot;go&quot;
20:49:25.305 INFO: Load quality profiles
20:49:25.452 DEBUG: GET 200 http://192.168.0.11:9000/api/qualityprofiles/search.protobuf?projectKey=helloworld-web | time=145ms
20:49:25.462 INFO: Load quality profiles (done) | time=157ms
20:49:25.481 INFO: Load active rules
20:49:26.617 DEBUG: GET 200 http://192.168.0.11:9000/api/rules/search.protobuf?f=repo,name,severity,lang,internalKey,templateKey,params,actives,createdAt&amp;activation=true&amp;qprofile=AWLZ3MQiIXzDnCPHcQLh&amp;p=1&amp;ps=500 | time=1135ms
20:49:26.669 INFO: Load active rules (done) | time=1188ms
20:49:26.675 INFO: Load metrics repository
20:49:26.754 DEBUG: GET 200 http://192.168.0.11:9000/api/metrics/search?f=name,description,direction,qualitative,custom&amp;ps=500&amp;p=1 | time=79ms
20:49:26.769 INFO: Load metrics repository (done) | time=94ms
20:49:26.779 WARN: SCM provider autodetection failed. No SCM provider claims to support this project. Please use sonar.scm.provider to define SCM of your project.
20:49:26.788 INFO: Project key: helloworld-web
20:49:26.789 DEBUG: Start recursive analysis of project modules
20:49:26.790 INFO: -------------  Scan helloworld-web
20:49:26.854 INFO: Load server rules
20:49:26.884 DEBUG: GET 200 http://192.168.0.11:9000/api/rules/list.protobuf | time=29ms
20:49:26.889 INFO: Load server rules (done) | time=35ms
20:49:26.918 INFO: Base dir: /go/src/github.com/nemonik
20:49:26.918 INFO: Working dir: /go/src/github.com/nemonik/.scannerwork
20:49:26.920 INFO: Source paths: .
20:49:26.920 INFO: Source encoding: US-ASCII, default locale: en_US
20:49:26.946 DEBUG: Declared extensions of language GO were converted to sonar.lang.patterns.go : **/*.go
20:49:26.949 DEBUG: Initializers : 
20:49:26.950 INFO: Index files
20:49:26.958 INFO: Excluded sources: 
20:49:26.958 INFO:   **/*test.go
20:49:26.973 DEBUG: &apos;helloworld-web/Dockerfile&apos; indexed with language &apos;null&apos;
20:49:26.975 DEBUG: &apos;helloworld-web/main.go&apos; indexed with language &apos;go&apos;
20:49:26.975 DEBUG: &apos;helloworld-web/Makefile&apos; indexed with language &apos;null&apos;
20:49:26.975 DEBUG: &apos;helloworld-web/helloworld-web&apos; indexed with language &apos;null&apos;
20:49:26.975 DEBUG: &apos;report.xml&apos; indexed with language &apos;null&apos;
20:49:26.975 DEBUG: &apos;test.xml&apos; indexed with language &apos;null&apos;
20:49:26.977 INFO: 6 files indexed
20:49:26.977 INFO: 1 file ignored because of inclusion/exclusion patterns
20:49:26.978 INFO: Quality profile for go: Golint Rules
20:49:26.993 DEBUG: &apos;Generic Coverage Report&apos; skipped because one of the required properties is missing
20:49:26.994 DEBUG: &apos;Generic Test Executions Report&apos; skipped because one of the required properties is missing
20:49:27.008 DEBUG: &apos;Generic Coverage Report&apos; skipped because one of the required properties is missing
20:49:27.008 DEBUG: &apos;Generic Test Executions Report&apos; skipped because one of the required properties is missing
20:49:27.014 DEBUG: Sensors : GoMetaLinter issues loader sensor -&gt; Go Coverage -&gt; Go test JUnit loader sensor -&gt; Go Highlighter Sensor -&gt; Go Metrics Sensor -&gt; Zero Coverage Sensor -&gt; CPD Block Indexer
20:49:27.014 INFO: Sensor GoMetaLinter issues loader sensor [golang]
20:49:27.028 INFO: Parsing the file report.xml
20:49:27.028 INFO: Parsing &apos;GoMetaLinter&apos; Analysis Results
20:49:27.029 DEBUG: Parsing file /go/src/github.com/nemonik/report.xml
20:49:27.101 INFO: Sensor GoMetaLinter issues loader sensor [golang] (done) | time=87ms
20:49:27.101 INFO: Sensor Go Coverage [golang]
20:49:27.101 INFO: /go/src/github.com/nemonik
20:49:27.106 DEBUG: Path in stream/go/src/github.com/nemonik
20:49:27.106 INFO: no coverage file in package /go/src/github.com/nemonik/coverage.xml
20:49:27.106 DEBUG: Path in stream/go/src/github.com/nemonik/helloworld-web
20:49:27.106 INFO: no coverage file in package /go/src/github.com/nemonik/helloworld-web/coverage.xml
20:49:27.107 DEBUG: Path in stream/go/src/github.com/nemonik/report.xml
20:49:27.107 DEBUG: Path in stream/go/src/github.com/nemonik/test.xml
20:49:27.132 DEBUG: &apos;helloworld-web/main.go&apos; generated metadata  with charset &apos;US-ASCII&apos;
20:49:27.147 INFO: Sensor Go Coverage [golang] (done) | time=46ms
20:49:27.147 INFO: Sensor Go test JUnit loader sensor [golang]
20:49:27.149 INFO: base dir /go/src/github.com/nemonik
20:49:27.150 DEBUG: {}
20:49:27.150 DEBUG: {}
20:49:27.153 INFO: Sensor Go test JUnit loader sensor [golang] (done) | time=6ms
20:49:27.153 INFO: Sensor Go Highlighter Sensor [golang]
20:49:27.156 DEBUG: Coloring the file: /go/src/github.com/nemonik/helloworld-web/main.go
20:49:27.167 DEBUG: Line number 1 index start: 0 index end: 7
20:49:27.169 DEBUG: Line number 3 index start: 0 index end: 6
20:49:27.169 DEBUG: 	&quot;fmt&quot; 1
20:49:27.169 DEBUG: 	&quot;fmt&quot; 5
20:49:27.169 DEBUG: index 1 indexEnd 5
20:49:27.169 DEBUG: 	&quot;fmt&quot; -1
20:49:27.169 DEBUG: 	&quot;fmt&quot; 1
20:49:27.169 DEBUG: 	&quot;net/http&quot; 1
20:49:27.169 DEBUG: 	&quot;net/http&quot; 10
20:49:27.170 DEBUG: index 1 indexEnd 10
20:49:27.170 DEBUG: 	&quot;net/http&quot; -1
20:49:27.170 DEBUG: 	&quot;net/http&quot; 1
20:49:27.170 DEBUG: Line number 8 index start: 0 index end: 4
20:49:27.170 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 17
20:49:27.170 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 19
20:49:27.170 DEBUG: index 17 indexEnd 19
20:49:27.171 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) -1
20:49:27.171 DEBUG: 	http.HandleFunc(&quot;/&quot;, handler) 17
20:49:27.171 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 11
20:49:27.171 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 32
20:49:27.171 DEBUG: index 11 indexEnd 32
20:49:27.171 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) -1
20:49:27.171 DEBUG: 	fmt.Print(&quot;listening on :3000\n&quot;) 11
20:49:27.171 DEBUG: Line number 10 index start: 7 index end: 10
20:49:27.172 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 21
20:49:27.172 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 27
20:49:27.172 DEBUG: index 21 indexEnd 27
20:49:27.172 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) -1
20:49:27.172 DEBUG: 	http.ListenAndServe(&quot;:3000&quot;, logRequest(http.DefaultServeMux)) 21
20:49:27.172 DEBUG: Line number 14 index start: 0 index end: 4
20:49:27.172 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 16
20:49:27.172 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 29
20:49:27.173 DEBUG: index 16 indexEnd 29
20:49:27.173 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) -1
20:49:27.173 DEBUG: 	fmt.Fprintf(w, &quot;Hello world!&quot;) 16
20:49:27.173 DEBUG: Line number 15 index start: 8 index end: 11
20:49:27.173 DEBUG: Line number 18 index start: 0 index end: 4
20:49:27.173 DEBUG: Line number 19 index start: 25 index end: 29
20:49:27.173 DEBUG: Line number 19 index start: 1 index end: 7
20:49:27.173 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 13
20:49:27.173 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 26
20:49:27.174 DEBUG: index 13 indexEnd 26
20:49:27.174 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) -1
20:49:27.174 DEBUG: 		fmt.Printf(&quot;%s  %s  %s\n&quot;, r.RemoteAddr, r.Method, r.URL) 13
20:49:27.174 DEBUG: Line number 20 index start: 8 index end: 11
20:49:27.183 INFO: Sensor Go Highlighter Sensor [golang] (done) | time=30ms
20:49:27.183 INFO: Sensor Go Metrics Sensor [golang]
20:49:27.186 INFO: Sensor Go Metrics Sensor [golang] (done) | time=3ms
20:49:27.186 INFO: Sensor Zero Coverage Sensor
20:49:27.199 INFO: Sensor Zero Coverage Sensor (done) | time=13ms
20:49:27.199 INFO: Sensor CPD Block Indexer
20:49:27.200 DEBUG: org.sonar.scanner.cpd.deprecated.DefaultCpdBlockIndexer is used for go
20:49:27.200 DEBUG: No CpdMapping for language go
20:49:27.200 INFO: Sensor CPD Block Indexer (done) | time=1ms
20:49:27.200 INFO: No SCM system was detected. You can use the &apos;sonar.scm.provider&apos; property to explicitly specify it.
20:49:27.201 INFO: Calculating CPD for 0 files
20:49:27.202 INFO: CPD calculation finished
20:49:27.292 INFO: Analysis report generated in 88ms, dir size=21 KB
20:49:27.302 INFO: Analysis reports compressed in 10ms, zip size=5 KB
20:49:27.303 INFO: Analysis report generated in /go/src/github.com/nemonik/.scannerwork/scanner-report
20:49:27.303 DEBUG: Upload report
20:49:27.410 DEBUG: POST 200 http://192.168.0.11:9000/api/ce/submit?projectKey=helloworld-web&amp;projectName=helloworld-web | time=104ms
20:49:27.413 INFO: Analysis report uploaded in 109ms
20:49:27.414 INFO: ANALYSIS SUCCESSFUL, you can browse http://192.168.0.11:9000/dashboard/index/helloworld-web
20:49:27.414 INFO: Note that you will be able to access the updated dashboard once the server has processed the submitted analysis report
20:49:27.414 INFO: More about the report processing at http://192.168.0.11:9000/api/ce/task?id=AWLahO0mE0IcvTpxuSn_
20:49:27.415 DEBUG: Report metadata written to /go/src/github.com/nemonik/.scannerwork/report-task.txt
20:49:27.417 DEBUG: Post-jobs : 
20:49:27.422 INFO: Task total time: 2.869 s
20:49:27.505 INFO: ------------------------------------------------------------------------
20:49:27.505 INFO: EXECUTION SUCCESS
20:49:27.505 INFO: ------------------------------------------------------------------------
20:49:27.505 INFO: Total time: 5.914s
20:49:27.550 INFO: Final Memory: 6M/129M
20:49:27.550 INFO: ------------------------------------------------------------------------
</code></pre><h3 class="mume-header" id="81017-author-an-automated-funtional-test">8.10.17. Author an automated funtional test</h3>

<p>We're going to write an automated functional test of <code>helloworld-web</code> instead of relying on a manual functional test by using Selenium, a portable software-testing framework for web applications.  Essentially, Selenium automates web browsers.</p>
<p>More can be found here</p>
<p><a href="http://www.seleniumhq.org/">http://www.seleniumhq.org/</a></p>
<p>You'll need three shells open to your <code>dev</code> vagrant to complete this section.</p>
<h4 class="mume-header" id="810171-run-the-helloworld-web-application">8.10.17.1. Run the <em>helloworld-web</em> application</h4>

<p>In the first <code>vagrant ssh dev</code> enter</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker run -p 3000:3000 nemonik/helloworld-web
</code></pre><p>We've seen the log out before, but it looks like</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev ~]$ docker run -p 3000:3000 nemonik/helloworld-web
listening on :3000
</code></pre><h4 class="mume-header" id="810172-pull-and-run-selenium-firefox-standalone">8.10.17.2. Pull and run Selenium Firefox Standalone</h4>

<p>In the second <code>vagrant ssh dev</code> enter</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker pull 192.168.0.11:5000/nemonik/standalone-firefox:3.11
</code></pre><p>to pull the container image frome our private Docker repository running on our <code>toolchain</code> vagrant.</p>
<p>Then enter into the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker run -p 4444:4444 192.168.0.11:5000/nemonik/standalone-firefox:3.11
</code></pre><p>This stands up Selenium specifically running Firefox.  The container is running in the foreground so we can watch the log output.</p>
<p>A good start outputs to the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev ~]$ docker run -p 4444:4444 192.168.0.11:5000/nemonik/standalone-firefox:3.11
20:58:41.002 INFO [GridLauncherV3.launch] - Selenium build info: version: &apos;3.11.0&apos;, revision: &apos;e59cfb3&apos;
20:58:41.003 INFO [GridLauncherV3$1.launch] - Launching a standalone Selenium Server on port 4444
2018-04-18 20:58:41.093:INFO::main: Logging initialized @335ms to org.seleniumhq.jetty9.util.log.StdErrLog
20:58:41.265 INFO [SeleniumServer.boot] - Welcome to Selenium for Workgroups....
20:58:41.266 INFO [SeleniumServer.boot] - Selenium Server is up and running on port 4444
</code></pre><h4 class="mume-header" id="810173-create-our-test-automation">8.10.17.3. Create our test automation</h4>

<p>IIn another <code>vagrant ssh</code> to <code>dev</code>, we author and run our automated test.</p>
<p>In this other command line at the root of the <code>helloworld-web</code> project (e.g., <code>/home/vagrant/go/src/github.com/nemonik/helloworld-web</code>) enter</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>mkdir selenium-test
cd selenium-test
</code></pre><p>We're going to write our test in Python.  Python is already installed on the <code>dev</code> vagrant. Ansible uses it.</p>
<p>We'll need to install a dependency, we can install by entering into the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>sudo pip install selenium
</code></pre><p>But let's create a <code>requirements.txt</code> file to hold our dependency with our text editor containing</p>
<pre data-role="codeBlock" data-info="python" class="language-python">selenium<span class="token operator">==</span><span class="token number">3.11</span>
</pre><p>This results in allow the test's dependencies being enumerated in a file including the specififc version of the dependency, so their installation can be automated.</p>
<p>Then test out the requirements.txt file by entering</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>sudo pip install -r requirements.txt
</code></pre><p>Then in another editor create our <code>test_hello_world.py</code> Python-based unit test containing</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token keyword">import</span> unittest
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>desired_capabilities <span class="token keyword">import</span> DesiredCapabilities
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">PythonOrgSearch</span><span class="token punctuation">(</span>unittest<span class="token punctuation">.</span>TestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>

        webdriver<span class="token punctuation">.</span>DesiredCapabilities<span class="token punctuation">.</span>FIREFOX<span class="token punctuation">[</span><span class="token string">'proxy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">"proxyType"</span><span class="token punctuation">:</span><span class="token string">"DIRECT"</span>
<span class="token comment">#                "noProxy":"os.environ['no_proxy']," + selenium_host # Selenium cannot handle no_proxy</span>
    <span class="token punctuation">}</span>

        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Remote<span class="token punctuation">(</span>command_executor<span class="token operator">=</span><span class="token string">"http://"</span> <span class="token operator">+</span> selenium_host <span class="token operator">+</span> <span class="token string">":4444/wd/hub"</span><span class="token punctuation">,</span> desired_capabilities<span class="token operator">=</span>webdriver<span class="token punctuation">.</span>DesiredCapabilities<span class="token punctuation">.</span>FIREFOX<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_helloworld_web</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        driver <span class="token operator">=</span> self<span class="token punctuation">.</span>driver
        driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>helloworld_web_url<span class="token punctuation">)</span>
        <span class="token keyword">assert</span> <span class="token string">"Hello world!"</span> <span class="token keyword">in</span> driver<span class="token punctuation">.</span>page_source

    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
        selenium_host <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        helloworld_web_url <span class="token operator">=</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token string">"python test_hello_world.py selenium_host helloworld_web_url"</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">del</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>Save the file and exit.</p>
<p>You might notice the commented out section about <code>Selenium cannot handle no_proxy.</code>  Yeah.  This will later present a problem.</p>
<p>For now, now let us run our test by entering into the command line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>python test_hello_world.py  192.168.0.10 http://192.168.0.10:3000
</code></pre><p>Successful command line output in this window will be</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev selenium-test]$ python test_hello_world.py  192.168.0.10 http://192.168.0.10:3000
.
----------------------------------------------------------------------
Ran 1 test in 2.965s
</code></pre><p>The other windows will show logging.</p>
<p><code>ctrl-c</code> to stop the containers in your other shells.</p>
<h3 class="mume-header" id="81018-add-a-selenium-step-to-the-pipeline">8.10.18. Add a <em>selenium</em> step to the pipeline</h3>

<p>In one of your exsiting <code>vagrant ssh</code> to <code>dev</code> enter into the commmand line</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>cd /home/vagrant/go/src/github.com/nemonik/helloworld-web
</code></pre><p>Edit the <code>.drone.yml</code> file and add to the bottom the following with the <code>selenum:</code> step having the same idention as the prior steps, and <code>services:</code> starting the line.</p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">
  <span class="token key atrule">selenium</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/python<span class="token punctuation">:</span>2.7.14
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> export NO_PROXY=$NO_PROXY<span class="token punctuation">,</span>$(python selenium<span class="token punctuation">-</span>test/resolve.py firefox)
      <span class="token punctuation">-</span> export no_proxy=$no_proxy<span class="token punctuation">,</span>$(python selenium<span class="token punctuation">-</span>test/resolve.py firefox)
      <span class="token punctuation">-</span> cd selenium<span class="token punctuation">-</span>test
      <span class="token punctuation">-</span> pip install <span class="token punctuation">-</span>r requirements.txt
      <span class="token punctuation">-</span> python test_hello_world.py firefox http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span><span class="token number">3000</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">firefox</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/standalone<span class="token punctuation">-</span>firefox<span class="token punctuation">:</span><span class="token number">3.11</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /dev/shm<span class="token punctuation">:</span>/dev/shm
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">"4444:4444"</span>
</pre><p>Drone uses the  <code>services:</code> section to spin up a patched version of <code>selenium/standalone-firefox:3.9.1</code> exposed with the name <code>firefox</code>.  This is where the problem creeps in that I mentioned earlier, where the <code>selenium</code> step will hit corporate proxy to resolve <code>firefox</code>.  We don't want that to happen. so the <code>selenium:</code> step will makes use of another Python script to resolved <code>firefox</code> service to its private IP and add it the <code>no_proxy</code> and <code>NO_PROXY</code> environmental variables, so that the Python selenium test code doesn't attempt to pass the request on to the corporate proxy and result in the test failing.</p>
<p>Create in a text editor <code>selenium-test/resolve.py</code> with</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">#!/usr/bin/env python</span>

<span class="token comment"># Copyright (C) 2018 Michael Joseph Walsh - All Rights Reserved</span>
<span class="token comment"># You may use, distribute and modify this code under the</span>
<span class="token comment"># terms of the the license.</span>
<span class="token comment">#</span>
<span class="token comment"># You should have received a copy of the license with</span>
<span class="token comment"># this file. If not, please email &lt;mjwalsh@nemonik.com></span>

<span class="token keyword">import</span> socket<span class="token punctuation">,</span> sys

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> socket<span class="token punctuation">.</span>gethostbyname<span class="token punctuation">(</span> sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><p>Commit the code to GitLab hosted remote repo</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .
git commit -m &quot;added selenium step to pipeline&quot;
git push -u origin master
</code></pre><p>Open on your host</p>
<p><a href="http://192.168.0.11:8000/root/helloworld-web">http://192.168.0.11:8000/root/helloworld-web</a></p>
<p>And monitor the progress of the build. The pipeline should execute in a few minutes.</p>
<p>Successful output for this stage resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ export NO_PROXY=$NO_PROXY,$(python selenium-test/resolve.py firefox)
+ export no_proxy=$no_proxy,$(python selenium-test/resolve.py firefox)
+ cd selenium-test
+ pip install -r requirements.txt
Collecting selenium==3.11 (from -r requirements.txt (line 1))
  Downloading https://files.pythonhosted.org/packages/5e/1f/6c2204b9ae14eddab615c5e2ee4956c65ed533e0a9986c23eabd801ae849/selenium-3.11.0-py2.py3-none-any.whl (943kB)
Installing collected packages: selenium
Successfully installed selenium-3.11.0
+ python test_hello_world.py firefox http://192.168.0.11:3000
.
----------------------------------------------------------------------
Ran 1 test in 7.731s

OK
</code></pre><h3 class="mume-header" id="81019-add-a-dast-step-owasp-zap-to-the-pipeline">8.10.19. Add a DAST step (OWASP ZAP) to the pipeline</h3>

<p>Dynamic application security testing (DAST) is used to detect security vulnerabilities in an application while it is running, so as to help you remediate these concerns while in development.</p>
<p>The OWASP Zed Attack Proxy (ZAP) is one of the world’s most popular free DAST tools actively maintained by hundreds of international volunteers, so add a step to test the application.</p>
<p>First exercise ZAP locally on dev by entering in the command line in a <code>vagrant ssh</code> to <code>dev</code> at the root of the project</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>docker pull 192.168.0.11:5000/nemonik/zap2docker-stable:2.7.0
docker run 192.168.0.11:5000/nemonik/zap2docker-stable:2.7.0 zap-baseline.py -t http://192.168.0.11:3000
</code></pre><p>Success in the command line resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>[vagrant@dev helloworld-web]$ docker pull 192.168.0.11:5000/nemonik/zap2docker-stable:2.7.0
2.7.0: Pulling from nemonik/zap2docker-stable
660c48dd555d: Pull complete
4c7380416e78: Pull complete
421e436b5f80: Pull complete
e4ce6c3651b3: Pull complete
be588e74bd34: Pull complete
2e09786d5b2f: Pull complete
197722f79cca: Pull complete
bd33ded2095e: Pull complete
4b06ea4ab95b: Pull complete
5549c936d696: Pull complete
c2bfc8c8addb: Pull complete
1a4b29516a99: Pull complete
8ce1a9f9c46c: Pull complete
8808d1ac4805: Pull complete
24eed6f4cce3: Pull complete
2cd87b08c44e: Pull complete
5ae7b6620997: Pull complete
d6d847cf31e3: Pull complete
e844d15f6458: Pull complete
3e0203eff2eb: Pull complete
67e08593d215: Pull complete
Digest: sha256:00e3d7d88cd27ae2b5d4639cae5a6aed517fa379cdfaf9fcd482c5f79d88b226
Status: Downloaded newer image for 192.168.0.11:5000/nemonik/zap2docker-stable:2.7.0
[vagrant@dev helloworld-web]$ docker run 192.168.0.11:5000/nemonik/zap2docker-stable:2.7.0 zap-baseline.py -t http://192.168.0.11:3000
Apr 18, 2018 9:15:11 PM java.util.prefs.FileSystemPreferences$1 run
INFO: Created user preferences directory.
Total of 3 URLs
PASS: Cookie No HttpOnly Flag [10010]
PASS: Cookie Without Secure Flag [10011]
PASS: Password Autocomplete in Browser [10012]
PASS: Incomplete or No Cache-control and Pragma HTTP Header Set [10015]
PASS: Web Browser XSS Protection Not Enabled [10016]
PASS: Cross-Domain JavaScript Source File Inclusion [10017]
PASS: Content-Type Header Missing [10019]
PASS: X-Frame-Options Header Scanner [10020]
PASS: Secure Pages Include Mixed Content [10040]
PASS: Private IP Disclosure [2]
PASS: Session ID in URL Rewrite [3]
PASS: Script Passive Scan Rules [50001]
PASS: Application Error Disclosure [90022]
WARN-NEW: X-Content-Type-Options Header Missing [10021] x 4
	http://192.168.0.11:3000/
	http://192.168.0.11:3000/robots.txt
	http://192.168.0.11:3000
	http://192.168.0.11:3000/sitemap.xml
FAIL-NEW: 0	FAIL-INPROG: 0	WARN-NEW: 1	WARN-INPROG: 0	INFO: 0	IGNORE: 0	PASS: 13
[vagrant@dev helloworld-web]$
[vagrant@dev helloworld-web]$
</code></pre><p>Great, now lets add a step to our pipeline to the same after the <code>selenium:</code></p>
<pre data-role="codeBlock" data-info="yaml" class="language-yaml">
  <span class="token key atrule">owasp-zaproxy</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.0.11<span class="token punctuation">:</span>5000/nemonik/zap2docker<span class="token punctuation">-</span>stable<span class="token punctuation">:</span>2.7.0
    <span class="token key atrule">commands</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> zap<span class="token punctuation">-</span>baseline.py <span class="token punctuation">-</span>t http<span class="token punctuation">:</span>//192.168.0.11<span class="token punctuation">:</span>3000 <span class="token punctuation">|</span><span class="token punctuation">|</span> true
</pre><p>Commit the code to GitLab hosted remote repo</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>git add .
git commit -m &quot;added owasp-zaproxy step to pipeline&quot;
git push -u origin master
</code></pre><p>Open on your host</p>
<p><a href="http://192.168.0.11:8000/root/helloworld-web">http://192.168.0.11:8000/root/helloworld-web</a></p>
<p>And monitor the progress of the build. The pipeline should execute in a few minutes.</p>
<p>Successful output for this stage resembles</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>+ zap-baseline.py -t http://192.168.0.11:3000 || true
Apr 18, 2018 9:19:10 PM java.util.prefs.FileSystemPreferences$1 run
INFO: Created user preferences directory.
Total of 3 URLs
PASS: Cookie No HttpOnly Flag [10010]
PASS: Cookie Without Secure Flag [10011]
PASS: Password Autocomplete in Browser [10012]
PASS: Incomplete or No Cache-control and Pragma HTTP Header Set [10015]
PASS: Web Browser XSS Protection Not Enabled [10016]
PASS: Cross-Domain JavaScript Source File Inclusion [10017]
PASS: Content-Type Header Missing [10019]
PASS: X-Frame-Options Header Scanner [10020]
PASS: Secure Pages Include Mixed Content [10040]
PASS: Private IP Disclosure [2]
PASS: Session ID in URL Rewrite [3]
PASS: Script Passive Scan Rules [50001]
PASS: Application Error Disclosure [90022]
WARN-NEW: X-Content-Type-Options Header Missing [10021] x 4 
	http://192.168.0.11:3000/
	http://192.168.0.11:3000/robots.txt
	http://192.168.0.11:3000/sitemap.xml
	http://192.168.0.11:3000
FAIL-NEW: 0	FAIL-INPROG: 0	WARN-NEW: 1	WARN-INPROG: 0	INFO: 0	IGNORE: 0	PASS: 13
</code></pre><p>The application is relatively simple, so it was doubtful anything would be found, but there is a warning that a <em>X-Content-Type-Options Header</em> is missing that could be resolved by adding addtional handlers to the helloworld-web's main.go.</p>
<h3 class="mume-header" id="81020-all-the-source-for-helloworld-web">8.10.20. All the source for <em>helloworld-web</em></h3>

<p>The <code>helloworld-web</code> project can be viewed completed at</p>
<p><a href="https://gitlab.mitre.org/mjwalsh/helloworld-web">https://gitlab.mitre.org/mjwalsh/helloworld-web</a></p>
<h2 class="mume-header" id="811-using-what-youve-learned">8.11. Using what you've learned</h2>

<p>Git clone the Python+Flask Magic Eight Ball web app</p>
<p><a href="https://gitlab.mitre.org/mjwalsh/magiceightball">https://gitlab.mitre.org/mjwalsh/magiceightball</a></p>
<p>and develop a pipeline for.</p>
<h2 class="mume-header" id="812-shoo-away-your-vagrants">8.12. Shoo away your vagrants</h2>

<p>If you're done with your vagrants, shoo them away from the root of the project on the host</p>
<pre data-role="codeBlock" data-info="" class="language-"><code>vagrant destroy -f
</code></pre><p>And they're gone.</p>
<h2 class="mume-header" id="813-thats-it">8.13. That's it</h2>

<p>That's a wrap.</p>

      </div>
      
      
    </body>
    
    
    
    
    
    
    
  </html>